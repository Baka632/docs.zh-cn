---
ms.openlocfilehash: 53840ddd59ae3463bae2930fd0151ab2cd2d65cb
ms.sourcegitcommit: e301979e3049ce412d19b094c60ed95b316a8f8c
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/16/2020
ms.locfileid: "97593315"
---
### <a name="design-time-builds-only-return-top-level-package-references"></a><span data-ttu-id="1ab89-101">设计时生成仅返回最上层包引用</span><span class="sxs-lookup"><span data-stu-id="1ab89-101">Design-time builds only return top-level package references</span></span>

<span data-ttu-id="1ab89-102">从 .NET Core SDK 3.1.400 开始，`RunResolvePackageDependencies` 目标仅返回最上层包引用。</span><span class="sxs-lookup"><span data-stu-id="1ab89-102">Starting in .NET Core SDK 3.1.400, only top-level package references are returned by the `RunResolvePackageDependencies` target.</span></span>

#### <a name="version-introduced"></a><span data-ttu-id="1ab89-103">引入的版本</span><span class="sxs-lookup"><span data-stu-id="1ab89-103">Version introduced</span></span>

<span data-ttu-id="1ab89-104">.NET Core SDK 3.1.400</span><span class="sxs-lookup"><span data-stu-id="1ab89-104">.NET Core SDK 3.1.400</span></span>

#### <a name="change-description"></a><span data-ttu-id="1ab89-105">更改描述</span><span class="sxs-lookup"><span data-stu-id="1ab89-105">Change description</span></span>

<span data-ttu-id="1ab89-106">在早期版本的 .NET Core SDK 中，`RunResolvePackageDependencies` 目标创建了以下 MSBuild 项，其中包含 NuGet 资产文件中的信息：</span><span class="sxs-lookup"><span data-stu-id="1ab89-106">In previous versions of the .NET Core SDK, the `RunResolvePackageDependencies` target created the following MSBuild items that contained information from the NuGet assets file:</span></span>

- `PackageDefinitions`
- `PackageDependencies`
- `TargetDefinitions`
- `FileDefinitions`
- `FileDependencies`

<span data-ttu-id="1ab89-107">Visual Studio 使用这些数据来填充解决方案资源管理器中的依赖项节点。</span><span class="sxs-lookup"><span data-stu-id="1ab89-107">This data is used by Visual Studio to populate the Dependencies node in Solution Explorer.</span></span> <span data-ttu-id="1ab89-108">但这些数据可能很大，除非对依赖项节点进行了扩展，否则不需要这些数据。</span><span class="sxs-lookup"><span data-stu-id="1ab89-108">However, it can be a large amount of data, and the data isn't needed unless the Dependencies node is expanded.</span></span>

<span data-ttu-id="1ab89-109">从 .NET Core SDK 3.1.400 版开始，默认不会生成这些项中的大多数。</span><span class="sxs-lookup"><span data-stu-id="1ab89-109">Starting in the .NET Core SDK version 3.1.400, most of these items aren't generated by default.</span></span> <span data-ttu-id="1ab89-110">仅返回 `Package` 类型的项。</span><span class="sxs-lookup"><span data-stu-id="1ab89-110">Only items of type `Package` are returned.</span></span> <span data-ttu-id="1ab89-111">如果 Visual Studio 需要这些项来填充依赖项节点，它会直接从资产文件中读取信息。</span><span class="sxs-lookup"><span data-stu-id="1ab89-111">If Visual Studio needs the items to populate the Dependencies node, it reads the information directly from the assets file.</span></span>

#### <a name="reason-for-change"></a><span data-ttu-id="1ab89-112">更改原因</span><span class="sxs-lookup"><span data-stu-id="1ab89-112">Reason for change</span></span>

<span data-ttu-id="1ab89-113">引入此更改是为了改进 Visual Studio 内的解决方案加载性能。</span><span class="sxs-lookup"><span data-stu-id="1ab89-113">This changed was introduced to improve solution-load performance inside of Visual Studio.</span></span> <span data-ttu-id="1ab89-114">之前系统会加载所有的包引用，包括加载多数用户永远不会查看的许多引用。</span><span class="sxs-lookup"><span data-stu-id="1ab89-114">Previously, all package references would be loaded, which involved loading many references that most users would never view.</span></span>

#### <a name="recommended-action"></a><span data-ttu-id="1ab89-115">建议的操作</span><span class="sxs-lookup"><span data-stu-id="1ab89-115">Recommended action</span></span>

<span data-ttu-id="1ab89-116">如果你有依赖于所创建项的 MSBuild 逻辑，请在项目文件中将 `EmitLegacyAssetsFileItems` 属性设置为 `true`。</span><span class="sxs-lookup"><span data-stu-id="1ab89-116">If you have MSBuild logic that depends on these items being created, set the `EmitLegacyAssetsFileItems` property to `true` in your project file.</span></span> <span data-ttu-id="1ab89-117">此设置会启用以前的行为（这种行为将创建所有项）。</span><span class="sxs-lookup"><span data-stu-id="1ab89-117">This setting enables the previous behavior where all the items are created.</span></span>

#### <a name="category"></a><span data-ttu-id="1ab89-118">类别</span><span class="sxs-lookup"><span data-stu-id="1ab89-118">Category</span></span>

<span data-ttu-id="1ab89-119">MSBuild</span><span class="sxs-lookup"><span data-stu-id="1ab89-119">MSBuild</span></span>

#### <a name="affected-apis"></a><span data-ttu-id="1ab89-120">受影响的 API</span><span class="sxs-lookup"><span data-stu-id="1ab89-120">Affected APIs</span></span>

<span data-ttu-id="1ab89-121">不可用</span><span class="sxs-lookup"><span data-stu-id="1ab89-121">N/A</span></span>
