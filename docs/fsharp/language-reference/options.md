---
title: 选项
description: '了解当命名值或变量可能不存在实际值时如何使用 F # 选项类型。'
ms.date: 08/13/2020
ms.openlocfilehash: 0618590c10f6ecac51a23483ca0ab6cd66f2df4f
ms.sourcegitcommit: 8bfeb5930ca48b2ee6053f16082dcaf24d46d221
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/18/2020
ms.locfileid: "88557563"
---
# <a name="options"></a><span data-ttu-id="2e87b-103">选项</span><span class="sxs-lookup"><span data-stu-id="2e87b-103">Options</span></span>

<span data-ttu-id="2e87b-104">当命名值或变量可能不存在实际值时，将使用 F # 中的选项类型。</span><span class="sxs-lookup"><span data-stu-id="2e87b-104">The option type in F# is used when an actual value might not exist for a named value or variable.</span></span> <span data-ttu-id="2e87b-105">选项具有基础类型并且可以保存该类型的值，或它可能没有值。</span><span class="sxs-lookup"><span data-stu-id="2e87b-105">An option has an underlying type and can hold a value of that type, or it might not have a value.</span></span>

## <a name="remarks"></a><span data-ttu-id="2e87b-106">备注</span><span class="sxs-lookup"><span data-stu-id="2e87b-106">Remarks</span></span>

<span data-ttu-id="2e87b-107">下面的代码演示了一个生成选项类型的函数。</span><span class="sxs-lookup"><span data-stu-id="2e87b-107">The following code illustrates a function which generates an option type.</span></span>

[!code-fsharp[Main](~/samples/snippets/fsharp/lang-ref-1/snippet1404.fs)]

<span data-ttu-id="2e87b-108">正如您所看到的，如果输入 `a` 大于0， `Some(a)` 则生成。</span><span class="sxs-lookup"><span data-stu-id="2e87b-108">As you can see, if the input `a` is greater than 0, `Some(a)` is generated.</span></span>  <span data-ttu-id="2e87b-109">否则， `None` 将生成。</span><span class="sxs-lookup"><span data-stu-id="2e87b-109">Otherwise, `None` is generated.</span></span>

<span data-ttu-id="2e87b-110">`None`当选项没有实际值时，使用值。</span><span class="sxs-lookup"><span data-stu-id="2e87b-110">The value `None` is used when an option does not have an actual value.</span></span> <span data-ttu-id="2e87b-111">否则，表达式将 `Some( ... )` 为选项提供一个值。</span><span class="sxs-lookup"><span data-stu-id="2e87b-111">Otherwise, the expression `Some( ... )` gives the option a value.</span></span> <span data-ttu-id="2e87b-112">值 `Some` 和 `None` 可用于模式匹配，如下面的函数中所示 `exists` ， `true` 如果选项具有值，则返回; `false` 否则返回。</span><span class="sxs-lookup"><span data-stu-id="2e87b-112">The values `Some` and `None` are useful in pattern matching, as in the following function `exists`, which returns `true` if the option has a value and `false` if it does not.</span></span>

[!code-fsharp[Main](~/samples/snippets/fsharp/lang-ref-1/snippet1401.fs)]

## <a name="using-options"></a><span data-ttu-id="2e87b-113">使用选项</span><span class="sxs-lookup"><span data-stu-id="2e87b-113">Using Options</span></span>

<span data-ttu-id="2e87b-114">如果搜索不返回匹配的结果，通常会使用选项，如下面的代码所示。</span><span class="sxs-lookup"><span data-stu-id="2e87b-114">Options are commonly used when a search does not return a matching result, as shown in the following code.</span></span>

[!code-fsharp[Main](~/samples/snippets/fsharp/lang-ref-1/snippet1403.fs)]

<span data-ttu-id="2e87b-115">在前面的代码中，将以递归方式搜索列表。</span><span class="sxs-lookup"><span data-stu-id="2e87b-115">In the previous code, a list is searched recursively.</span></span> <span data-ttu-id="2e87b-116">函数 `tryFindMatch` 采用一个谓词函数， `pred` 该函数返回布尔值和要搜索的列表。</span><span class="sxs-lookup"><span data-stu-id="2e87b-116">The function `tryFindMatch` takes a predicate function `pred` that returns a Boolean value, and a list to search.</span></span> <span data-ttu-id="2e87b-117">如果找到满足该谓词的元素，则递归结束，并且函数以表达式形式返回值 `Some(head)` 。</span><span class="sxs-lookup"><span data-stu-id="2e87b-117">If an element that satisfies the predicate is found, the recursion ends and the function returns the value as an option in the expression `Some(head)`.</span></span> <span data-ttu-id="2e87b-118">当匹配空列表时，递归结束。</span><span class="sxs-lookup"><span data-stu-id="2e87b-118">The recursion ends when the empty list is matched.</span></span> <span data-ttu-id="2e87b-119">此时， `head` 未找到值， `None` 返回。</span><span class="sxs-lookup"><span data-stu-id="2e87b-119">At that point the value `head` has not been found, and `None` is returned.</span></span>

<span data-ttu-id="2e87b-120">许多 F # 库函数在集合中搜索可能存在也可能不存在的值将返回该 `option` 类型。</span><span class="sxs-lookup"><span data-stu-id="2e87b-120">Many F# library functions that search a collection for a value that may or may not exist return the `option` type.</span></span> <span data-ttu-id="2e87b-121">按照约定，这些函数以前缀开头 `try` ，例如 [`Seq.tryFindIndex`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-collections-seqmodule.html#tryFindIndex) 。</span><span class="sxs-lookup"><span data-stu-id="2e87b-121">By convention, these functions begin with the `try` prefix, for example, [`Seq.tryFindIndex`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-collections-seqmodule.html#tryFindIndex).</span></span>

<span data-ttu-id="2e87b-122">当某个值可能不存在时（例如，如果在尝试构造值时可能会引发异常），选项也可能有用。</span><span class="sxs-lookup"><span data-stu-id="2e87b-122">Options can also be useful when a value might not exist, for example if it is possible that an exception will be thrown when you try to construct a value.</span></span> <span data-ttu-id="2e87b-123">下面的代码示例阐释了这一点。</span><span class="sxs-lookup"><span data-stu-id="2e87b-123">The following code example illustrates this.</span></span>

[!code-fsharp[Main](~/samples/snippets/fsharp/lang-ref-1/snippet1402.fs)]

<span data-ttu-id="2e87b-124">`openFile`上一示例中的函数具有类型 `string -> File option` `File` ，因为如果文件成功打开并且发生异常，则它将返回一个对象 `None` 。</span><span class="sxs-lookup"><span data-stu-id="2e87b-124">The `openFile` function in the previous example has type `string -> File option` because it returns a `File` object if the file opens successfully and `None` if an exception occurs.</span></span> <span data-ttu-id="2e87b-125">根据具体的情况，它可能不是捕获异常而不允许它传播的合适设计选项。</span><span class="sxs-lookup"><span data-stu-id="2e87b-125">Depending on the situation, it may not be an appropriate design choice to catch an exception rather than allowing it to propagate.</span></span>

<span data-ttu-id="2e87b-126">此外，还可以传递或值为 null 的值，这是 `null` `Some` 一个选项。</span><span class="sxs-lookup"><span data-stu-id="2e87b-126">Additionally, it is still possible to pass `null` or a value that is null to the `Some` case of an option.</span></span> <span data-ttu-id="2e87b-127">通常，这是为了避免这种情况，通常在常规 F # 编程中，但可能是因为 .NET 中的引用类型的性质。</span><span class="sxs-lookup"><span data-stu-id="2e87b-127">This is generally to be avoided, and typically is in routine F# programming, but is possible due to the nature of reference types in .NET.</span></span>

## <a name="option-properties-and-methods"></a><span data-ttu-id="2e87b-128">选项属性和方法</span><span class="sxs-lookup"><span data-stu-id="2e87b-128">Option Properties and Methods</span></span>

<span data-ttu-id="2e87b-129">选项类型支持以下属性和方法。</span><span class="sxs-lookup"><span data-stu-id="2e87b-129">The option type supports the following properties and methods.</span></span>

|<span data-ttu-id="2e87b-130">属性或方法</span><span class="sxs-lookup"><span data-stu-id="2e87b-130">Property or method</span></span>|<span data-ttu-id="2e87b-131">类型</span><span class="sxs-lookup"><span data-stu-id="2e87b-131">Type</span></span>|<span data-ttu-id="2e87b-132">说明</span><span class="sxs-lookup"><span data-stu-id="2e87b-132">Description</span></span>|
|------------------|----|-----------|
|<span data-ttu-id="2e87b-133">无</span><span class="sxs-lookup"><span data-stu-id="2e87b-133">[None](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-fsharpoption-1.html#None)</span></span>|`'T option`|<span data-ttu-id="2e87b-134">一个静态属性，可用于创建一个具有值的选项值 `None` 。</span><span class="sxs-lookup"><span data-stu-id="2e87b-134">A static property that enables you to create an option value that has the `None` value.</span></span>|
|[<span data-ttu-id="2e87b-135">IsNone</span><span class="sxs-lookup"><span data-stu-id="2e87b-135">IsNone</span></span>](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-fsharpoption-1.html#IsNone)|`bool`|<span data-ttu-id="2e87b-136">如果选项的值为，则返回 `true` `None` 。</span><span class="sxs-lookup"><span data-stu-id="2e87b-136">Returns `true` if the option has the `None` value.</span></span>|
|[<span data-ttu-id="2e87b-137">IsSome</span><span class="sxs-lookup"><span data-stu-id="2e87b-137">IsSome</span></span>](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-fsharpoption-1.html#IsSome)|`bool`|<span data-ttu-id="2e87b-138">`true`如果选项的值不为，则返回 `None` 。</span><span class="sxs-lookup"><span data-stu-id="2e87b-138">Returns `true` if the option has a value that is not `None`.</span></span>|
|[<span data-ttu-id="2e87b-139">Some</span><span class="sxs-lookup"><span data-stu-id="2e87b-139">Some</span></span>](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-fsharpoption-1.html#Some)|`'T option`|<span data-ttu-id="2e87b-140">一个静态成员，该成员创建的选项的值不是 `None` 。</span><span class="sxs-lookup"><span data-stu-id="2e87b-140">A static member that creates an option that has a value that is not `None`.</span></span>|
|[<span data-ttu-id="2e87b-141">值</span><span class="sxs-lookup"><span data-stu-id="2e87b-141">Value</span></span>](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-fsharpoption-1.html#Value)|`'T`|<span data-ttu-id="2e87b-142">返回基础值， `System.NullReferenceException` 如果值为，则引发 `None` 。</span><span class="sxs-lookup"><span data-stu-id="2e87b-142">Returns the underlying value, or throws a `System.NullReferenceException` if the value is `None`.</span></span>|

## <a name="option-module"></a><span data-ttu-id="2e87b-143">选项模块</span><span class="sxs-lookup"><span data-stu-id="2e87b-143">Option Module</span></span>

<span data-ttu-id="2e87b-144">有一个模块 [选项](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html)，它包含对选项执行操作的有用函数。</span><span class="sxs-lookup"><span data-stu-id="2e87b-144">There is a module, [Option](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html), that contains useful functions that perform operations on options.</span></span> <span data-ttu-id="2e87b-145">某些函数会重复属性的功能，但在需要函数的上下文中很有用。</span><span class="sxs-lookup"><span data-stu-id="2e87b-145">Some functions repeat the functionality of the properties but are useful in contexts where a function is needed.</span></span> <span data-ttu-id="2e87b-146">[IsSome](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#isSome) 和 [isNone](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#isNone) 都是测试选项是否包含值的模块函数。</span><span class="sxs-lookup"><span data-stu-id="2e87b-146">[Option.isSome](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#isSome) and [Option.isNone](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#isNone) are both module functions that test whether an option holds a value.</span></span> <span data-ttu-id="2e87b-147">[Option 获取](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#get) 值（如果有）。</span><span class="sxs-lookup"><span data-stu-id="2e87b-147">[Option.get](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#get) obtains the value, if there is one.</span></span> <span data-ttu-id="2e87b-148">如果没有值，则会引发 `System.ArgumentException` 。</span><span class="sxs-lookup"><span data-stu-id="2e87b-148">If there is no value, it throws `System.ArgumentException`.</span></span>

<span data-ttu-id="2e87b-149">如果有值，则该 [方法](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#bind) 会对值执行函数。</span><span class="sxs-lookup"><span data-stu-id="2e87b-149">The [Option.bind](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#bind) function executes a function on the value, if there is a value.</span></span> <span data-ttu-id="2e87b-150">函数必须仅采用一个自变量，并且其参数类型必须为选项类型。</span><span class="sxs-lookup"><span data-stu-id="2e87b-150">The function must take exactly one argument, and its parameter type must be the option type.</span></span> <span data-ttu-id="2e87b-151">函数的返回值是另一个选项类型。</span><span class="sxs-lookup"><span data-stu-id="2e87b-151">The return value of the function is another option type.</span></span>

<span data-ttu-id="2e87b-152">选项模块还包括与可用于列表、数组、序列和其他集合类型的函数相对应的函数。</span><span class="sxs-lookup"><span data-stu-id="2e87b-152">The option module also includes functions that correspond to the functions that are available for lists, arrays, sequences, and other collection types.</span></span> <span data-ttu-id="2e87b-153">这些函数包括 [`Option.map`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#map) 、 [`Option.iter`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#iter) 、 [`Option.forall`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#forall) 、 [`Option.exists`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#exists) 、 [`Option.foldBack`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#foldBack) 、 [`Option.fold`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#fold) 和 [`Option.count`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#count) 。</span><span class="sxs-lookup"><span data-stu-id="2e87b-153">These functions include [`Option.map`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#map), [`Option.iter`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#iter), [`Option.forall`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#forall), [`Option.exists`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#exists), [`Option.foldBack`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#foldBack), [`Option.fold`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#fold), and [`Option.count`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#count).</span></span> <span data-ttu-id="2e87b-154">这些函数可用于将选项用作零个或一个元素的集合。</span><span class="sxs-lookup"><span data-stu-id="2e87b-154">These functions enable options to be used like a collection of zero or one elements.</span></span> <span data-ttu-id="2e87b-155">有关详细信息和示例，请参阅 " [列表](lists.md)中的集合函数讨论"。</span><span class="sxs-lookup"><span data-stu-id="2e87b-155">For more information and examples, see the discussion of collection functions in [Lists](lists.md).</span></span>

## <a name="converting-to-other-types"></a><span data-ttu-id="2e87b-156">转换为其他类型</span><span class="sxs-lookup"><span data-stu-id="2e87b-156">Converting to Other Types</span></span>

<span data-ttu-id="2e87b-157">选项可以转换为列表或数组。</span><span class="sxs-lookup"><span data-stu-id="2e87b-157">Options can be converted to lists or arrays.</span></span> <span data-ttu-id="2e87b-158">当某个选项转换为这些数据结构中的任何一个时，生成的数据结构将包含零个或一个元素。</span><span class="sxs-lookup"><span data-stu-id="2e87b-158">When an option is converted into either of these data structures, the resulting data structure has zero or one element.</span></span> <span data-ttu-id="2e87b-159">若要将选项转换为数组，请使用 [`Option.toArray`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#toArray) 。</span><span class="sxs-lookup"><span data-stu-id="2e87b-159">To convert an option to an array, use [`Option.toArray`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#toArray).</span></span> <span data-ttu-id="2e87b-160">若要将选项转换为列表，请使用 [`Option.toList`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#toList) 。</span><span class="sxs-lookup"><span data-stu-id="2e87b-160">To convert an option to a list, use [`Option.toList`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-core-optionmodule.html#toList).</span></span>

## <a name="see-also"></a><span data-ttu-id="2e87b-161">另请参阅</span><span class="sxs-lookup"><span data-stu-id="2e87b-161">See also</span></span>

- [<span data-ttu-id="2e87b-162">F# 语言参考</span><span class="sxs-lookup"><span data-stu-id="2e87b-162">F# Language Reference</span></span>](index.md)
- [<span data-ttu-id="2e87b-163">F# 类型</span><span class="sxs-lookup"><span data-stu-id="2e87b-163">F# Types</span></span>](fsharp-types.md)
