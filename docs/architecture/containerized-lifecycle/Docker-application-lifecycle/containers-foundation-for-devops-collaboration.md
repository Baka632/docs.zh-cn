---
title: 将容器作为 DevOps 协作的基础
description: 了解容器在简化 DevOps 方面的关键作用。
ms.date: 08/06/2020
ms.openlocfilehash: af28c1add8b2e6befbd2f3e6ae9fe707ccc5b106
ms.sourcegitcommit: ef50c99928183a0bba75e07b9f22895cd4c480f8
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/07/2020
ms.locfileid: "87916012"
---
# <a name="containers-as-the-foundation-for-devops-collaboration"></a><span data-ttu-id="fff9e-103">将容器作为 DevOps 协作的基础</span><span class="sxs-lookup"><span data-stu-id="fff9e-103">Containers as the foundation for DevOps collaboration</span></span>

<span data-ttu-id="fff9e-104">根据容器和 Docker 技术的本质，开发人员可以轻松地与 IT 操作和生产环境共享他们的软件和依赖项，同时消除典型的“适用于计算机”的借口。</span><span class="sxs-lookup"><span data-stu-id="fff9e-104">By the very nature of the containers and Docker technology, developers can share their software and dependencies easily with IT operations and production environments while eliminating the typical "it works on my machine" excuse.</span></span> <span data-ttu-id="fff9e-105">容器可解决不同环境之间的应用程序冲突。</span><span class="sxs-lookup"><span data-stu-id="fff9e-105">Containers solve application conflicts between different environments.</span></span> <span data-ttu-id="fff9e-106">容器和 Docker 间接地将开发人员和 IT 运营更紧密地结合在一起，使他们更能高效地协作。</span><span class="sxs-lookup"><span data-stu-id="fff9e-106">Indirectly, containers and Docker bring developers and IT operations closer together, making it easier for them to collaborate effectively.</span></span> <span data-ttu-id="fff9e-107">采用容器工作流可为许多客户提供他们所寻求的 DevOps 连续性，但之前必须通过更复杂的配置来实现发布和生成管道。</span><span class="sxs-lookup"><span data-stu-id="fff9e-107">Adopting the container workflow provides many customers with the DevOps continuity they've sought but previously had to implement via more complex configuration for release and build pipelines.</span></span> <span data-ttu-id="fff9e-108">容器可简化 DevOps 中的生成/测试/部署管道。</span><span class="sxs-lookup"><span data-stu-id="fff9e-108">Containers simplify the build/test/deploy pipelines in DevOps.</span></span>

![显示 Docker 应用生命周期的所有权的关系图。](./media/containers-foundation-for-devops-collaboration/persona-workloads-docker-container-lifecycle.png)

<span data-ttu-id="fff9e-110">**图 2-1.**</span><span class="sxs-lookup"><span data-stu-id="fff9e-110">**Figure 2-1.**</span></span> <span data-ttu-id="fff9e-111">容器化 Docker 应用程序生命周期中每个“角色”的主要工作负载</span><span class="sxs-lookup"><span data-stu-id="fff9e-111">Main workloads per "personas" in the life cycle for containerized Docker applications</span></span>

<span data-ttu-id="fff9e-112">使用 Docker 容器，开发人员拥有容器内的内容（应用程序和服务，以及对框架和组件的依赖项）以及容器和服务如何作为由一组服务组成的应用程序一起运行。</span><span class="sxs-lookup"><span data-stu-id="fff9e-112">With Docker containers, developers own what's within the container (application and service, and dependencies to frameworks and components) and how the containers and services behave together as an application composed by a collection of services.</span></span> <span data-ttu-id="fff9e-113">多个容器的相互依赖项在 `docker-compose.yml` 文件中定义，或者可以称为部署清单  。</span><span class="sxs-lookup"><span data-stu-id="fff9e-113">The interdependencies of the multiple containers are defined in a `docker-compose.yml` file, or what could be called a *deployment manifest*.</span></span> <span data-ttu-id="fff9e-114">同时，IT 运营团队（IT 专业人员和管理人员）可以专注于生产环境的管理、基础设施、可伸缩性、监视，并最终确保将应用程序正确交付给最终用户，而无需知道各种容器的内容。</span><span class="sxs-lookup"><span data-stu-id="fff9e-114">Meanwhile, IT operations teams (IT professionals and management) can focus on the management of production environments; infrastructure; scalability; monitoring; and, ultimately, ensuring that the applications are delivering properly for the end users, without having to know the contents of the various containers.</span></span> <span data-ttu-id="fff9e-115">因此“容器”一词就好比现实世界的运输容器。</span><span class="sxs-lookup"><span data-stu-id="fff9e-115">Hence, the name "container," recalling the analogy to real-world shipping containers.</span></span> <span data-ttu-id="fff9e-116">容器内容的所有者不需要考虑容器的运算方式，运输公司会将容器从其原点运输到其目的地，而无需了解或关注容器的内容。</span><span class="sxs-lookup"><span data-stu-id="fff9e-116">Thus, the owners of a container's content need not concern themselves with how the container will be shipped, and the shipping company transports a container from its point of origin to its destination without knowing or caring about the contents.</span></span> <span data-ttu-id="fff9e-117">以类似的方式，开发人员可以在 Docker 容器中创建和拥有内容，而无需在意“传输”机制。</span><span class="sxs-lookup"><span data-stu-id="fff9e-117">In a similar manner, developers can create and own the contents within a Docker container without the need to concern themselves with the "transport" mechanisms.</span></span>

<span data-ttu-id="fff9e-118">在图 2-1 左侧的支柱中，开发人员在本地使用用于 Windows 或 Mac 的 Docker 在 Docker 容器中编写和运行代码。</span><span class="sxs-lookup"><span data-stu-id="fff9e-118">In the pillar on the left side of Figure 2-1, developers write and run code locally in Docker containers by using Docker for Windows or Mac.</span></span> <span data-ttu-id="fff9e-119">它们通过使用指定要运行的基本操作系统的 Dockerfile 以及将代码构建到 Docker 映像的构建步骤来定义代码的操作环境。</span><span class="sxs-lookup"><span data-stu-id="fff9e-119">They define the operating environment for the code by using a Dockerfile that specifies the base operating system to run as well as the build steps for building their code into a Docker image.</span></span> <span data-ttu-id="fff9e-120">开发人员使用上述 `docker-compose.yml` 文件部署清单定义一个或多个映像的交互操作方式。</span><span class="sxs-lookup"><span data-stu-id="fff9e-120">The developers define how one or more images will interoperate using the aforementioned `docker-compose.yml` file deployment manifest.</span></span> <span data-ttu-id="fff9e-121">完成本地开发后，他们将应用程序代码和 Docker 配置文件推送到所选择的代码库（即 Git 存储库）中。</span><span class="sxs-lookup"><span data-stu-id="fff9e-121">As they complete their local development, they push their application code plus the Docker configuration files to the code repository of their choice (that is, Git repository).</span></span>

<span data-ttu-id="fff9e-122">DevOps 支柱使用代码存储库中提供的 Dockerfile 定义构建 - 持续集成 (CI) 管道。</span><span class="sxs-lookup"><span data-stu-id="fff9e-122">The DevOps pillar defines the build–Continuous Integration (CI) pipelines using the Dockerfile provided in the code repository.</span></span> <span data-ttu-id="fff9e-123">CI 系统从选定的 Docker 注册表中提取基础容器映像，并为应用程序构建自定义 Docker 映像。</span><span class="sxs-lookup"><span data-stu-id="fff9e-123">The CI system pulls the base container images from the selected Docker registry and builds the custom Docker images for the application.</span></span> <span data-ttu-id="fff9e-124">然后验证这些映像，并将其推送到用于部署到多个环境的 Docker 注册表。</span><span class="sxs-lookup"><span data-stu-id="fff9e-124">The images then are validated and pushed to the Docker registry used for the deployments to multiple environments.</span></span>

<span data-ttu-id="fff9e-125">在右侧的支柱中，运营团队管理生产中部署的应用程序和基础结构，同时监视环境和应用程序，以便他们可以向开发团队提供有关如何改进应用程序的反馈和见解。</span><span class="sxs-lookup"><span data-stu-id="fff9e-125">In the pillar on the right, operations teams manage deployed applications and infrastructure in production while monitoring the environment and applications so that they can provide feedback and insights to the development team about how the application might be improved.</span></span> <span data-ttu-id="fff9e-126">容器应用通常使用容器业务流程协调程序（如 [Kubernetes](https://kubernetes.io/)）在生产环境中运行，在这种情况下，通常会将 [Helm](https://helm.sh/) 图表用于配置部署单元，而不是 docker-compose 文件。</span><span class="sxs-lookup"><span data-stu-id="fff9e-126">Container apps are typically run in production using container orchestrators like [Kubernetes](https://kubernetes.io/), where usually [Helm charts](https://helm.sh/) are used to configure deployment units, instead of docker-compose files.</span></span>

<span data-ttu-id="fff9e-127">这两个团队通过将关注点分离为协定的基础平台（Docker 容器）进行协作，同时极大地提高了两个团队在应用程序生命周期中的协作能力。</span><span class="sxs-lookup"><span data-stu-id="fff9e-127">The two teams are collaborating through a foundational platform (Docker containers) that provides a separation of concerns as a contract, while greatly improving the two teams' collaboration in the application life cycle.</span></span> <span data-ttu-id="fff9e-128">开发人员拥有容器内容、其操作环境和容器相互依赖项，而运营团队将构建的映像与清单一起使用，并在其业务流程系统中加以执行。</span><span class="sxs-lookup"><span data-stu-id="fff9e-128">The developers own the container contents, its operating environment, and the container interdependencies, whereas the operations teams take the built images along with the manifest and runs them in their orchestration system.</span></span>

## <a name="challenges-in-the-application-life-cycle-when-using-docker"></a><span data-ttu-id="fff9e-129">使用 Docker 时，应用程序生命周期中存在的难题。</span><span class="sxs-lookup"><span data-stu-id="fff9e-129">Challenges in the application life cycle when using Docker.</span></span>

<span data-ttu-id="fff9e-130">在未来几年中，有多种原因导致容器化应用程序数量的增加，其中一个原因是基于微服务创建应用程序。</span><span class="sxs-lookup"><span data-stu-id="fff9e-130">There are many reasons that will increase the number of containerized applications in the upcoming years, and one of these reasons is the creation of applications based on microservices.</span></span>

<span data-ttu-id="fff9e-131">在过去的 15 年中，使用 Web 服务是构建数千个应用程序的基础，并且可能在几年之后，你将发现在 Docker 容器上运行的基于微服务的应用程序具有相同的情况。</span><span class="sxs-lookup"><span data-stu-id="fff9e-131">During the last 15 years, the use of web services has been the base of thousands of applications, and probably, after a few years, you'll find the same situation with microservice-based applications running on Docker containers.</span></span>

<span data-ttu-id="fff9e-132">还值得一提的是，也可以将 Docker 容器用于整体式应用程序，且仍可获得 Docker 的大部分好处。</span><span class="sxs-lookup"><span data-stu-id="fff9e-132">It is also worth to mention that you can also use Docker containers for monolithic applications and you still get most of the benefits of Docker.</span></span> <span data-ttu-id="fff9e-133">容器并非仅面向微服务。</span><span class="sxs-lookup"><span data-stu-id="fff9e-133">Containers are not targeting only microservices.</span></span>

<span data-ttu-id="fff9e-134">使用 Docker 容器化和微服务会给组织的开发过程带来新的挑战。因此，需要使用一个可靠的策略，才能维护在生产系统上运行的多个容器和微服务。</span><span class="sxs-lookup"><span data-stu-id="fff9e-134">The use of Docker containerization and microservices causes new challenges in the development process of your organizations and therefore, you need a solid strategy to maintain many containers and microservices running on production systems.</span></span> <span data-ttu-id="fff9e-135">最终，企业应用程序将在生产中运行数百或数千个容器/实例。</span><span class="sxs-lookup"><span data-stu-id="fff9e-135">Eventually, enterprise applications will have hundreds or thousands of containers/instances running in production.</span></span>

<span data-ttu-id="fff9e-136">这些挑战在使用 DevOps 工具时创造了新的需求，因此必须在 DevOps 活动中定义新流程，并找到以下类型的问题的答案：</span><span class="sxs-lookup"><span data-stu-id="fff9e-136">These challenges create new demands when using DevOps tools, so you'll have to define new processes in your DevOps activities, and find answers for the following type of questions:</span></span>

- <span data-ttu-id="fff9e-137">可以使用哪些工具进行开发、CI/CD、管理和运营？</span><span class="sxs-lookup"><span data-stu-id="fff9e-137">Which tools can I use for development, CI/CD, management and operations??</span></span>

- <span data-ttu-id="fff9e-138">公司如何在生产中运行时管理容器中的错误？</span><span class="sxs-lookup"><span data-stu-id="fff9e-138">How can my company manage errors in containers when running in production?</span></span>

- <span data-ttu-id="fff9e-139">如何在最短的停机时间内更改生产中的软件？</span><span class="sxs-lookup"><span data-stu-id="fff9e-139">How can we change pieces of our software in production with minimum downtime?</span></span>

- <span data-ttu-id="fff9e-140">如何缩放和监视生产系统？</span><span class="sxs-lookup"><span data-stu-id="fff9e-140">How can we scale and monitor our production system?</span></span>

- <span data-ttu-id="fff9e-141">如何在发布管道中包含容器的测试和部署？</span><span class="sxs-lookup"><span data-stu-id="fff9e-141">How can we include the testing and deployment of containers in our release pipeline?</span></span>

- <span data-ttu-id="fff9e-142">如何在 Microsoft Azure 中为容器使用开放源代码工具/平台？</span><span class="sxs-lookup"><span data-stu-id="fff9e-142">How can we use Open Source tools/platforms for containers in Microsoft Azure?</span></span>

<span data-ttu-id="fff9e-143">如果可以回答所有这些问题，那么你已做好充分准备将应用程序（现有或新应用）移动到 Docker 容器。</span><span class="sxs-lookup"><span data-stu-id="fff9e-143">If you can answer all those questions, you'll be better prepared to move your applications (existing or new apps) to Docker containers.</span></span>

## <a name="introduction-to-a-generic-end-to-end-docker-application-life-cycle-workflow"></a><span data-ttu-id="fff9e-144">泛型端到端 Docker 应用程序生命周期工作流的简介</span><span class="sxs-lookup"><span data-stu-id="fff9e-144">Introduction to a generic end-to-end Docker application life cycle workflow</span></span>

<span data-ttu-id="fff9e-145">图 2-2 详细介绍了 Docker 应用程序生命周期工作流，在本示例中，重点介绍了特定 DevOps 活动和资产。</span><span class="sxs-lookup"><span data-stu-id="fff9e-145">Figure 2-2 presents a more detailed workflow for a Docker application life cycle, focusing in this instance on specific DevOps activities and assets.</span></span>

![显示 Docker 应用的一般端到端生命周期的关系图。](./media/containers-foundation-for-devops-collaboration/generic-end-to-enddpcker-app-life-cycle.png)

<span data-ttu-id="fff9e-147">**图 2-2。**</span><span class="sxs-lookup"><span data-stu-id="fff9e-147">**Figure 2-2.**</span></span> <span data-ttu-id="fff9e-148">Docker 容器化应用程序生命周期的高级工作流</span><span class="sxs-lookup"><span data-stu-id="fff9e-148">High-level workflow for the Docker containerized application life cycle</span></span>

<span data-ttu-id="fff9e-149">一切都始于开发人员，该人员开始在内部循环工作流中编写代码。</span><span class="sxs-lookup"><span data-stu-id="fff9e-149">Everything begins with the developer, who starts writing code in the inner-loop workflow.</span></span> <span data-ttu-id="fff9e-150">内部循环阶段即开发人员在将代码推送到代码存储库之前定义发生的所有事情（例如，Git 等源代码管理系统）。</span><span class="sxs-lookup"><span data-stu-id="fff9e-150">The inner-loop stage is where developers define everything that happens before pushing code into the code repository (for example, a source control system such as Git).</span></span> <span data-ttu-id="fff9e-151">提交后，存储库触发持续集成 (CI) 和工作流的其余部分。</span><span class="sxs-lookup"><span data-stu-id="fff9e-151">After it's committed, the repository triggers Continuous Integration (CI) and the rest of the workflow.</span></span>

<span data-ttu-id="fff9e-152">内部循环包括典型的步骤（“代码”、“运行”、“测试”和“调试”等）以及在本地运行应用之前所需的其他步骤。</span><span class="sxs-lookup"><span data-stu-id="fff9e-152">The inner loop consists of typical steps like "code," "run," "test," and "debug," plus the additional steps needed right before running the app locally.</span></span> <span data-ttu-id="fff9e-153">这是开发人员运行和测试作为 Docker 容器的应用的过程。</span><span class="sxs-lookup"><span data-stu-id="fff9e-153">This is the developer's process to run and test the app as a Docker container.</span></span> <span data-ttu-id="fff9e-154">内部循环工作流将在后面的章节中介绍。</span><span class="sxs-lookup"><span data-stu-id="fff9e-154">The inner-loop workflow will be explained in the sections that follow.</span></span>

<span data-ttu-id="fff9e-155">回过头来查看端到端工作流，DevOps 工作流不只是一项技术或工具集：它是一种需要文化演变的思维方式。</span><span class="sxs-lookup"><span data-stu-id="fff9e-155">Taking a step back to look at the end-to-end workflow, the DevOps workflow is more than a technology or a tool set, it's a mindset that requires cultural evolution.</span></span> <span data-ttu-id="fff9e-156">它是人员、流程和恰当工具，可以使应用程序生命周期更快且更可预测。</span><span class="sxs-lookup"><span data-stu-id="fff9e-156">It's people, processes, and the appropriate tools to make your application life cycle faster and more predictable.</span></span> <span data-ttu-id="fff9e-157">采用容器化工作流的企业通常会对其组织进行重组，以表示与容器化工作流相匹配的人员和流程。</span><span class="sxs-lookup"><span data-stu-id="fff9e-157">Enterprises that adopt a containerized workflow typically restructure their organizations to represent people and processes that match the containerized workflow.</span></span>

<span data-ttu-id="fff9e-158">实践 DevOps 可以帮助团队更快地响应竞争压力，方法是以自动化功能替代容易出错的手动流程，从而改进可追溯性和可重复的工作流。</span><span class="sxs-lookup"><span data-stu-id="fff9e-158">Practicing DevOps can help teams respond faster together to competitive pressures by replacing error-prone manual processes with automation, which results in improved traceability and repeatable workflows.</span></span> <span data-ttu-id="fff9e-159">通过结合本地和云资源以及紧密集成的工具，组织还可以更加有效地管理环境并实现成本节约。</span><span class="sxs-lookup"><span data-stu-id="fff9e-159">Organizations also can manage environments more efficiently and realize cost savings with a combination of on-premises and cloud resources as well as tightly integrated tooling.</span></span>

<span data-ttu-id="fff9e-160">在为 Docker 应用程序实现 DevOps 工作流时，你将看到 Docker 技术几乎存在于工作流的每个阶段。在处理内部循环（代码、运行、调试）时，从开发框开始，构建测试 CI 阶段，最后将这些容器部署到暂存和生产环境。</span><span class="sxs-lookup"><span data-stu-id="fff9e-160">When implementing your DevOps workflow for Docker applications, you'll see that Docker technologies are present in almost every stage of the workflow, from your development box while working in the inner loop (code, run, debug), the build-test-CI phase, and, finally, the deployment of those containers to the staging and production environments.</span></span>

<span data-ttu-id="fff9e-161">质量做法的改进有助于在开发周期的早期识别缺陷，从而降低修复它们的成本。</span><span class="sxs-lookup"><span data-stu-id="fff9e-161">Improvement of quality practices helps to identify defects early in the development cycle, which reduces the cost of fixing them.</span></span> <span data-ttu-id="fff9e-162">通过在映像中包含环境和依赖项并采用在多个环境中部署相同映像的理念，可以促进提取特定于环境的配置的规则，从而使部署更加可靠。</span><span class="sxs-lookup"><span data-stu-id="fff9e-162">By including the environment and dependencies in the image and adopting a philosophy of deploying the same image across multiple environments, you promote a discipline of extracting the environment-specific configurations making deployments more reliable.</span></span>

<span data-ttu-id="fff9e-163">通过有效的仪器（监视和诊断）获得的丰富数据可以深入了解性能问题和用户行为，从而指导未来的优先事项和投资。</span><span class="sxs-lookup"><span data-stu-id="fff9e-163">Rich data obtained through effective instrumentation (monitoring and diagnostics) provides insight into performance issues and user behavior to guide future priorities and investments.</span></span>

<span data-ttu-id="fff9e-164">DevOps 应视为旅程，而不是目的地。</span><span class="sxs-lookup"><span data-stu-id="fff9e-164">DevOps should be considered a journey, not a destination.</span></span> <span data-ttu-id="fff9e-165">它应通过适当范围的项目逐步实施，其中可以展示成功、学习和发展。</span><span class="sxs-lookup"><span data-stu-id="fff9e-165">It should be implemented incrementally through appropriately scoped projects from which you can demonstrate success, learn, and evolve.</span></span>

## <a name="benefits-of-devops-for-containerized-applications"></a><span data-ttu-id="fff9e-166">容器化应用程序 DevOps 的优势</span><span class="sxs-lookup"><span data-stu-id="fff9e-166">Benefits of DevOps for containerized applications</span></span>

<span data-ttu-id="fff9e-167">以下是可靠的 DevOps 工作流提供的一些最重要的好处：</span><span class="sxs-lookup"><span data-stu-id="fff9e-167">Here are some of the most important benefits provided by a solid DevOps workflow:</span></span>

- <span data-ttu-id="fff9e-168">更快地提供更高质量的软件且符合性更加。</span><span class="sxs-lookup"><span data-stu-id="fff9e-168">Deliver better-quality software, faster and with better compliance.</span></span>

- <span data-ttu-id="fff9e-169">更早、更经济实惠地推动持续改进和调整。</span><span class="sxs-lookup"><span data-stu-id="fff9e-169">Drive continuous improvement and adjustments earlier and more economically.</span></span>

- <span data-ttu-id="fff9e-170">提高参与交付和运营软件的利益干系人之间的透明度和协作。</span><span class="sxs-lookup"><span data-stu-id="fff9e-170">Increase transparency and collaboration among stakeholders involved in delivering and operating software.</span></span>

- <span data-ttu-id="fff9e-171">控制成本且更有效地利用预配资源，同时将安全风险降至最低。</span><span class="sxs-lookup"><span data-stu-id="fff9e-171">Control costs and utilize provisioned resources more effectively while minimizing security risks.</span></span>

- <span data-ttu-id="fff9e-172">即插即用多个现有 DevOps 投资，包括对开放源代码的投资。</span><span class="sxs-lookup"><span data-stu-id="fff9e-172">Plug and play well with many of your existing DevOps investments, including investments in open-source.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="fff9e-173">[上一页](index.md)
>[下一页](../Microsoft-platform-tools-containerized-apps/index.md)</span><span class="sxs-lookup"><span data-stu-id="fff9e-173">[Previous](index.md)
[Next](../Microsoft-platform-tools-containerized-apps/index.md)</span></span>
