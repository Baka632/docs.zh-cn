---
title: .NET Framework 性能
description: 设计和规划 .NET 应用程序的性能。 使用 Microsoft 提供的工具来衡量应用程序的性能并做出改进。
ms.date: 03/30/2017
helpviewer_keywords:
- performance [.NET Framework]
- reliability [.NET Framework]
ms.assetid: c1676cca-3f1a-41ec-b469-9029566074fc
ms.openlocfilehash: ee8260056bd87dfc66d96e394f9b93bb9427afd8
ms.sourcegitcommit: 0fa2b7b658bf137e813a7f4d09589d64c148ebf5
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/14/2020
ms.locfileid: "86309750"
---
# <a name="net-framework-performance"></a><span data-ttu-id="26a69-104">.NET Framework 性能</span><span class="sxs-lookup"><span data-stu-id="26a69-104">.NET Framework Performance</span></span>
<span data-ttu-id="26a69-105">如果想要创建一个具有卓越性能的应用，你应该像设计应用的任何其他功能一样设计和规划性能。</span><span class="sxs-lookup"><span data-stu-id="26a69-105">If you want to create apps with great performance, you should design and plan for performance just as you would design any other feature of your app.</span></span> <span data-ttu-id="26a69-106">你可以使用由 Microsoft 所提供的用于测量你的应用性能的工具，并对内存使用、代码吞吐量和响应能力进行改进（如果需要）。</span><span class="sxs-lookup"><span data-stu-id="26a69-106">You can use the tools provided by Microsoft to measure your app's performance, and, if needed, make improvements to memory use, code throughput, and responsiveness.</span></span> <span data-ttu-id="26a69-107">本主题列出了 Microsoft 提供的性能分析工具，并提供了介绍应用开发特定领域性能的其他主题的链接。</span><span class="sxs-lookup"><span data-stu-id="26a69-107">This topic lists the performance analysis tools that Microsoft provides, and provides links to other topics that cover performance for specific areas of app development.</span></span>  
  
## <a name="designing-and-planning-for-performance"></a><span data-ttu-id="26a69-108">性能的设计和规划</span><span class="sxs-lookup"><span data-stu-id="26a69-108">Designing and planning for performance</span></span>  
 <span data-ttu-id="26a69-109">如果你想要一个性能卓越的应用，你必须像设计任何其他功能一样，在设计应用时集成性能。</span><span class="sxs-lookup"><span data-stu-id="26a69-109">If you want a great performing app, you must design performance into your app just as you would design any other feature.</span></span> <span data-ttu-id="26a69-110">你必须确定应用中的性能关键方案，设定性能目标，以及尽早且经常为这些应用方案测量性能。</span><span class="sxs-lookup"><span data-stu-id="26a69-110">You should determine the performance-critical scenarios in your app, set performance goals, and measure performance for these app scenarios early and often.</span></span> <span data-ttu-id="26a69-111">因为每个应用是不同的，并且具有不同的性能关键执行路径，尽早确定那些路径并集中精力，使你能最大限度地提高工作效率。</span><span class="sxs-lookup"><span data-stu-id="26a69-111">Because each app is different and has different performance-critical execution paths, determining those paths early and focusing your efforts enable you to maximize your productivity.</span></span>  
  
 <span data-ttu-id="26a69-112">你不必完全熟悉目标平台来创建高性能的应用。</span><span class="sxs-lookup"><span data-stu-id="26a69-112">You don’t have to be completely familiar with your target platform to create a high-performance app.</span></span> <span data-ttu-id="26a69-113">然而，你应对目标平台的哪些部分在性能方面成本高昂有基本的了解。</span><span class="sxs-lookup"><span data-stu-id="26a69-113">However, you should develop an understanding of which parts of your target platform are costly in terms of performance.</span></span> <span data-ttu-id="26a69-114">你可以通过在开发过程中尽早执行性能测量来做到这一点。</span><span class="sxs-lookup"><span data-stu-id="26a69-114">You can do this by measuring performance early in your development process.</span></span>  
  
 <span data-ttu-id="26a69-115">若要确定对性能至关重要的领域并建立性能目标，始终考虑用户体验。</span><span class="sxs-lookup"><span data-stu-id="26a69-115">To determine the areas that are crucial to performance and to establish your performance goals, always consider the user experience.</span></span> <span data-ttu-id="26a69-116">启动时间和响应能力将是影响应用的用户感觉的两个关键领域。</span><span class="sxs-lookup"><span data-stu-id="26a69-116">Startup time and responsiveness are two key areas that will affect the user’s perception of your app.</span></span> <span data-ttu-id="26a69-117">如果你的应用使用大量内存，它对于用户可能显得缓慢或者影响系统上运行的其他应用，或者在某些情况下，它可能使 Windows 或 Windows Phone 应用商店的提交过程失败。</span><span class="sxs-lookup"><span data-stu-id="26a69-117">If your app uses a lot of memory, it may appear sluggish to the user or affect other apps running on the system, or, in some cases, it could fail the Windows Store or Windows Phone Store submission process.</span></span> <span data-ttu-id="26a69-118">此外，如果你确定了执行更频繁的代码部分，则你可以确保代码的这些部分也进行了很好地优化。</span><span class="sxs-lookup"><span data-stu-id="26a69-118">Also, if you determine which parts of your code execute more frequently, you can make sure that these portions of your code are well optimized.</span></span>  
  
## <a name="analyzing-performance"></a><span data-ttu-id="26a69-119">分析性能</span><span class="sxs-lookup"><span data-stu-id="26a69-119">Analyzing performance</span></span>  
 <span data-ttu-id="26a69-120">作为你整体开发计划的一部分，在你将测量应用性能的开发过程中设置要点，并与你之前设定的目标比较结果。</span><span class="sxs-lookup"><span data-stu-id="26a69-120">As part of your overall development plan, set points during development where you will measure the performance of your app and compare the results with the goals you set previously.</span></span> <span data-ttu-id="26a69-121">在你希望用户所具有的环境和硬件中测量应用。</span><span class="sxs-lookup"><span data-stu-id="26a69-121">Measure your app in the environment and hardware that you expect your users to have.</span></span> <span data-ttu-id="26a69-122">通过尽早并经常分析你的应用的性能，你可以更改那些在开发周期后期修复成本极为昂贵的体系结构决策。</span><span class="sxs-lookup"><span data-stu-id="26a69-122">By analyzing your app’s performance early and often you can change architectural decisions that would be costly and expensive to fix later in the development cycle.</span></span> <span data-ttu-id="26a69-123">以下各部分描述你可以用来分析应用和讨论事件跟踪的性能工具，该事件跟踪由这些工具使用。</span><span class="sxs-lookup"><span data-stu-id="26a69-123">The following sections describe performance tools you can use to analyze your apps and discuss event tracing, which is used by these tools.</span></span>  
  
### <a name="performance-tools"></a><span data-ttu-id="26a69-124">性能工具</span><span class="sxs-lookup"><span data-stu-id="26a69-124">Performance tools</span></span>  
 <span data-ttu-id="26a69-125">以下是一些你可以与 .NET Framework 应用一起使用的性能工具。</span><span class="sxs-lookup"><span data-stu-id="26a69-125">Here are some of the performance tools you can use with your .NET Framework apps.</span></span>  
  
|<span data-ttu-id="26a69-126">工具</span><span class="sxs-lookup"><span data-stu-id="26a69-126">Tool</span></span>|<span data-ttu-id="26a69-127">说明</span><span class="sxs-lookup"><span data-stu-id="26a69-127">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="26a69-128">Visual Studio 性能分析</span><span class="sxs-lookup"><span data-stu-id="26a69-128">Visual Studio Performance Analysis</span></span>|<span data-ttu-id="26a69-129">用于分析你的 .NET Framework 应用的 CPU 使用情况，该应用将部署到运行 Windows 操作系统的计算机。</span><span class="sxs-lookup"><span data-stu-id="26a69-129">Use to analyze the CPU usage of your .NET Framework apps that will be deployed to computers that are running the Windows operating system.</span></span><br /><br /> <span data-ttu-id="26a69-130">在打开一个项目后，此工具可以从 Visual Studio 中的“调试”菜单处获取\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="26a69-130">This tool is available from the **Debug** menu in Visual Studio after you open a project.</span></span> <span data-ttu-id="26a69-131">有关更多信息，请参见 [性能资源管理器](/visualstudio/profiling/performance-explorer)。</span><span class="sxs-lookup"><span data-stu-id="26a69-131">For more information, see [Performance Explorer](/visualstudio/profiling/performance-explorer).</span></span> <span data-ttu-id="26a69-132">**注意**：面向 Windows Phone 时，请使用 Windows Phone 应用程序分析（参见下一行）。</span><span class="sxs-lookup"><span data-stu-id="26a69-132">**Note:**  Use Windows Phone Application Analysis (see next row) when targeting Windows Phone.</span></span>|  
|<span data-ttu-id="26a69-133">Windows Phone 应用程序分析</span><span class="sxs-lookup"><span data-stu-id="26a69-133">Windows Phone Application Analysis</span></span>|<span data-ttu-id="26a69-134">用于分析在你的 Windows Phone 应用中的 CPU 和内存、网络数据传输率、应用响应能力和电池消耗。</span><span class="sxs-lookup"><span data-stu-id="26a69-134">Use to analyze the CPU and memory, network data transfer rate, app responsiveness, and battery consumption in your Windows Phone apps.</span></span><br /><br /> <span data-ttu-id="26a69-135">安装 [Windows Phone SDK](https://go.microsoft.com/fwlink/?LinkId=265773) 后，此工具可以从 Visual Studio 中 Windows Phone 项目的“调试”菜单获取\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="26a69-135">This tool is available from the **Debug** menu for a Windows Phone project in Visual Studio after you install the [Windows Phone SDK](https://go.microsoft.com/fwlink/?LinkId=265773).</span></span> <span data-ttu-id="26a69-136">有关详细信息，请参阅[Windows Phone 8 的应用程序分析](https://docs.microsoft.com/previous-versions/windows/apps/jj215908(v=vs.105))。</span><span class="sxs-lookup"><span data-stu-id="26a69-136">For more information, see [App profiling for Windows Phone 8](https://docs.microsoft.com/previous-versions/windows/apps/jj215908(v=vs.105)).</span></span>|  
|[<span data-ttu-id="26a69-137">PerfView</span><span class="sxs-lookup"><span data-stu-id="26a69-137">PerfView</span></span>](https://www.microsoft.com/download/details.aspx?id=28567)|<span data-ttu-id="26a69-138">用于识别 CPU 以及与内存相关的性能问题。</span><span class="sxs-lookup"><span data-stu-id="26a69-138">Use to identify CPU and memory-related performance issues.</span></span> <span data-ttu-id="26a69-139">此工具使用针对 Windows (ETW) 和 CLR 分析 API 的事件跟踪以提供高级内存和 CPU 调查以及关于垃圾回收和 JIT 编译的信息。</span><span class="sxs-lookup"><span data-stu-id="26a69-139">This tool uses event tracing for Windows (ETW)  and CLR profiling APIs to provide advanced memory and CPU investigations as well as information about garbage collection and JIT compilation.</span></span> <span data-ttu-id="26a69-140">有关如何使用 PerfView 的详细信息，请参阅应用附带的教程和帮助文件：[第 9 频道视频教程](https://channel9.msdn.com/Series/PerfView-Tutorial)和[博客文章](https://docs.microsoft.com/archive/blogs/vancem/)。</span><span class="sxs-lookup"><span data-stu-id="26a69-140">For more information about how to use PerfView, see the tutorial and help files that are included with the app, [Channel 9 video tutorials](https://channel9.msdn.com/Series/PerfView-Tutorial), and [blog posts](https://docs.microsoft.com/archive/blogs/vancem/).</span></span><br /><br /> <span data-ttu-id="26a69-141">对于特定于内存的问题，请参阅[使用 PerfView 进行内存调查](https://channel9.msdn.com/Series/PerfView-Tutorial/PerfView-Tutorial-9-NET-Memory-Investigation-Basics-of-GC-Heap-Snapshots)。</span><span class="sxs-lookup"><span data-stu-id="26a69-141">For memory-specific issues, see [Using PerfView for Memory Investigations](https://channel9.msdn.com/Series/PerfView-Tutorial/PerfView-Tutorial-9-NET-Memory-Investigation-Basics-of-GC-Heap-Snapshots).</span></span>|  
|[<span data-ttu-id="26a69-142">Windows Performance Analyzer</span><span class="sxs-lookup"><span data-stu-id="26a69-142">Windows Performance Analyzer</span></span>](https://www.microsoft.com/download/details.aspx?id=30652)|<span data-ttu-id="26a69-143">用于确定整体系统性能，如在多个应用在同一台计算机上运行时，你的应用的内存和存储使用情况。</span><span class="sxs-lookup"><span data-stu-id="26a69-143">Use to determine overall system performance such as your app's memory and storage use when multiple apps are running on the same computer.</span></span> <span data-ttu-id="26a69-144">此工具可从下载中心获得，作为适用于 Windows 8 的 Windows 评估和部署工具包（ADK）的一部分。</span><span class="sxs-lookup"><span data-stu-id="26a69-144">This tool is available from the download center as part of the Windows Assessment and Deployment Kit (ADK) for Windows 8.</span></span> <span data-ttu-id="26a69-145">有关详细信息，请参阅 [Windows Performance Analyzer](/windows-hardware/test/wpt/windows-performance-analyzer)。</span><span class="sxs-lookup"><span data-stu-id="26a69-145">For more information, see [Windows Performance Analyzer](/windows-hardware/test/wpt/windows-performance-analyzer).</span></span>|
  
### <a name="event-tracing-for-windows-etw"></a><span data-ttu-id="26a69-146">针对 Windows (ETW) 的事件跟踪</span><span class="sxs-lookup"><span data-stu-id="26a69-146">Event tracing for Windows (ETW)</span></span>  
 <span data-ttu-id="26a69-147">ETW 是一种技术，可以让你获取有关运行代码的诊断信息，并且对于很多前面提到的性能工具而言必不可少。</span><span class="sxs-lookup"><span data-stu-id="26a69-147">ETW is a technique that lets you obtain diagnostic information about running code and is essential for many of the performance tools mentioned previously.</span></span> <span data-ttu-id="26a69-148">在特定的事件由 .NET Framework 应用和 Windows 引发时，ETW 将创建日志。</span><span class="sxs-lookup"><span data-stu-id="26a69-148">ETW creates logs when particular events are raised by .NET Framework apps and Windows.</span></span> <span data-ttu-id="26a69-149">使用 ETW，你可以动态启用和禁用日志记录，这样就可以在不重新启动应用的情况下在生产环境中进行详细的跟踪。</span><span class="sxs-lookup"><span data-stu-id="26a69-149">With ETW, you can enable and disable logging dynamically, so that you can perform detailed tracing in a production environment without restarting your app.</span></span> <span data-ttu-id="26a69-150">.NET Framework 为 ETW 事件提供支持，并且 ETW 供许多分析和性能工具使用以生成性能数据。</span><span class="sxs-lookup"><span data-stu-id="26a69-150">The .NET Framework offers support for ETW events, and ETW is used by many profiling and performance tools to generate performance data.</span></span> <span data-ttu-id="26a69-151">这些工具经常启用和禁用 ETW 事件，因此熟悉它们很有帮助。</span><span class="sxs-lookup"><span data-stu-id="26a69-151">These tools often enable and disable ETW events, so familiarity with them is helpful.</span></span> <span data-ttu-id="26a69-152">你可以使用特定 ETW 事件以收集关于你的应用的特定组件的性能信息。</span><span class="sxs-lookup"><span data-stu-id="26a69-152">You can use specific ETW events to collect performance information about particular components of your app.</span></span> <span data-ttu-id="26a69-153">有关 .NET Framework 中 ETW 支持的详细信息，请参阅[公共语言运行时中的 ETW 事件](etw-events-in-the-common-language-runtime.md)和[任务并行库和 PLINQ 中的 ETW 事件](etw-events-in-task-parallel-library-and-plinq.md)。</span><span class="sxs-lookup"><span data-stu-id="26a69-153">For more information about ETW support in the .NET Framework, see [ETW Events in the Common Language Runtime](etw-events-in-the-common-language-runtime.md) and [ETW Events in Task Parallel Library and PLINQ](etw-events-in-task-parallel-library-and-plinq.md).</span></span>  
  
## <a name="performance-by-app-type"></a><span data-ttu-id="26a69-154">按应用程序类型的性能</span><span class="sxs-lookup"><span data-stu-id="26a69-154">Performance by app type</span></span>  
 <span data-ttu-id="26a69-155">每种 .NET Framework 应用都具有它自己的最佳实践、注意事项以及评估性能的工具。</span><span class="sxs-lookup"><span data-stu-id="26a69-155">Each type of .NET Framework app has its own best practices, considerations, and tools for evaluating performance.</span></span> <span data-ttu-id="26a69-156">下表提供指向特定 .NET Framework 应用类型的性能主题的链接。</span><span class="sxs-lookup"><span data-stu-id="26a69-156">The following table links to performance topics for specific .NET Framework app types.</span></span>  
  
|<span data-ttu-id="26a69-157">应用类型</span><span class="sxs-lookup"><span data-stu-id="26a69-157">App type</span></span>|<span data-ttu-id="26a69-158">请参阅</span><span class="sxs-lookup"><span data-stu-id="26a69-158">See</span></span>|  
|--------------|---------|  
|<span data-ttu-id="26a69-159">针对所有平台的 .NET Framework 应用</span><span class="sxs-lookup"><span data-stu-id="26a69-159">.NET Framework apps for all platforms</span></span>|[<span data-ttu-id="26a69-160">垃圾回收和性能</span><span class="sxs-lookup"><span data-stu-id="26a69-160">Garbage Collection and Performance</span></span>](../../standard/garbage-collection/performance.md)<br /><br /> [<span data-ttu-id="26a69-161">性能提示</span><span class="sxs-lookup"><span data-stu-id="26a69-161">Performance Tips</span></span>](performance-tips.md)|  
|<span data-ttu-id="26a69-162">用 c + +、c # 和 Visual Basic 编写的 Windows 8.x 应用商店应用</span><span class="sxs-lookup"><span data-stu-id="26a69-162">Windows 8.x Store apps written in C++, C#, and Visual Basic</span></span>|[<span data-ttu-id="26a69-163">使用 C++、C# 和 Visual Basic 的 Windows 应用商店应用的性能最佳做法</span><span class="sxs-lookup"><span data-stu-id="26a69-163">Performance best practices for Windows Store apps using C++, C#, and Visual Basic</span></span>](https://docs.microsoft.com/previous-versions/windows/apps/hh750313%28v=win.10%29)|  
|<span data-ttu-id="26a69-164">Windows Presentation Foundation (WPF)</span><span class="sxs-lookup"><span data-stu-id="26a69-164">Windows Presentation Foundation (WPF)</span></span>|<span data-ttu-id="26a69-165">[WPF 性能套件](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aa969767(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="26a69-165">[WPF Performance Suite](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aa969767(v=vs.100))</span></span>|  
|<span data-ttu-id="26a69-166">ASP.NET</span><span class="sxs-lookup"><span data-stu-id="26a69-166">ASP.NET</span></span>|<span data-ttu-id="26a69-167">[ASP.NET 性能概述](https://docs.microsoft.com/previous-versions/aspnet/cc668225(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="26a69-167">[ASP.NET Performance Overview](https://docs.microsoft.com/previous-versions/aspnet/cc668225(v=vs.100))</span></span>|  
  
## <a name="related-topics"></a><span data-ttu-id="26a69-168">相关主题</span><span class="sxs-lookup"><span data-stu-id="26a69-168">Related Topics</span></span>  
  
|<span data-ttu-id="26a69-169">Title</span><span class="sxs-lookup"><span data-stu-id="26a69-169">Title</span></span>|<span data-ttu-id="26a69-170">说明</span><span class="sxs-lookup"><span data-stu-id="26a69-170">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="26a69-171">.NET Framework 应用程序中的缓存</span><span class="sxs-lookup"><span data-stu-id="26a69-171">Caching in .NET Framework Applications</span></span>](caching-in-net-framework-applications.md)|<span data-ttu-id="26a69-172">描述用于缓存数据以提高应用性能的技术。</span><span class="sxs-lookup"><span data-stu-id="26a69-172">Describes techniques for caching data to improve performance in your app.</span></span>|  
|[<span data-ttu-id="26a69-173">延迟初始化</span><span class="sxs-lookup"><span data-stu-id="26a69-173">Lazy Initialization</span></span>](lazy-initialization.md)|<span data-ttu-id="26a69-174">描述如何按需初始化对象以提高性能，尤其是在应用启动时。</span><span class="sxs-lookup"><span data-stu-id="26a69-174">Describes how to initialize objects as-needed to improve performance, particularly at app startup.</span></span>|  
|[<span data-ttu-id="26a69-175">可靠性</span><span class="sxs-lookup"><span data-stu-id="26a69-175">Reliability</span></span>](reliability.md)|<span data-ttu-id="26a69-176">提供有关在服务器环境中防止异步异常的信息。</span><span class="sxs-lookup"><span data-stu-id="26a69-176">Provides information about preventing asynchronous exceptions in a server environment.</span></span>|  
|[<span data-ttu-id="26a69-177">编写大型的响应式 .NET Framework 应用</span><span class="sxs-lookup"><span data-stu-id="26a69-177">Writing Large, Responsive .NET Framework Apps</span></span>](writing-large-responsive-apps.md)|<span data-ttu-id="26a69-178">提供从托管代码中重写的 C# 和 Visual Basic 编译器收集的性能提示，并且包括来自 C# 编译器的几个真实示例。</span><span class="sxs-lookup"><span data-stu-id="26a69-178">Provides performance tips gathered from rewriting the C# and Visual Basic compilers in managed code, and includes several real examples from the C# compiler.</span></span>|
