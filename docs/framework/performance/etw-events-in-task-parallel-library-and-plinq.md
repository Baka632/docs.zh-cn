---
title: 任务并行库和 PLINQ 中的 ETW 事件
description: 阅读任务并行库和 PLINQ 中的 ETW 事件。 使用这些事件对应用程序进行分析和故障排除。
ms.date: 03/30/2017
helpviewer_keywords:
- tasks, ETW events
ms.assetid: 87a9cff5-d86f-4e44-a06e-d12764d0dce2
ms.openlocfilehash: a1a068b7ba94d5e5be4fd90d6adb48b0d25a8b9e
ms.sourcegitcommit: 0fa2b7b658bf137e813a7f4d09589d64c148ebf5
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/14/2020
ms.locfileid: "86309633"
---
# <a name="etw-events-in-task-parallel-library-and-plinq"></a><span data-ttu-id="0e724-104">任务并行库和 PLINQ 中的 ETW 事件</span><span class="sxs-lookup"><span data-stu-id="0e724-104">ETW Events in Task Parallel Library and PLINQ</span></span>

<span data-ttu-id="0e724-105">任务并行库和 PLINQ 均可生成 Windows 事件跟踪 (ETW) 事件，通过 Windows 性能分析器等工具使用这些事件可分析并排除应用程序故障。</span><span class="sxs-lookup"><span data-stu-id="0e724-105">Both the Task Parallel Library and PLINQ generate Event Trace for Windows (ETW) events that you can use to profile and troubleshoot applications by using tools such as the Windows Performance Analyzer.</span></span> <span data-ttu-id="0e724-106">但在大多数情况下，分析并行应用程序代码的最佳方式是在 Visual Studio 中使用[并发可视化工具](/visualstudio/profiling/concurrency-visualizer)。</span><span class="sxs-lookup"><span data-stu-id="0e724-106">However, in most scenarios, the best way to profile parallel application code is to use the [Concurrency Visualizer](/visualstudio/profiling/concurrency-visualizer) in Visual Studio.</span></span>

## <a name="task-parallel-library-etw-events"></a><span data-ttu-id="0e724-107">任务并行库 ETW 事件</span><span class="sxs-lookup"><span data-stu-id="0e724-107">Task Parallel Library ETW Events</span></span>

<span data-ttu-id="0e724-108">在 EVENT_HEADER 结构中，<xref:System.Threading.Tasks.Parallel.For%2A?displayProperty=nameWithType><xref:System.Threading.Tasks.Parallel.ForEach%2A?displayProperty=nameWithType> 和 <xref:System.Threading.Tasks.Parallel.Invoke%2A?displayProperty=nameWithType> 生成的事件的 ProviderId GUID 为：</span><span class="sxs-lookup"><span data-stu-id="0e724-108">In the EVENT_HEADER structure, the ProviderId GUID for events generated by <xref:System.Threading.Tasks.Parallel.For%2A?displayProperty=nameWithType>, <xref:System.Threading.Tasks.Parallel.ForEach%2A?displayProperty=nameWithType> and <xref:System.Threading.Tasks.Parallel.Invoke%2A?displayProperty=nameWithType> is:</span></span>

`0x2e5dba47, 0xa3d2, 0x4d16, 0x8e, 0xe0, 0x66, 0x71, 0xff, 0xdc, 0xd7, 0xb5`

### <a name="parallel-loop-begin"></a><span data-ttu-id="0e724-109">并行循环开始</span><span class="sxs-lookup"><span data-stu-id="0e724-109">Parallel Loop Begin</span></span>

<span data-ttu-id="0e724-110">EVENT_DESCRIPTOR.Task = 1</span><span class="sxs-lookup"><span data-stu-id="0e724-110">EVENT_DESCRIPTOR.Task = 1</span></span>

<span data-ttu-id="0e724-111">EVENT_DESCRIPTOR.Id = 1</span><span class="sxs-lookup"><span data-stu-id="0e724-111">EVENT_DESCRIPTOR.Id = 1</span></span>

#### <a name="user-data"></a><span data-ttu-id="0e724-112">用户数据</span><span class="sxs-lookup"><span data-stu-id="0e724-112">User Data</span></span>

|<span data-ttu-id="0e724-113">**名称**</span><span class="sxs-lookup"><span data-stu-id="0e724-113">**Name**</span></span>|<span data-ttu-id="0e724-114">类型</span><span class="sxs-lookup"><span data-stu-id="0e724-114">**Type**</span></span>|<span data-ttu-id="0e724-115">**说明**</span><span class="sxs-lookup"><span data-stu-id="0e724-115">**Description**</span></span>|
|--------------|--------------|---------------------|
|<span data-ttu-id="0e724-116">OriginatingTaskSchedulerID</span><span class="sxs-lookup"><span data-stu-id="0e724-116">OriginatingTaskSchedulerID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-117">启动循环的 TaskScheduler 的 ID。</span><span class="sxs-lookup"><span data-stu-id="0e724-117">The ID of the TaskScheduler that started the loop.</span></span>|
|<span data-ttu-id="0e724-118">OriginatingTaskID</span><span class="sxs-lookup"><span data-stu-id="0e724-118">OriginatingTaskID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-119">启动循环的任务的 ID。</span><span class="sxs-lookup"><span data-stu-id="0e724-119">The ID of the task that started the loop.</span></span>|
|<span data-ttu-id="0e724-120">ForkJoinContextID</span><span class="sxs-lookup"><span data-stu-id="0e724-120">ForkJoinContextID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-121">用于为具有分叉/联接语义的事件指示嵌套和对的唯一标识符。</span><span class="sxs-lookup"><span data-stu-id="0e724-121">A unique identifier used to indicate nesting and pairs for events with fork/join semantics.</span></span>|
|<span data-ttu-id="0e724-122">OperationType</span><span class="sxs-lookup"><span data-stu-id="0e724-122">OperationType</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-123">指示循环的类型：</span><span class="sxs-lookup"><span data-stu-id="0e724-123">Indicates the type of loop:</span></span><br /><br /> <span data-ttu-id="0e724-124">1 = ParallelInvoke</span><span class="sxs-lookup"><span data-stu-id="0e724-124">1 = ParallelInvoke</span></span><br /><br /> <span data-ttu-id="0e724-125">2 = ParallelFor</span><span class="sxs-lookup"><span data-stu-id="0e724-125">2 = ParallelFor</span></span><br /><br /> <span data-ttu-id="0e724-126">3 = ParallelForEach</span><span class="sxs-lookup"><span data-stu-id="0e724-126">3 = ParallelForEach</span></span>|
|<span data-ttu-id="0e724-127">InclusiveFrom</span><span class="sxs-lookup"><span data-stu-id="0e724-127">InclusiveFrom</span></span>|<xref:System.Int64?displayProperty=nameWithType>|<span data-ttu-id="0e724-128">循环计数器的起始值</span><span class="sxs-lookup"><span data-stu-id="0e724-128">The starting value of the loop counter</span></span>|
|<span data-ttu-id="0e724-129">ExclusiveTo</span><span class="sxs-lookup"><span data-stu-id="0e724-129">ExclusiveTo</span></span>|<xref:System.Int64?displayProperty=nameWithType>|<span data-ttu-id="0e724-130">循环计数器的结束值</span><span class="sxs-lookup"><span data-stu-id="0e724-130">The ending value of the loop counter</span></span>|

### <a name="parallel-loop-end"></a><span data-ttu-id="0e724-131">并行循环结束</span><span class="sxs-lookup"><span data-stu-id="0e724-131">Parallel Loop End</span></span>
 <span data-ttu-id="0e724-132">EVENT_DESCRIPTOR.Task = 2</span><span class="sxs-lookup"><span data-stu-id="0e724-132">EVENT_DESCRIPTOR.Task = 2</span></span>

 <span data-ttu-id="0e724-133">EVENT_DESCRIPTOR.Id = 2</span><span class="sxs-lookup"><span data-stu-id="0e724-133">EVENT_DESCRIPTOR.Id = 2</span></span>

#### <a name="user-data"></a><span data-ttu-id="0e724-134">用户数据</span><span class="sxs-lookup"><span data-stu-id="0e724-134">User Data</span></span>

|<span data-ttu-id="0e724-135">**名称**</span><span class="sxs-lookup"><span data-stu-id="0e724-135">**Name**</span></span>|<span data-ttu-id="0e724-136">类型</span><span class="sxs-lookup"><span data-stu-id="0e724-136">**Type**</span></span>|<span data-ttu-id="0e724-137">**说明**</span><span class="sxs-lookup"><span data-stu-id="0e724-137">**Description**</span></span>|
|--------------|--------------|---------------------|
|<span data-ttu-id="0e724-138">OriginatingTaskSchedulerID</span><span class="sxs-lookup"><span data-stu-id="0e724-138">OriginatingTaskSchedulerID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-139">启动循环的 TaskScheduler 的 ID。</span><span class="sxs-lookup"><span data-stu-id="0e724-139">The ID of the TaskScheduler that started the loop.</span></span>|
|<span data-ttu-id="0e724-140">OriginatingTaskID</span><span class="sxs-lookup"><span data-stu-id="0e724-140">OriginatingTaskID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-141">启动循环的任务的 ID。</span><span class="sxs-lookup"><span data-stu-id="0e724-141">The ID of the task that started the loop.</span></span>|
|<span data-ttu-id="0e724-142">ForkJoinContextID</span><span class="sxs-lookup"><span data-stu-id="0e724-142">ForkJoinContextID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-143">用于为具有分叉/联接语义的事件指示嵌套和对的唯一标识符。</span><span class="sxs-lookup"><span data-stu-id="0e724-143">A unique identifier used to indicate nesting and pairs for events with fork/join semantics.</span></span>|
|<span data-ttu-id="0e724-144">totalIterations</span><span class="sxs-lookup"><span data-stu-id="0e724-144">totalIterations</span></span>|<xref:System.Int64?displayProperty=nameWithType>|<span data-ttu-id="0e724-145">迭代总次数</span><span class="sxs-lookup"><span data-stu-id="0e724-145">The total number of iterations</span></span>|

### <a name="parallel-invoke-begin"></a><span data-ttu-id="0e724-146">并行调用开始</span><span class="sxs-lookup"><span data-stu-id="0e724-146">Parallel Invoke Begin</span></span>
 <span data-ttu-id="0e724-147">EVENT_DESCRIPTOR.Task = 3</span><span class="sxs-lookup"><span data-stu-id="0e724-147">EVENT_DESCRIPTOR.Task = 3</span></span>

 <span data-ttu-id="0e724-148">EVENT_DESCRIPTOR.Id = 3</span><span class="sxs-lookup"><span data-stu-id="0e724-148">EVENT_DESCRIPTOR.Id = 3</span></span>

#### <a name="user-data"></a><span data-ttu-id="0e724-149">用户数据</span><span class="sxs-lookup"><span data-stu-id="0e724-149">User Data</span></span>

|<span data-ttu-id="0e724-150">**名称**</span><span class="sxs-lookup"><span data-stu-id="0e724-150">**Name**</span></span>|<span data-ttu-id="0e724-151">类型</span><span class="sxs-lookup"><span data-stu-id="0e724-151">**Type**</span></span>|<span data-ttu-id="0e724-152">**说明**</span><span class="sxs-lookup"><span data-stu-id="0e724-152">**Description**</span></span>|
|--------------|--------------|---------------------|
|<span data-ttu-id="0e724-153">OriginatingTaskSchedulerID</span><span class="sxs-lookup"><span data-stu-id="0e724-153">OriginatingTaskSchedulerID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-154">启动循环的 TaskScheduler 的 ID。</span><span class="sxs-lookup"><span data-stu-id="0e724-154">The ID of the TaskScheduler that started the loop.</span></span>|
|<span data-ttu-id="0e724-155">OriginatingTaskID</span><span class="sxs-lookup"><span data-stu-id="0e724-155">OriginatingTaskID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-156">启动循环的任务的 ID。</span><span class="sxs-lookup"><span data-stu-id="0e724-156">The ID of the task that started the loop.</span></span>|
|<span data-ttu-id="0e724-157">ForkJoinContextID</span><span class="sxs-lookup"><span data-stu-id="0e724-157">ForkJoinContextID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-158">用于为具有分叉/联接语义的事件指示嵌套和对的唯一标识符。</span><span class="sxs-lookup"><span data-stu-id="0e724-158">A unique identifier used to indicate nesting and pairs for events with fork/join semantics.</span></span>|
|<span data-ttu-id="0e724-159">totalIterations</span><span class="sxs-lookup"><span data-stu-id="0e724-159">totalIterations</span></span>|<xref:System.Int64?displayProperty=nameWithType>|<span data-ttu-id="0e724-160">迭代总次数</span><span class="sxs-lookup"><span data-stu-id="0e724-160">The total number of iterations</span></span>|
|<span data-ttu-id="0e724-161">operationType</span><span class="sxs-lookup"><span data-stu-id="0e724-161">operationType</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-162">指示循环的类型：</span><span class="sxs-lookup"><span data-stu-id="0e724-162">Indicates the type of loop:</span></span><br /><br /> <span data-ttu-id="0e724-163">1 = ParallelInvoke</span><span class="sxs-lookup"><span data-stu-id="0e724-163">1 = ParallelInvoke</span></span><br /><br /> <span data-ttu-id="0e724-164">2 = ParallelFor</span><span class="sxs-lookup"><span data-stu-id="0e724-164">2 = ParallelFor</span></span><br /><br /> <span data-ttu-id="0e724-165">3 = ParallelForEach</span><span class="sxs-lookup"><span data-stu-id="0e724-165">3 = ParallelForEach</span></span>|
|<span data-ttu-id="0e724-166">ActionCount</span><span class="sxs-lookup"><span data-stu-id="0e724-166">ActionCount</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-167">将在并行调用中执行的操作数。</span><span class="sxs-lookup"><span data-stu-id="0e724-167">The number of actions that will be executed in the parallel invoke.</span></span>|

### <a name="parallel-invoke-end"></a><span data-ttu-id="0e724-168">并行调用结束</span><span class="sxs-lookup"><span data-stu-id="0e724-168">Parallel Invoke End</span></span>
 <span data-ttu-id="0e724-169">EVENT_DESCRIPTOR.Task = 4</span><span class="sxs-lookup"><span data-stu-id="0e724-169">EVENT_DESCRIPTOR.Task = 4</span></span>

 <span data-ttu-id="0e724-170">EVENT_DESCRIPTOR.Id = 4</span><span class="sxs-lookup"><span data-stu-id="0e724-170">EVENT_DESCRIPTOR.Id = 4</span></span>

#### <a name="user-data"></a><span data-ttu-id="0e724-171">用户数据</span><span class="sxs-lookup"><span data-stu-id="0e724-171">User Data</span></span>

|<span data-ttu-id="0e724-172">**名称**</span><span class="sxs-lookup"><span data-stu-id="0e724-172">**Name**</span></span>|<span data-ttu-id="0e724-173">类型</span><span class="sxs-lookup"><span data-stu-id="0e724-173">**Type**</span></span>|<span data-ttu-id="0e724-174">**说明**</span><span class="sxs-lookup"><span data-stu-id="0e724-174">**Description**</span></span>|
|--------------|--------------|---------------------|
|<span data-ttu-id="0e724-175">OriginatingTaskSchedulerID</span><span class="sxs-lookup"><span data-stu-id="0e724-175">OriginatingTaskSchedulerID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-176">启动循环的 TaskScheduler 的 ID。</span><span class="sxs-lookup"><span data-stu-id="0e724-176">The ID of the TaskScheduler that started the loop.</span></span>|
|<span data-ttu-id="0e724-177">OriginatingTaskID</span><span class="sxs-lookup"><span data-stu-id="0e724-177">OriginatingTaskID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-178">启动循环的任务的 ID。</span><span class="sxs-lookup"><span data-stu-id="0e724-178">The ID of the task that started the loop.</span></span>|
|<span data-ttu-id="0e724-179">ForkJoinContextID</span><span class="sxs-lookup"><span data-stu-id="0e724-179">ForkJoinContextID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-180">用于为具有分叉/联接语义的事件指示嵌套和对的唯一标识符。</span><span class="sxs-lookup"><span data-stu-id="0e724-180">A unique identifier used to indicate nesting and pairs for events with fork/join semantics.</span></span>|

## <a name="plinq-etw-events"></a><span data-ttu-id="0e724-181">PINQ ETW 事件</span><span class="sxs-lookup"><span data-stu-id="0e724-181">PLINQ ETW Events</span></span>
 <span data-ttu-id="0e724-182">PLINQ 的 EVENT_HEADER.ProviderId GUID 为：</span><span class="sxs-lookup"><span data-stu-id="0e724-182">The EVENT_HEADER.ProviderId GUID for PLINQ is:</span></span>

`0x159eeeec, 0x4a14, 0x4418, 0xa8, 0xfe, 0xfa, 0xab, 0xcd, 0x98, 0x78, 0x87`

### <a name="parallel-query-begin"></a><span data-ttu-id="0e724-183">并行查询开始</span><span class="sxs-lookup"><span data-stu-id="0e724-183">Parallel Query Begin</span></span>
 <span data-ttu-id="0e724-184">EVENT_DESCRIPTOR.Task = 1</span><span class="sxs-lookup"><span data-stu-id="0e724-184">EVENT_DESCRIPTOR.Task = 1</span></span>

 <span data-ttu-id="0e724-185">EVENT_DESCRIPTOR.Id = 1</span><span class="sxs-lookup"><span data-stu-id="0e724-185">EVENT_DESCRIPTOR.Id = 1</span></span>

#### <a name="user-data"></a><span data-ttu-id="0e724-186">用户数据</span><span class="sxs-lookup"><span data-stu-id="0e724-186">User Data</span></span>

|<span data-ttu-id="0e724-187">**名称**</span><span class="sxs-lookup"><span data-stu-id="0e724-187">**Name**</span></span>|<span data-ttu-id="0e724-188">类型</span><span class="sxs-lookup"><span data-stu-id="0e724-188">**Type**</span></span>|<span data-ttu-id="0e724-189">**说明**</span><span class="sxs-lookup"><span data-stu-id="0e724-189">**Description**</span></span>|
|--------------|--------------|---------------------|
|<span data-ttu-id="0e724-190">OriginatingTaskSchedulerID</span><span class="sxs-lookup"><span data-stu-id="0e724-190">OriginatingTaskSchedulerID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-191">启动循环的 TaskScheduler 的 ID。</span><span class="sxs-lookup"><span data-stu-id="0e724-191">The ID of the TaskScheduler that started the loop.</span></span>|
|<span data-ttu-id="0e724-192">OriginatingTaskID</span><span class="sxs-lookup"><span data-stu-id="0e724-192">OriginatingTaskID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-193">启动循环的任务的 ID。</span><span class="sxs-lookup"><span data-stu-id="0e724-193">The ID of the task that started the loop.</span></span>|
|<span data-ttu-id="0e724-194">QueryID</span><span class="sxs-lookup"><span data-stu-id="0e724-194">QueryID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-195">唯一的查询标识符。</span><span class="sxs-lookup"><span data-stu-id="0e724-195">A unique query identifier.</span></span>|

### <a name="parallel-query-end"></a><span data-ttu-id="0e724-196">并行查询结束</span><span class="sxs-lookup"><span data-stu-id="0e724-196">Parallel Query End</span></span>
 <span data-ttu-id="0e724-197">EVENT_DESCRIPTOR.Task = 2</span><span class="sxs-lookup"><span data-stu-id="0e724-197">EVENT_DESCRIPTOR.Task = 2</span></span>

 <span data-ttu-id="0e724-198">EVENT_DESCRIPTOR.Id = 2</span><span class="sxs-lookup"><span data-stu-id="0e724-198">EVENT_DESCRIPTOR.Id = 2</span></span>

#### <a name="user-data"></a><span data-ttu-id="0e724-199">用户数据</span><span class="sxs-lookup"><span data-stu-id="0e724-199">User Data</span></span>

|<span data-ttu-id="0e724-200">**名称**</span><span class="sxs-lookup"><span data-stu-id="0e724-200">**Name**</span></span>|<span data-ttu-id="0e724-201">类型</span><span class="sxs-lookup"><span data-stu-id="0e724-201">**Type**</span></span>|<span data-ttu-id="0e724-202">**说明**</span><span class="sxs-lookup"><span data-stu-id="0e724-202">**Description**</span></span>|
|--------------|--------------|---------------------|
|<span data-ttu-id="0e724-203">OriginatingTaskSchedulerID</span><span class="sxs-lookup"><span data-stu-id="0e724-203">OriginatingTaskSchedulerID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-204">启动循环的 TaskScheduler 的 ID。</span><span class="sxs-lookup"><span data-stu-id="0e724-204">The ID of the TaskScheduler that started the loop.</span></span>|
|<span data-ttu-id="0e724-205">OriginatingTaskID</span><span class="sxs-lookup"><span data-stu-id="0e724-205">OriginatingTaskID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-206">启动循环的任务的 ID。</span><span class="sxs-lookup"><span data-stu-id="0e724-206">The ID of the task that started the loop.</span></span>|
|<span data-ttu-id="0e724-207">QueryID</span><span class="sxs-lookup"><span data-stu-id="0e724-207">QueryID</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="0e724-208">唯一的查询标识符。</span><span class="sxs-lookup"><span data-stu-id="0e724-208">A unique query identifier.</span></span>|

## <a name="see-also"></a><span data-ttu-id="0e724-209">另请参阅</span><span class="sxs-lookup"><span data-stu-id="0e724-209">See also</span></span>

- [<span data-ttu-id="0e724-210">ETW Events in the .NET Framework</span><span class="sxs-lookup"><span data-stu-id="0e724-210">ETW Events in the .NET Framework</span></span>](etw-events.md)
- [<span data-ttu-id="0e724-211">任务并行库 (TPL)</span><span class="sxs-lookup"><span data-stu-id="0e724-211">Task Parallel Library (TPL)</span></span>](../../standard/parallel-programming/task-parallel-library-tpl.md)
- [<span data-ttu-id="0e724-212">并行 LINQ (PLINQ)</span><span class="sxs-lookup"><span data-stu-id="0e724-212">Parallel LINQ (PLINQ)</span></span>](../../standard/parallel-programming/introduction-to-plinq.md)
