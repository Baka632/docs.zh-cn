---
title: 可插入协议简介
description: 了解可插入协议，该协议支持开发使用 Internet 资源的应用程序（不考虑资源使用的协议详细信息）。
ms.date: 03/30/2017
helpviewer_keywords:
- data requests, pluggable protocols
- WebRequest class, pluggable protocols
- response to Internet request, pluggable protocols
- URI
- Windows Sockets
- request/response model
- sending data, pluggable protocols
- pluggable protocols
- WebClient class, about WebClient class
- pluggable protocols, about pluggable protocols
- Internet, pluggable protocols
- path identifiers
- Uniform Resource Identifier
- application development [.NET Framework], pluggable protocols
- requesting data from Internet, pluggable protocols
- receiving data, pluggable protocols
- protocols, pluggable
- server identifiers
- scheme identifiers
ms.assetid: 4b48e22d-e4e5-48f0-be80-d549bda97415
ms.openlocfilehash: 5b61497963e785ffe8e4c04db5b54dfb2500eed8
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/26/2020
ms.locfileid: "96279631"
---
# <a name="introducing-pluggable-protocols"></a><span data-ttu-id="c8a57-103">可插入协议简介</span><span class="sxs-lookup"><span data-stu-id="c8a57-103">Introducing Pluggable Protocols</span></span>

<span data-ttu-id="c8a57-104">Microsoft .NET Framework 为 Internet 服务提供了一种分层、可扩展且托管的实现，可以快速、轻松地将其集成到应用程序中。</span><span class="sxs-lookup"><span data-stu-id="c8a57-104">The Microsoft .NET Framework provides a layered, extensible, and managed implementation of Internet services that can be integrated quickly and easily into your applications.</span></span> <span data-ttu-id="c8a57-105"><xref:System.Net> 和 <xref:System.Net.Sockets> 命名空间的 Internet 访问类可用于实现基于 Web 和基于 Internet 的应用程序。</span><span class="sxs-lookup"><span data-stu-id="c8a57-105">The Internet access classes in the <xref:System.Net> and <xref:System.Net.Sockets> namespaces can be used to implement both Web-based and Internet-based applications.</span></span>  
  
## <a name="internet-applications"></a><span data-ttu-id="c8a57-106">Internet 应用程序</span><span class="sxs-lookup"><span data-stu-id="c8a57-106">Internet Applications</span></span>  

 <span data-ttu-id="c8a57-107">Internet 应用程序大致分为两类：请求信息的客户端应用程序和响应客户端的信息请求的服务器应用程序。</span><span class="sxs-lookup"><span data-stu-id="c8a57-107">Internet applications can be classified broadly into two kinds: client applications that request information and server applications that respond to information requests from clients.</span></span> <span data-ttu-id="c8a57-108">经典的 Internet 客户端服务器应用程序是万维网，人们通过万维网，使用浏览器访问文档和存储于全球 Web 服务器中的其他数据。</span><span class="sxs-lookup"><span data-stu-id="c8a57-108">The classic Internet client-server application is the World Wide Web, where people use browsers to access documents and other data stored on Web servers worldwide.</span></span>  
  
 <span data-ttu-id="c8a57-109">应用程序不仅仅局限于其中一种角色；例如，熟悉的中间层应用程序服务器通过从其他服务器请求数据响应客户端请求，在此情况下，它同时充当服务器和客户端。</span><span class="sxs-lookup"><span data-stu-id="c8a57-109">Applications are not limited to just one of these roles; for instance, the familiar middle-tier application server responds to requests from clients by requesting data from another server, in which case it is acting as both a server and a client.</span></span>  
  
 <span data-ttu-id="c8a57-110">客户端应用程序通过标识请求的 Internet 资源和用于请求和响应的通信协议发出请求。</span><span class="sxs-lookup"><span data-stu-id="c8a57-110">The client application makes a request by identifying the requested Internet resource and the communication protocol to use for the request and response.</span></span> <span data-ttu-id="c8a57-111">如有必要，客户端还提供完成请求所需的任何其他数据，例如代理位置或身份验证信息（用户名、密码等）。</span><span class="sxs-lookup"><span data-stu-id="c8a57-111">If necessary, the client also provides any additional data required to complete the request, such as proxy location or authentication information (user name, password, and so on).</span></span> <span data-ttu-id="c8a57-112">形成请求后，可将请求发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="c8a57-112">Once the request is formed, the request can be sent to the server.</span></span>  
  
## <a name="identifying-resources"></a><span data-ttu-id="c8a57-113">标识资源</span><span class="sxs-lookup"><span data-stu-id="c8a57-113">Identifying Resources</span></span>  

 <span data-ttu-id="c8a57-114">.NET Framework 使用统一资源标识符 (URI) 标识请求的 Internet 资源和通信协议。</span><span class="sxs-lookup"><span data-stu-id="c8a57-114">The .NET Framework uses a Uniform Resource Identifier (URI) to identify the requested Internet resource and communication protocol.</span></span> <span data-ttu-id="c8a57-115">URI 由至少三个或者四个片段组成：方案标识符，用于标识请求和响应的通信协议；服务器标识符，其由唯一标识 Internet 上服务器的域名系统 (DNS) 主机名或 TCP 地址组成；路径标识符，其在服务器上查找请求的信息；可选的查询字符串，其将信息从客户端传递到服务器。</span><span class="sxs-lookup"><span data-stu-id="c8a57-115">The URI consists of at least three, and possibly four, fragments: the scheme identifier, which identifies the communications protocol for the request and response; the server identifier, which consists of either a Domain Name System (DNS) host name or a TCP address that uniquely identifies the server on the Internet; the path identifier, which locates the requested information on the server; and an optional query string, which passes information from the client to the server.</span></span> <span data-ttu-id="c8a57-116">例如，URI `http://www.contoso.com/whatsnew.aspx?date=today` 由方案标识符 `http`、服务器标识符 `www.contoso.com`、路径 `/whatsnew.aspx` 和查询字符串 `?date=today` 组成。</span><span class="sxs-lookup"><span data-stu-id="c8a57-116">For example, the URI `http://www.contoso.com/whatsnew.aspx?date=today` consists of the scheme identifier `http`, the server identifier `www.contoso.com`, the path `/whatsnew.aspx`, and the query string `?date=today`.</span></span>  
  
 <span data-ttu-id="c8a57-117">服务器收到请求并处理响应后，会将这些响应返回到客户端应用程序。</span><span class="sxs-lookup"><span data-stu-id="c8a57-117">After the server has received the request and processed the response, it returns the response to the client application.</span></span> <span data-ttu-id="c8a57-118">响应包括补充信息，如内容的类型（例如，原始文本或 XML 数据）。</span><span class="sxs-lookup"><span data-stu-id="c8a57-118">The response includes supplemental information, such as the type of the content (raw text or XML data, for example).</span></span>  
  
## <a name="requests-and-responses-in-the-net-framework"></a><span data-ttu-id="c8a57-119">.NET Framework 的请求和响应</span><span class="sxs-lookup"><span data-stu-id="c8a57-119">Requests and Responses in the .NET Framework</span></span>  

 <span data-ttu-id="c8a57-120">.NET Framework 使用特定的类来提供通过请求/响应模型访问 Internet 资源所需的三个信息：<xref:System.Uri> 类，其中包含你要寻找的 Internet 资源的 URI；<xref:System.Net.WebRequest> 类，其中包含对资源的请求；<xref:System.Net.WebResponse> 类，它为传入的响应提供一个容器。</span><span class="sxs-lookup"><span data-stu-id="c8a57-120">The .NET Framework uses specific classes to provide the three pieces of information required to access Internet resources through a request/response model: the <xref:System.Uri> class, which contains the URI of the Internet resource you are seeking; the <xref:System.Net.WebRequest> class, which contains a request for the resource; and the <xref:System.Net.WebResponse> class, which provides a container for the incoming response.</span></span>  
  
 <span data-ttu-id="c8a57-121">客户端应用程序通过将网络资源的 URI 传递到 <xref:System.Net.WebRequest.Create%2A> 方法创建 `WebRequest` 实例。</span><span class="sxs-lookup"><span data-stu-id="c8a57-121">Client applications create `WebRequest` instances by passing the URI of the network resource to the <xref:System.Net.WebRequest.Create%2A> method.</span></span> <span data-ttu-id="c8a57-122">此静态方法为 HTTP 等特定协议创建 `WebRequest`。</span><span class="sxs-lookup"><span data-stu-id="c8a57-122">This static method creates a `WebRequest` for a specific protocol, such as HTTP.</span></span> <span data-ttu-id="c8a57-123">返回的 `WebRequest` 提供对属性的访问权限，这些属性可同时控制对服务器的请求和对发出请求时发送的数据流的访问。</span><span class="sxs-lookup"><span data-stu-id="c8a57-123">The `WebRequest` that is returned provides access to properties that control both the request to the server and access to the data stream that is sent when the request is made.</span></span> <span data-ttu-id="c8a57-124">`WebRequest` 的 <xref:System.Net.WebRequest.GetResponse%2A> 方法将请求从客户端应用程序发送到 URI 中标识的服务器。</span><span class="sxs-lookup"><span data-stu-id="c8a57-124">The <xref:System.Net.WebRequest.GetResponse%2A> method on the `WebRequest` sends the request from the client application to the server identified in the URI.</span></span> <span data-ttu-id="c8a57-125">在响应可能会延迟的情况下，可使用“WebRequest”的 <xref:System.Net.WebRequest.BeginGetResponse%2A> 方法进行异步请求，并且可使用 <xref:System.Net.WebRequest.EndGetResponse%2A> 方法稍后返回响应。</span><span class="sxs-lookup"><span data-stu-id="c8a57-125">In cases in which the response might be delayed, the request can be made asynchronously using the <xref:System.Net.WebRequest.BeginGetResponse%2A> method on the **WebRequest**, and the response can be returned at a later time using the <xref:System.Net.WebRequest.EndGetResponse%2A> method.</span></span>  
  
 <span data-ttu-id="c8a57-126">“GetResponse”和“EndGetResponse”方法返回“WebResponse”提供对由服务器返回的数据的访问  。</span><span class="sxs-lookup"><span data-stu-id="c8a57-126">The **GetResponse** and **EndGetResponse** methods return a **WebResponse** that provides access to the data returned by the server.</span></span> <span data-ttu-id="c8a57-127">因为此数据提供给请求的应用程序的流的形式 <xref:System.Net.WebResponse.GetResponseStream%2A> 方法，可在任何位置使用数据流的应用程序。</span><span class="sxs-lookup"><span data-stu-id="c8a57-127">Because this data is provided to the requesting application as a stream by the <xref:System.Net.WebResponse.GetResponseStream%2A> method, it can be used in an application anywhere data streams are used.</span></span>  
  
 <span data-ttu-id="c8a57-128">“WebRequest”和“WebResponse”类是可插入协议的基础，实施网络服务可帮助你开发使用 Internet 资源的应用程序，无需担心每个资源使用的协议的具体细节 。</span><span class="sxs-lookup"><span data-stu-id="c8a57-128">The **WebRequest** and **WebResponse** classes are the basis of pluggable protocols — an implementation of network services that enables you to develop applications that use Internet resources without worrying about the specific details of the protocol that each resource uses.</span></span> <span data-ttu-id="c8a57-129">“WebRequest”的子类向“WebRequest”类注册，以管理连接 Internet 资源的细节 。</span><span class="sxs-lookup"><span data-stu-id="c8a57-129">Descendant classes of **WebRequest** are registered with the **WebRequest** class to manage the details of making the actual connections to Internet resources.</span></span>  
  
 <span data-ttu-id="c8a57-130">例如，<xref:System.Net.HttpWebRequest> 类管理使用 HTTP 连接到 Internet 资源的细节。</span><span class="sxs-lookup"><span data-stu-id="c8a57-130">As an example, the <xref:System.Net.HttpWebRequest> class manages the details of connecting to an Internet resource using HTTP.</span></span> <span data-ttu-id="c8a57-131">默认情况下，当 WebRequest.Create 方法遇到以“http:”或“https:”（用于 HTTP 和安全 HTTP 的协议标识符）开头的 URI 时，返回的 WebRequest 可以按原样使用，也可以类型转换为 HttpWebRequest 以访问特定于协议的属性  。</span><span class="sxs-lookup"><span data-stu-id="c8a57-131">By default, when the **WebRequest.Create** method encounters a URI that begins with "http:" or "https:" (the protocol identifiers for HTTP and secure HTTP), the **WebRequest** that is returned can be used as is, or it can be typecast to **HttpWebRequest** to access protocol-specific properties.</span></span> <span data-ttu-id="c8a57-132">在大多数情况下，WebRequest 提供发出请求所需的所有信息。</span><span class="sxs-lookup"><span data-stu-id="c8a57-132">In most cases, the **WebRequest** provides all the necessary information for making a request.</span></span>  
  
 <span data-ttu-id="c8a57-133">任何可以表示为请求/响应事务的协议都可用于 WebRequest 。</span><span class="sxs-lookup"><span data-stu-id="c8a57-133">Any protocol that can be represented as a request/response transaction can be used in a **WebRequest**.</span></span> <span data-ttu-id="c8a57-134">可以从 WebRequest 和 WebResponse 派生特定于协议的类，然后通过静态 <xref:System.Net.WebRequest.RegisterPrefix%2A?displayProperty=nameWithType> 方法注册它们以供应用程序使用 。</span><span class="sxs-lookup"><span data-stu-id="c8a57-134">You can derive protocol-specific classes from **WebRequest** and **WebResponse** and then register them for use by the application with the static <xref:System.Net.WebRequest.RegisterPrefix%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="c8a57-135">当需要 Internet 请求的客户端授权时，WebRequest 的 <xref:System.Net.WebRequest.Credentials%2A> 属性提供必需的凭据。</span><span class="sxs-lookup"><span data-stu-id="c8a57-135">When client authorization for Internet requests is required, the <xref:System.Net.WebRequest.Credentials%2A> property of the **WebRequest** supplies the necessary credentials.</span></span> <span data-ttu-id="c8a57-136">这些凭据可以是用于基本 HTTP 或摘要身份验证的简单名称/密码对，也可以是为 NTLM 或 Kerberos 身份验证设置的名称/密码/域。</span><span class="sxs-lookup"><span data-stu-id="c8a57-136">These credentials can be a simple name/password pair for basic HTTP or digest authentication, or a name/password/domain set for NTLM or Kerberos authentication.</span></span> <span data-ttu-id="c8a57-137">凭据集可以存储在 <xref:System.Net.NetworkCredential> 实例中，或者可以在 <xref:System.Net.CredentialCache> 实例中同时存储多个集。</span><span class="sxs-lookup"><span data-stu-id="c8a57-137">One set of credentials can be stored in a <xref:System.Net.NetworkCredential> instance, or multiple sets can be stored simultaneously in a <xref:System.Net.CredentialCache> instance.</span></span> <span data-ttu-id="c8a57-138">CredentialCache 使用请求的 URI 和服务器支持的身份验证方案来确定要发送到服务器的凭据。</span><span class="sxs-lookup"><span data-stu-id="c8a57-138">The **CredentialCache** uses the URI of the request and the authentication scheme that the server supports to determine which credentials to send to the server.</span></span>  
  
## <a name="simple-requests-with-webclient"></a><span data-ttu-id="c8a57-139">WebClient 的简单请求</span><span class="sxs-lookup"><span data-stu-id="c8a57-139">Simple Requests with WebClient</span></span>  

 <span data-ttu-id="c8a57-140">对于需要对 Internet 资源发出简单请求的应用程序，<xref:System.Net.WebClient> 类提供用于将数据上传到 Internet 服务器或从 Internet 服务器下载数据的常用方法。</span><span class="sxs-lookup"><span data-stu-id="c8a57-140">For applications that need to make simple requests for Internet resources, the <xref:System.Net.WebClient> class provides common methods for uploading data to or downloading data from an Internet server.</span></span> <span data-ttu-id="c8a57-141">WebClient 依赖于 WebRequest 类为 Internet 资源提供访问权限；因此，WebClient 类可使用任何已注册的可插入协议  。</span><span class="sxs-lookup"><span data-stu-id="c8a57-141">**WebClient** relies on the **WebRequest** class to provide access to Internet resources; therefore, the **WebClient** class can use any registered pluggable protocol.</span></span>  
  
 <span data-ttu-id="c8a57-142">对于无法使用请求/响应模型的应用程序，或者需要侦听网络以及发送请求的应用程序，System.Net.Sockets 命名空间提供 <xref:System.Net.Sockets.TcpClient>、<xref:System.Net.Sockets.TcpListener> 和 <xref:System.Net.Sockets.UdpClient> 类。</span><span class="sxs-lookup"><span data-stu-id="c8a57-142">For applications that cannot use the request/response model, or for applications that need to listen on the network as well as send requests, the **System.Net.Sockets** namespace provides the <xref:System.Net.Sockets.TcpClient>, <xref:System.Net.Sockets.TcpListener>, and <xref:System.Net.Sockets.UdpClient> classes.</span></span> <span data-ttu-id="c8a57-143">这些类处理使用不同传输协议建立连接的细节，并将应用程序的网络连接公开为流。</span><span class="sxs-lookup"><span data-stu-id="c8a57-143">These classes handle the details of making connections using different transport protocols and expose the network connection to the application as a stream.</span></span>  
  
 <span data-ttu-id="c8a57-144">熟悉 Windows Sockets 接口的开发人员或需要通过套接字级编程提供的控件的开发人员将发现 System.Net.Sockets 类能够满足他们的需求。</span><span class="sxs-lookup"><span data-stu-id="c8a57-144">Developers familiar with the Windows Sockets interface or those who need the control provided by programming at the socket level will find that the **System.Net.Sockets** classes meet their needs.</span></span> <span data-ttu-id="c8a57-145">System.Net.Sockets 类是从托管到 System.Net 类中的本机代码的转换点 。</span><span class="sxs-lookup"><span data-stu-id="c8a57-145">The **System.Net.Sockets** classes are a transition point from managed to native code within the **System.Net** classes.</span></span> <span data-ttu-id="c8a57-146">大多数情况下，System.Net.Sockets 类将数据封送到 Windows 32 位对应项，并处理任何必要的安全检查。</span><span class="sxs-lookup"><span data-stu-id="c8a57-146">In most cases, **System.Net.Sockets** classes marshal data into their Windows 32-bit counterparts, as well as handling any necessary security checks.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c8a57-147">请参阅</span><span class="sxs-lookup"><span data-stu-id="c8a57-147">See also</span></span>

- [<span data-ttu-id="c8a57-148">对可插入协议进行编程</span><span class="sxs-lookup"><span data-stu-id="c8a57-148">Programming Pluggable Protocols</span></span>](programming-pluggable-protocols.md)
- [<span data-ttu-id="c8a57-149">.NET Framework 中的网络编程</span><span class="sxs-lookup"><span data-stu-id="c8a57-149">Network Programming in the .NET Framework</span></span>](index.md)
- [<span data-ttu-id="c8a57-150">网络编程示例</span><span class="sxs-lookup"><span data-stu-id="c8a57-150">Network Programming Samples</span></span>](network-programming-samples.md)
