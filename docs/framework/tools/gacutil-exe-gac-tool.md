---
title: Gacutil.exe（全局程序集缓存工具）
description: 获取有关 Gacutil.exe（全局程序集缓存工具）的详细信息。 可使用此工具查看和操作全局程序集缓存和下载缓存。
ms.date: 03/30/2017
helpviewer_keywords:
- assemblies [.NET Framework], global assembly cache
- global assembly cache, viewing contents
- viewing assemblies in global assembly cache
- global assembly cache, manipulating contents
- GAC (global assembly cache), Gacutil.exe
- Gacutil.exe
- GAC (global assembly cache), viewing contents
- installing assemblies into global assembly cache
- removing assemblies from global assembly cache
- list of assemblies in global assembly cache
- cache [.NET Framework], global assembly cache
- GAC (global assembly cache), manipulating contents
- global assembly cache, Gacutil.exe
- Global Assembly Cache tool
ms.assetid: 4c7be9c8-72ae-481f-a01c-1a4716806e99
ms.openlocfilehash: 1fe79a09aa99c9d91d8223e7642408a56da20dfe
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/24/2020
ms.locfileid: "87166938"
---
# <a name="gacutilexe-global-assembly-cache-tool"></a><span data-ttu-id="16bea-104">Gacutil.exe（全局程序集缓存工具）</span><span class="sxs-lookup"><span data-stu-id="16bea-104">Gacutil.exe (Global Assembly Cache Tool)</span></span>

<span data-ttu-id="16bea-105">全局程序集缓存工具使你可以查看和操作全局程序集缓存和下载缓存的内容。</span><span class="sxs-lookup"><span data-stu-id="16bea-105">The Global Assembly Cache tool allows you to view and manipulate the contents of the global assembly cache and download cache.</span></span>

<span data-ttu-id="16bea-106">此工具会自动随 Visual Studio 一起安装。</span><span class="sxs-lookup"><span data-stu-id="16bea-106">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="16bea-107">若要运行此工具，请使用 Visual Studio 开发人员命令提示（或 Windows 7 中的 Visual Studio 命令提示）。</span><span class="sxs-lookup"><span data-stu-id="16bea-107">To run the tool, use the Developer Command Prompt for Visual Studio (or the Visual Studio Command Prompt in Windows 7).</span></span> <span data-ttu-id="16bea-108">有关详细信息，请参阅[命令提示](developer-command-prompt-for-vs.md)。</span><span class="sxs-lookup"><span data-stu-id="16bea-108">For more information, see [Command Prompts](developer-command-prompt-for-vs.md).</span></span>

<span data-ttu-id="16bea-109">在命令提示符处，键入以下内容：</span><span class="sxs-lookup"><span data-stu-id="16bea-109">At the command prompt, type the following:</span></span>

## <a name="syntax"></a><span data-ttu-id="16bea-110">语法</span><span class="sxs-lookup"><span data-stu-id="16bea-110">Syntax</span></span>

```console
gacutil [options] [assemblyName | assemblyPath | assemblyListFile]
```

## <a name="parameters"></a><span data-ttu-id="16bea-111">参数</span><span class="sxs-lookup"><span data-stu-id="16bea-111">Parameters</span></span>

|<span data-ttu-id="16bea-112">参数</span><span class="sxs-lookup"><span data-stu-id="16bea-112">Argument</span></span>|<span data-ttu-id="16bea-113">描述</span><span class="sxs-lookup"><span data-stu-id="16bea-113">Description</span></span>|
|--------------|-----------------|
|<span data-ttu-id="16bea-114">*assemblyName*</span><span class="sxs-lookup"><span data-stu-id="16bea-114">*assemblyName*</span></span>|<span data-ttu-id="16bea-115">程序集的名称。</span><span class="sxs-lookup"><span data-stu-id="16bea-115">The name of an assembly.</span></span> <span data-ttu-id="16bea-116">可以提供部分指定的程序集名称（如 `myAssembly`）或完全指定的程序集名称（如 `myAssembly, Version=2.0.0.0, Culture=neutral, PublicKeyToken=0038abc9deabfle5`）。</span><span class="sxs-lookup"><span data-stu-id="16bea-116">You can supply either a partially specified assembly name such as `myAssembly` or a fully specified assembly name such as `myAssembly, Version=2.0.0.0, Culture=neutral, PublicKeyToken=0038abc9deabfle5`.</span></span>|
|<span data-ttu-id="16bea-117">assemblyPath</span><span class="sxs-lookup"><span data-stu-id="16bea-117">*assemblyPath*</span></span>|<span data-ttu-id="16bea-118">包含程序集清单的文件的名称。</span><span class="sxs-lookup"><span data-stu-id="16bea-118">The name of a file that contains an assembly manifest.</span></span>|
|<span data-ttu-id="16bea-119">assemblyListFile</span><span class="sxs-lookup"><span data-stu-id="16bea-119">*assemblyListFile*</span></span>|<span data-ttu-id="16bea-120">列出要安装或卸载的程序集的 ANSI 文本文件的路径。</span><span class="sxs-lookup"><span data-stu-id="16bea-120">The path to an ANSI text file that lists assemblies to install or uninstall.</span></span> <span data-ttu-id="16bea-121">若要使用文本文件安装程序集，请在文件中使用单独的行分别指定每个程序集的路径。</span><span class="sxs-lookup"><span data-stu-id="16bea-121">To use a text file to install assemblies, specify the path to each assembly on a separate line in the file.</span></span> <span data-ttu-id="16bea-122">该工具可解释相对于 assemblyListFile 位置的相对路径。</span><span class="sxs-lookup"><span data-stu-id="16bea-122">The tool interprets relative paths, relative to the location of the *assemblyListFile*.</span></span> <span data-ttu-id="16bea-123">若要使用文本文件卸载程序集，请在文件中使用单独的行分别为每个程序集指定完全限定的程序集名称。</span><span class="sxs-lookup"><span data-stu-id="16bea-123">To use a text file to uninstall assemblies, specify the fully qualified assembly name for each assembly on a separate line in the file.</span></span> <span data-ttu-id="16bea-124">请参见本主题后面的 assemblyListFile 内容示例。</span><span class="sxs-lookup"><span data-stu-id="16bea-124">See the *assemblyListFile* contents examples later in this topic.</span></span>|

|<span data-ttu-id="16bea-125">选项</span><span class="sxs-lookup"><span data-stu-id="16bea-125">Option</span></span>|<span data-ttu-id="16bea-126">描述</span><span class="sxs-lookup"><span data-stu-id="16bea-126">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="16bea-127">/cdl</span><span class="sxs-lookup"><span data-stu-id="16bea-127">**/cdl**</span></span>|<span data-ttu-id="16bea-128">删除下载缓存的内容。</span><span class="sxs-lookup"><span data-stu-id="16bea-128">Deletes the contents of the download cache.</span></span>|
|<span data-ttu-id="16bea-129">/f</span><span class="sxs-lookup"><span data-stu-id="16bea-129">**/f**</span></span>|<span data-ttu-id="16bea-130">使用 /i 或 /il 选项来指定此选项将强制重新安装程序集 。</span><span class="sxs-lookup"><span data-stu-id="16bea-130">Specify this option with the **/i** or **/il** options to force an assembly to reinstall.</span></span> <span data-ttu-id="16bea-131">如果全局程序集缓存中已经存在同名的程序集，全局程序集缓存工具将覆盖它。</span><span class="sxs-lookup"><span data-stu-id="16bea-131">If an assembly with the same name already exists in the global assembly cache, the tool overwrites it.</span></span>|
|<span data-ttu-id="16bea-132">**/h**[**elp**]</span><span class="sxs-lookup"><span data-stu-id="16bea-132">**/h**[**elp**]</span></span>|<span data-ttu-id="16bea-133">显示该工具的命令语法和选项。</span><span class="sxs-lookup"><span data-stu-id="16bea-133">Displays command syntax and options for the tool.</span></span>|
|<span data-ttu-id="16bea-134">/i assemblyPath</span><span class="sxs-lookup"><span data-stu-id="16bea-134">**/i** *assemblyPath*</span></span>|<span data-ttu-id="16bea-135">将程序集安装到全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="16bea-135">Installs an assembly into the global assembly cache.</span></span>|
|<span data-ttu-id="16bea-136">/if  assemblyPath</span><span class="sxs-lookup"><span data-stu-id="16bea-136">**/if**  *assemblyPath*</span></span>|<span data-ttu-id="16bea-137">将程序集安装到全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="16bea-137">Installs an assembly into the global assembly cache.</span></span> <span data-ttu-id="16bea-138">如果全局程序集缓存中已经存在同名的程序集，全局程序集缓存工具将覆盖它。</span><span class="sxs-lookup"><span data-stu-id="16bea-138">If an assembly with the same name already exists in the global assembly cache, the tool overwrites it.</span></span><br /><br /> <span data-ttu-id="16bea-139">指定此选项相当于同时指定 /i 和 /f 选项 。</span><span class="sxs-lookup"><span data-stu-id="16bea-139">Specifying this option is equivalent to specifying the **/i** and **/f** options together.</span></span>|
|<span data-ttu-id="16bea-140">/il assemblyListFile</span><span class="sxs-lookup"><span data-stu-id="16bea-140">**/il** *assemblyListFile*</span></span>|<span data-ttu-id="16bea-141">将 assemblyListFile 中指定的一个或多个程序集安装到全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="16bea-141">Installs one or more assemblies specified in *assemblyListFile* into the global assembly cache.</span></span>|
|<span data-ttu-id="16bea-142">/ir  assemblyPath</span><span class="sxs-lookup"><span data-stu-id="16bea-142">**/ir**  *assemblyPath*</span></span><br /><br /> <span data-ttu-id="16bea-143">scheme</span><span class="sxs-lookup"><span data-stu-id="16bea-143">*scheme*</span></span><br /><br /> <span data-ttu-id="16bea-144">*id*</span><span class="sxs-lookup"><span data-stu-id="16bea-144">*id*</span></span><br /><br /> <span data-ttu-id="16bea-145">description</span><span class="sxs-lookup"><span data-stu-id="16bea-145">*description*</span></span>|<span data-ttu-id="16bea-146">将程序集安装到全局程序集缓存中，并添加引用以对程序集进行计数。</span><span class="sxs-lookup"><span data-stu-id="16bea-146">Installs an assembly into the global assembly cache and adds a reference to count the assembly.</span></span> <span data-ttu-id="16bea-147">必须使用此选项指定 assemblyPath、scheme、id 和 description 参数   。</span><span class="sxs-lookup"><span data-stu-id="16bea-147">You must specify the *assemblyPath*, *scheme*, *id*,and *description* parameters with this option.</span></span> <span data-ttu-id="16bea-148">有关可为这些参数指定的有效值的说明，请从参阅 /r 选项。</span><span class="sxs-lookup"><span data-stu-id="16bea-148">For a description of the valid values you can specify for these parameters, see the **/r** option.</span></span><br /><br /> <span data-ttu-id="16bea-149">指定此选项相当于同时指定 /i 和 /r 选项 。</span><span class="sxs-lookup"><span data-stu-id="16bea-149">Specifying this option is equivalent to specifying the **/i** and **/r** options together.</span></span>|
|<span data-ttu-id="16bea-150">/l [assemblyName]</span><span class="sxs-lookup"><span data-stu-id="16bea-150">**/l** [*assemblyName*]</span></span>|<span data-ttu-id="16bea-151">列出全局程序集缓存的内容。</span><span class="sxs-lookup"><span data-stu-id="16bea-151">Lists the contents of the global assembly cache.</span></span> <span data-ttu-id="16bea-152">如果指定了 assemblyName 参数，则全局程序集缓存工具只列出与该名称匹配的程序集。</span><span class="sxs-lookup"><span data-stu-id="16bea-152">If you specify the *assemblyName* parameter, the tool lists only the assemblies matching that name.</span></span>|
|<span data-ttu-id="16bea-153">/ldl</span><span class="sxs-lookup"><span data-stu-id="16bea-153">**/ldl**</span></span>|<span data-ttu-id="16bea-154">列出下载的文件缓存的内容。</span><span class="sxs-lookup"><span data-stu-id="16bea-154">Lists the contents of the downloaded files cache.</span></span>|
|<span data-ttu-id="16bea-155">/lr [assemblyName]</span><span class="sxs-lookup"><span data-stu-id="16bea-155">**/lr** [*assemblyName*]</span></span>|<span data-ttu-id="16bea-156">列出所有程序集及其对应的引用计数。</span><span class="sxs-lookup"><span data-stu-id="16bea-156">Lists all assemblies and their corresponding reference counts.</span></span> <span data-ttu-id="16bea-157">如果指定了 assemblyName 参数，则全局程序集缓存工具只列出与该名称匹配的程序集及其对应的引用计数。</span><span class="sxs-lookup"><span data-stu-id="16bea-157">If you specify the *assemblyName* parameter, the tool lists only the assemblies matching that name and their corresponding reference counts.</span></span>|
|<span data-ttu-id="16bea-158">**/nologo**</span><span class="sxs-lookup"><span data-stu-id="16bea-158">**/nologo**</span></span>|<span data-ttu-id="16bea-159">取消显示 Microsoft 启动版权标志。</span><span class="sxs-lookup"><span data-stu-id="16bea-159">Suppresses the Microsoft startup banner display.</span></span>|
|<span data-ttu-id="16bea-160">/r [assemblyName &#124; assemblyPath]</span><span class="sxs-lookup"><span data-stu-id="16bea-160">**/r** [*assemblyName &#124; assemblyPath*]</span></span><br /><br /> <span data-ttu-id="16bea-161">scheme</span><span class="sxs-lookup"><span data-stu-id="16bea-161">*scheme*</span></span><br /><br /> <span data-ttu-id="16bea-162">*id*</span><span class="sxs-lookup"><span data-stu-id="16bea-162">*id*</span></span><br /><br /> <span data-ttu-id="16bea-163">description</span><span class="sxs-lookup"><span data-stu-id="16bea-163">*description*</span></span>|<span data-ttu-id="16bea-164">指定对要安装或卸载的一个或多个程序集的跟踪引用。</span><span class="sxs-lookup"><span data-stu-id="16bea-164">Specifies a traced reference to an assembly or assemblies to install or uninstall.</span></span> <span data-ttu-id="16bea-165">使用 /i、/il、/u 或 /ul 选项来指定此选项   。</span><span class="sxs-lookup"><span data-stu-id="16bea-165">Specify this option with the **/i**, **/il**, **/u**, or **/ul** options.</span></span><br /><br /> <span data-ttu-id="16bea-166">若要安装程序集，请使用此选项来指定 assemblyPath、scheme、id 和 description 参数   。</span><span class="sxs-lookup"><span data-stu-id="16bea-166">To install an assembly, specify the *assemblyPath*, *scheme*, *id*,and *description* parameters with this option.</span></span> <span data-ttu-id="16bea-167">若要卸载程序集，请指定 assemblyPath、scheme、id 和 description 参数   。</span><span class="sxs-lookup"><span data-stu-id="16bea-167">To uninstall an assembly, specify the *assemblyName*, *scheme*, *id*,and *description* parameters.</span></span><br /><br /> <span data-ttu-id="16bea-168">若要移除对程序集的引用，指定的 scheme、id 和 description 参数必须与安装程序集时使用 /i 和 /r（或者 /ir）选项指定的参数相同    。</span><span class="sxs-lookup"><span data-stu-id="16bea-168">To remove a reference to an assembly, you must specify the same *scheme*, *id*, and *description* parameters that were specified with the **/i** and **/r** (or **/ir**) options when the assembly was installed.</span></span> <span data-ttu-id="16bea-169">如果卸载某个程序集，则在下列情况下，全局程序集缓存工具还会从全局程序集缓存中移除该程序集：该程序集是最后一个要移除的引用，并且 Windows Installer 没有对该程序集的未处理引用。</span><span class="sxs-lookup"><span data-stu-id="16bea-169">If you are uninstalling an assembly, the tool also removes the assembly from the global assembly cache if it is the last reference to remove and if Windows Installer has no outstanding references to the assembly.</span></span><br /><br /> <span data-ttu-id="16bea-170">scheme 参数指定安装方案的类型。</span><span class="sxs-lookup"><span data-stu-id="16bea-170">The *scheme* parameter specifies the type of installation scheme.</span></span> <span data-ttu-id="16bea-171">可以指定以下值之一：</span><span class="sxs-lookup"><span data-stu-id="16bea-171">You can specify one of the following values:</span></span><br /><br /> <span data-ttu-id="16bea-172">- UNINSTALL_KEY:如果安装程序将应用程序添加到 Microsoft Windows 中的“添加/删除程序”，则指定此值。</span><span class="sxs-lookup"><span data-stu-id="16bea-172">- UNINSTALL_KEY: Specify this value if the installer adds the application to Add/Remove Programs in Microsoft Windows.</span></span> <span data-ttu-id="16bea-173">应用程序通过将注册表项添加到 HKLM\Software\Microsoft\Windows\CurrentVersion 来将自己添加到“添加/删除程序”。</span><span class="sxs-lookup"><span data-stu-id="16bea-173">Applications add themselves to Add/Remove Programs by adding a registry key to HKLM\Software\Microsoft\Windows\CurrentVersion.</span></span><br /><span data-ttu-id="16bea-174">- FILEPATH:如果安装程序没有将应用程序添加到“添加/删除程序”中，则指定此值。</span><span class="sxs-lookup"><span data-stu-id="16bea-174">- FILEPATH: Specify this value if the installer does not add the application to Add/Remove Programs.</span></span><br /><span data-ttu-id="16bea-175">- OPAQUE:如果提供的注册表项或文件路径不适于你的安装方案，则指定此值。</span><span class="sxs-lookup"><span data-stu-id="16bea-175">- OPAQUE: Specify this value if supplying a registry key or file path does not apply to your installation scenario.</span></span> <span data-ttu-id="16bea-176">通过此值可以为 id 参数指定自定义信息。</span><span class="sxs-lookup"><span data-stu-id="16bea-176">This value allows you to specify custom information for the *id* parameter.</span></span><br /><br /> <span data-ttu-id="16bea-177">为 id 参数指定的值取决于为 scheme 参数指定的值 ：</span><span class="sxs-lookup"><span data-stu-id="16bea-177">The value to specify for the *id* parameter depends on the value specified for the *scheme* parameter:</span></span><br /><br /> <span data-ttu-id="16bea-178">- 如果为 scheme 参数指定 UNINSTALL_KEY，请在 HKLM\Software\Microsoft\Windows\CurrentVersion 注册表项中指定应用程序集的名称。</span><span class="sxs-lookup"><span data-stu-id="16bea-178">- If you specify UNINSTALL_KEY for the *scheme* parameter, specify the name of the application set in the HKLM\Software\Microsoft\Windows\CurrentVersion registry key.</span></span> <span data-ttu-id="16bea-179">例如，如果注册表项是 HKLM\Software\Microsoft\Windows\CurrentVersion\MyApp，请为 id 参数指定 MyApp。</span><span class="sxs-lookup"><span data-stu-id="16bea-179">For example, if the registry key is HKLM\Software\Microsoft\Windows\CurrentVersion\MyApp, specify MyApp for the *id* parameter.</span></span><br /><span data-ttu-id="16bea-180">- 如果为 scheme 参数指定 FILEPATH，请指定安装程序集的可执行文件的完整路径作为 id 参数 。</span><span class="sxs-lookup"><span data-stu-id="16bea-180">- If you specify FILEPATH for the *scheme* parameter, specify the full path to the executable file that installs the assembly as the *id* parameter.</span></span><br /><span data-ttu-id="16bea-181">- 如果为 scheme 参数指定 OPAQUE，则可以将任何一段数据作为 id 参数提供 。</span><span class="sxs-lookup"><span data-stu-id="16bea-181">- If you specify OPAQUE for the *scheme* parameter, you can supply any piece of data as the *id* parameter.</span></span> <span data-ttu-id="16bea-182">所指定的数据必须用引号 ("") 括起来。</span><span class="sxs-lookup"><span data-stu-id="16bea-182">The data you specify must be enclosed in quotation marks ("").</span></span><br /><br /> <span data-ttu-id="16bea-183">description 参数可用于指定有关要安装的应用程序的描述性文本。</span><span class="sxs-lookup"><span data-stu-id="16bea-183">The *description* parameter allows you to specify descriptive text about the application to install.</span></span> <span data-ttu-id="16bea-184">此信息在枚举引用时显示。</span><span class="sxs-lookup"><span data-stu-id="16bea-184">This information is displayed when references are enumerated.</span></span>|
|<span data-ttu-id="16bea-185">**/Silent**</span><span class="sxs-lookup"><span data-stu-id="16bea-185">**/silent**</span></span>|<span data-ttu-id="16bea-186">取消所有输出的显示。</span><span class="sxs-lookup"><span data-stu-id="16bea-186">Suppresses the display of all output.</span></span>|
|<span data-ttu-id="16bea-187">/u  assemblyName</span><span class="sxs-lookup"><span data-stu-id="16bea-187">**/u**  *assemblyName*</span></span>|<span data-ttu-id="16bea-188">将某个程序集从全局程序集缓存卸载。</span><span class="sxs-lookup"><span data-stu-id="16bea-188">Uninstalls an assembly from the global assembly cache.</span></span>|
|<span data-ttu-id="16bea-189">/uf  assemblyName</span><span class="sxs-lookup"><span data-stu-id="16bea-189">**/uf**  *assemblyName*</span></span>|<span data-ttu-id="16bea-190">通过移除对程序集的所有引用来强制卸载指定的程序集。</span><span class="sxs-lookup"><span data-stu-id="16bea-190">Forces a specified assembly to uninstall by removing all references to the assembly.</span></span><br /><br /> <span data-ttu-id="16bea-191">指定此选项相当于同时指定 /u 和 /f 选项 。</span><span class="sxs-lookup"><span data-stu-id="16bea-191">Specifying this option is equivalent to specifying the **/u** and **/f** options together.</span></span> <span data-ttu-id="16bea-192">**注意：** 不能使用此选项移除使用 Microsoft Windows Installer 安装的程序集。</span><span class="sxs-lookup"><span data-stu-id="16bea-192">**Note:**  You cannot use this option to remove an assembly that was installed using Microsoft Windows Installer.</span></span> <span data-ttu-id="16bea-193">如果尝试此操作，则全局程序集缓存工具会显示错误消息。</span><span class="sxs-lookup"><span data-stu-id="16bea-193">If you attempt this operation, the tool displays an error message.</span></span>|
|<span data-ttu-id="16bea-194">/ul assemblyListFile</span><span class="sxs-lookup"><span data-stu-id="16bea-194">**/ul** *assemblyListFile*</span></span>|<span data-ttu-id="16bea-195">从全局程序集缓存中卸载 assemblyListFile 中指定的一个或多个程序集。</span><span class="sxs-lookup"><span data-stu-id="16bea-195">Uninstalls one or more assemblies specified in *assemblyListFile* from the global assembly cache.</span></span>|
|<span data-ttu-id="16bea-196">/u[ngen] assemblyName </span><span class="sxs-lookup"><span data-stu-id="16bea-196">**/u**[**ngen**] *assemblyName*</span></span>|<span data-ttu-id="16bea-197">从全局程序集缓存中卸载指定的程序集。</span><span class="sxs-lookup"><span data-stu-id="16bea-197">Uninstalls a specified assembly from the global assembly cache.</span></span> <span data-ttu-id="16bea-198">如果指定的程序集具有现有引用计数，则全局程序集缓存工具会显示引用计数，而且不会从全局程序集缓存中移除该程序集。</span><span class="sxs-lookup"><span data-stu-id="16bea-198">If the specified assembly has existing reference counts, the tool displays the reference counts and does not remove the assembly from the global assembly cache.</span></span> <span data-ttu-id="16bea-199">**注意：** 在 .NET Framework 2.0 版中，不支持 `/ungen`。</span><span class="sxs-lookup"><span data-stu-id="16bea-199">**Note:**  In the .NET Framework version 2.0, `/ungen` is not supported.</span></span> <span data-ttu-id="16bea-200">请改为使用 [Ngen.exe（本机映像生成器）](ngen-exe-native-image-generator.md)的 `uninstall` 命令。</span><span class="sxs-lookup"><span data-stu-id="16bea-200">Instead, use the `uninstall` command of the [Ngen.exe (Native Image Generator)](ngen-exe-native-image-generator.md).</span></span> <br /><br /> <span data-ttu-id="16bea-201">在 .NET Framework 1.0 和 1.1 版中，指定 /ungen 会导致 Gacutil.exe 从本机映像缓存中移除该程序集。</span><span class="sxs-lookup"><span data-stu-id="16bea-201">In the .NET Framework versions 1.0 and 1.1, specifying **/ungen** causes Gacutil.exe to remove the assembly from the native image cache.</span></span> <span data-ttu-id="16bea-202">此缓存存储了使用 [Ngen.exe（本机映像生成器）](ngen-exe-native-image-generator.md) 创建的程序集的本机印象。</span><span class="sxs-lookup"><span data-stu-id="16bea-202">This cache stores the native images for assemblies that have been created using the [Ngen.exe (Native Image Generator)](ngen-exe-native-image-generator.md).</span></span>|
|<span data-ttu-id="16bea-203">/ur  assemblyName</span><span class="sxs-lookup"><span data-stu-id="16bea-203">**/ur**  *assemblyName*</span></span><br /><br /> <span data-ttu-id="16bea-204">scheme</span><span class="sxs-lookup"><span data-stu-id="16bea-204">*scheme*</span></span><br /><br /> <span data-ttu-id="16bea-205">*id*</span><span class="sxs-lookup"><span data-stu-id="16bea-205">*id*</span></span><br /><br /> <span data-ttu-id="16bea-206">description</span><span class="sxs-lookup"><span data-stu-id="16bea-206">*description*</span></span>|<span data-ttu-id="16bea-207">从全局程序集缓存中卸载对指定程序集的引用。</span><span class="sxs-lookup"><span data-stu-id="16bea-207">Uninstalls a reference to a specified assembly from the global assembly cache.</span></span> <span data-ttu-id="16bea-208">若要移除对程序集的引用，指定的 scheme、id 和 description 参数必须与安装程序集时使用 /i 和 /r（或者 /ir）选项指定的参数相同    。</span><span class="sxs-lookup"><span data-stu-id="16bea-208">To remove a reference to an assembly, you must specify the same *scheme*, *id*, and *description* parameters that were specified with the **/i** and **/r** (or **/ir)** options when the assembly was installed.</span></span> <span data-ttu-id="16bea-209">有关可为这些参数指定的有效值的说明，请从参阅 /r 选项。</span><span class="sxs-lookup"><span data-stu-id="16bea-209">For a description of the valid values you can specify for these parameters, see the **/r** option.</span></span><br /><br /> <span data-ttu-id="16bea-210">指定此选项相当于同时指定 /u 和 /r 选项 。</span><span class="sxs-lookup"><span data-stu-id="16bea-210">Specifying this option is equivalent to specifying the **/u** and **/r** options together.</span></span>|
|<span data-ttu-id="16bea-211">**/?**</span><span class="sxs-lookup"><span data-stu-id="16bea-211">**/?**</span></span>|<span data-ttu-id="16bea-212">显示该工具的命令语法和选项。</span><span class="sxs-lookup"><span data-stu-id="16bea-212">Displays command syntax and options for the tool.</span></span>|

## <a name="remarks"></a><span data-ttu-id="16bea-213">备注</span><span class="sxs-lookup"><span data-stu-id="16bea-213">Remarks</span></span>

> [!NOTE]
> <span data-ttu-id="16bea-214">必须具有管理员特权才能使用 Gacutil.exe。</span><span class="sxs-lookup"><span data-stu-id="16bea-214">You must have administrator privileges to use Gacutil.exe.</span></span>

<span data-ttu-id="16bea-215">具体说来，Gacutil.exe 使你可以将程序集安装到缓存中、从缓存中移除程序集以及列出缓存的内容。</span><span class="sxs-lookup"><span data-stu-id="16bea-215">Specifically, Gacutil.exe allows you to install assemblies into the cache, remove them from the cache, and list the contents of the cache.</span></span>

<span data-ttu-id="16bea-216">Gacutil.exe 提供了支持引用计数的选项，类似于 Windows Installer 所支持的引用计数方案。</span><span class="sxs-lookup"><span data-stu-id="16bea-216">Gacutil.exe provides options that support reference counting similar to the reference counting scheme supported by Windows Installer.</span></span> <span data-ttu-id="16bea-217">你可以使用 Gacutil.exe 安装两个将安装同一程序集的应用程序；全局程序集缓存工具将跟踪对该程序集的引用的数量。</span><span class="sxs-lookup"><span data-stu-id="16bea-217">You can use Gacutil.exe to install two applications that install the same assembly; the tool keeps track of the number of references to the assembly.</span></span> <span data-ttu-id="16bea-218">结果是，该程序集将一直保留在计算机上，直到卸载这两个应用程序为止。</span><span class="sxs-lookup"><span data-stu-id="16bea-218">As a result, the assembly will remain on the computer until both applications are uninstalled.</span></span> <span data-ttu-id="16bea-219">如果将 Gacutil.exe 用于实际产品安装，请使用支持引用计数的选项。</span><span class="sxs-lookup"><span data-stu-id="16bea-219">If you are using Gacutil.exe for actual product installations, use the options that support reference counting.</span></span> <span data-ttu-id="16bea-220">同时使用 /i 和 /r 选项可以安装程序集并添加引用以对其进行计数 。</span><span class="sxs-lookup"><span data-stu-id="16bea-220">Use the **/i** and **/r** options together to install an assembly and add a reference to count it.</span></span> <span data-ttu-id="16bea-221">同时使用 /u 和 /r 选项可以移除对程序集的引用计数 。</span><span class="sxs-lookup"><span data-stu-id="16bea-221">Use the **/u** and **/r** options together to remove a reference count for an assembly.</span></span> <span data-ttu-id="16bea-222">注意，单独使用 /i 和 /u 选项不支持引用计数 。</span><span class="sxs-lookup"><span data-stu-id="16bea-222">Be aware that using the **/i** and **/u** options alone does not support reference counting.</span></span> <span data-ttu-id="16bea-223">这些选项在产品开发期间适用，但不适用于实际的产品安装。</span><span class="sxs-lookup"><span data-stu-id="16bea-223">These options are appropriate for use during product development but not for actual product installations.</span></span>

<span data-ttu-id="16bea-224">使用 /il 或 /ul 选项可以安装或卸载存储在 ANSI 文本文件中的程序集 。</span><span class="sxs-lookup"><span data-stu-id="16bea-224">Use the **/il** or **/ul** options to install or uninstall a list of assemblies stored in an ANSI text file.</span></span> <span data-ttu-id="16bea-225">该文本文件中的内容必须具有正确的格式。</span><span class="sxs-lookup"><span data-stu-id="16bea-225">The contents of the text file must be formatted correctly.</span></span> <span data-ttu-id="16bea-226">若要使用文本文件安装程序集，请在文件中使用单独的行分别指定每个程序集的路径。</span><span class="sxs-lookup"><span data-stu-id="16bea-226">To use a text file to install assemblies, specify the path to each assembly on a separate line in the file.</span></span> <span data-ttu-id="16bea-227">下面的示例说明了包含要安装的程序集的文件的内容。</span><span class="sxs-lookup"><span data-stu-id="16bea-227">The following example demonstrates the contents of a file containing assemblies to install.</span></span>

```text
myAssembly1.dll
myAssembly2.dll
myAssembly3.dll
```

<span data-ttu-id="16bea-228">若要使用文本文件卸载程序集，请在文件中使用单独的行分别为每个程序集指定完全限定的程序集名称。</span><span class="sxs-lookup"><span data-stu-id="16bea-228">To use a text file to uninstall assemblies, specify the fully qualified assembly name for each assembly on a separate line in the file.</span></span> <span data-ttu-id="16bea-229">下面的示例说明了包含要卸载的程序集的文件的内容。</span><span class="sxs-lookup"><span data-stu-id="16bea-229">The following example demonstrates the contents of a file containing assemblies to uninstall.</span></span>

```text
myAssembly1,Version=1.1.0.0,Culture=en,PublicKeyToken=874e23ab874e23ab
myAssembly2,Version=1.1.0.0,Culture=en,PublicKeyToken=874e23ab874e23ab
myAssembly3,Version=1.1.0.0,Culture=en,PublicKeyToken=874e23ab874e23ab
```

> [!NOTE]
> <span data-ttu-id="16bea-230">尝试安装文件名长度超过 79 到 91 个字符（不包括文件扩展名）的程序集可能会导致以下错误：</span><span class="sxs-lookup"><span data-stu-id="16bea-230">Attempting to install an assembly with a filename longer than between 79 and 91 characters (excluding the file extension) can result in the following error:</span></span>
>
> ```output
> Failure adding assembly to the cache:   The file name is too long.
> ```
>
> <span data-ttu-id="16bea-231">这是因为 Gacutil.exe 在内部构造了一个最多 MAX_PATH 个字符的路径，该路径由以下元素组成：</span><span class="sxs-lookup"><span data-stu-id="16bea-231">This is because internally Gacutil.exe constructs a path of up to MAX_PATH characters that consists of the following elements:</span></span>
>
> - <span data-ttu-id="16bea-232">GAC Root - 34 个字符（即 `C:\Windows\Microsoft.NET\assembly\`）</span><span class="sxs-lookup"><span data-stu-id="16bea-232">GAC Root - 34 chars (ie. `C:\Windows\Microsoft.NET\assembly\`)</span></span>
> - <span data-ttu-id="16bea-233">Architecture - 7 或 9 个字符（即 `GAC_32\`、`GAC_64\`、`GAC_MSIL`）</span><span class="sxs-lookup"><span data-stu-id="16bea-233">Architecture - 7 or 9 chars (ie. `GAC_32\`, `GAC_64\`, `GAC_MSIL`)</span></span>
> - <span data-ttu-id="16bea-234">AssemblyName - 最多 91 个字符，具体取决于其他元素的大小（例如</span><span class="sxs-lookup"><span data-stu-id="16bea-234">AssemblyName - Up to 91 chars, depending on the size of the other elements (eg.</span></span> <span data-ttu-id="16bea-235">`System.Xml.Linq\`)</span><span class="sxs-lookup"><span data-stu-id="16bea-235">`System.Xml.Linq\`)</span></span>
> - <span data-ttu-id="16bea-236">AssemblyInfo - 31 到 48 个字符或由以下内容组成的更多字符：</span><span class="sxs-lookup"><span data-stu-id="16bea-236">AssemblyInfo - 31 to 48 chars or more consisting of:</span></span>
>   - <span data-ttu-id="16bea-237">Framework - 5 个字符（例如</span><span class="sxs-lookup"><span data-stu-id="16bea-237">Framework - 5 chars (eg.</span></span> <span data-ttu-id="16bea-238">`v4.0_`)</span><span class="sxs-lookup"><span data-stu-id="16bea-238">`v4.0_`)</span></span>
>   - <span data-ttu-id="16bea-239">AssemblyVersion - 8 到 24 个字符（例如</span><span class="sxs-lookup"><span data-stu-id="16bea-239">AssemblyVersion - 8 to 24 chars (eg.</span></span> <span data-ttu-id="16bea-240">`9.0.1000.0_`)</span><span class="sxs-lookup"><span data-stu-id="16bea-240">`9.0.1000.0_`)</span></span>
>   - <span data-ttu-id="16bea-241">AssemblyLanguage - 1 到 8 个字符（例如</span><span class="sxs-lookup"><span data-stu-id="16bea-241">AssemblyLanguage - 1 to 8 chars (eg.</span></span> <span data-ttu-id="16bea-242">`de_`, `sr-Cyrl_`)</span><span class="sxs-lookup"><span data-stu-id="16bea-242">`de_`, `sr-Cyrl_`)</span></span>
>   - <span data-ttu-id="16bea-243">PublicKey - 17 个字符（例如</span><span class="sxs-lookup"><span data-stu-id="16bea-243">PublicKey - 17 chars (eg.</span></span> <span data-ttu-id="16bea-244">`31bf3856ad364e35\`)</span><span class="sxs-lookup"><span data-stu-id="16bea-244">`31bf3856ad364e35\`)</span></span>
> - <span data-ttu-id="16bea-245">DllFileName - 最多 91 + 4 个字符（即 `<AssemblyName>.dll`）</span><span class="sxs-lookup"><span data-stu-id="16bea-245">DllFileName - Up to 91 + 4 chars (ie. `<AssemblyName>.dll`)</span></span>

## <a name="examples"></a><span data-ttu-id="16bea-246">示例</span><span class="sxs-lookup"><span data-stu-id="16bea-246">Examples</span></span>

<span data-ttu-id="16bea-247">以下命令将程序集 `mydll.dll` 安装到全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="16bea-247">The following command installs the assembly `mydll.dll` into the global assembly cache.</span></span>

```console
gacutil /i mydll.dll
```

<span data-ttu-id="16bea-248">以下命令从全局程序集缓存中移除程序集 `hello`（只要不存在对该程序集的引用计数）。</span><span class="sxs-lookup"><span data-stu-id="16bea-248">The following command removes the assembly `hello` from the global assembly cache as long as no reference counts exist for the assembly.</span></span>

```console
gacutil /u hello
```

<span data-ttu-id="16bea-249">请注意，由于未指定完全的程序集名称，上面的命令可能会从程序集缓存中移除多个程序集。</span><span class="sxs-lookup"><span data-stu-id="16bea-249">Note that the previous command might remove more than one assembly from the assembly cache because the assembly name is not fully specified.</span></span> <span data-ttu-id="16bea-250">例如，如果在该缓存中安装有 `hello` 的 1.0.0.0 和 3.2.2.1 两个版本，则 `gacutil /u hello` 命令会将这两个程序集都移除。</span><span class="sxs-lookup"><span data-stu-id="16bea-250">For example, if both version 1.0.0.0 and 3.2.2.1 of `hello` are installed in the cache, the command `gacutil /u hello` removes both of the assemblies.</span></span>

<span data-ttu-id="16bea-251">使用下面的示例可避免删除多个程序集。</span><span class="sxs-lookup"><span data-stu-id="16bea-251">Use the following example to avoid removing more than one assembly.</span></span> <span data-ttu-id="16bea-252">此命令只删除与完全指定的版本号、区域性和公钥匹配的 `hello` 程序集。</span><span class="sxs-lookup"><span data-stu-id="16bea-252">This command removes only the `hello` assembly that matches the fully specified version number, culture, and public key.</span></span>

```console
gacutil /u hello, Version=1.0.0.1, Culture="de",PublicKeyToken=45e343aae32233ca
```

<span data-ttu-id="16bea-253">以下命令将 `assemblyList.txt` 文件中指定的程序集安装到全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="16bea-253">The following command installs the assemblies specified in the file `assemblyList.txt` into the global assembly cache.</span></span>

```console
gacutil /il assemblyList.txt
```

<span data-ttu-id="16bea-254">以下命令从全局程序集缓存中移除 `assemblyList.txt` 文件中指定的程序集。</span><span class="sxs-lookup"><span data-stu-id="16bea-254">The following command removes the assemblies specified in the file `assemblyList.txt` from the global assembly cache.</span></span>

```console
gacutil /ul assemblyList.txt
```

<span data-ttu-id="16bea-255">以下命令将 `myDll.dll` 安装到全局程序集缓存中并添加引用以对其进行计数。</span><span class="sxs-lookup"><span data-stu-id="16bea-255">The following command installs `myDll.dll` into the global assembly cache and adds a reference to count it.</span></span> <span data-ttu-id="16bea-256">程序集 `myDll.dll` 由应用程序 `MyApp` 使用。</span><span class="sxs-lookup"><span data-stu-id="16bea-256">The assembly `myDll.dll` is used by the application `MyApp`.</span></span> <span data-ttu-id="16bea-257">`UNINSTALL_KEY MyApp` 参数指定可将 `MyApp` 添加到 Windows 的“添加/删除程序”的注册表项。</span><span class="sxs-lookup"><span data-stu-id="16bea-257">The `UNINSTALL_KEY MyApp` parameter specifies the registry key that adds `MyApp` to Add/Remove Programs in Windows.</span></span> <span data-ttu-id="16bea-258">description 参数被指定为 `My Application Description`。</span><span class="sxs-lookup"><span data-stu-id="16bea-258">The description parameter is specified as `My Application Description`.</span></span>

```console
gacutil /i /r myDll.dll UNINSTALL_KEY MyApp "My Application Description"
```

<span data-ttu-id="16bea-259">以下命令将 `myDll.dll` 安装到全局程序集缓存中并添加引用以对其进行计数。</span><span class="sxs-lookup"><span data-stu-id="16bea-259">The following command installs `myDll.dll` into the global assembly cache and adds a reference to count it.</span></span> <span data-ttu-id="16bea-260">scheme 参数 `FILEPATH` 和 id 参数 `c:\applications\myApp\myApp.exe` 指定要安装 `myDll.dll.` 的应用程序的路径。description 参数被指定为 `MyApp`。</span><span class="sxs-lookup"><span data-stu-id="16bea-260">The scheme parameter, `FILEPATH`, and the id parameter, `c:\applications\myApp\myApp.exe`, specify the path to the application that is installing `myDll.dll.` The description parameter is specified as `MyApp`.</span></span>

```console
gacutil /i /r myDll.dll FILEPATH c:\applications\myApp\myApp.exe MyApp
```

<span data-ttu-id="16bea-261">以下命令将 `myDll.dll` 安装到全局程序集缓存中并添加引用以对其进行计数。</span><span class="sxs-lookup"><span data-stu-id="16bea-261">The following command installs `myDll.dll` into the global assembly cache and adds a reference to count it.</span></span> <span data-ttu-id="16bea-262">scheme 参数 `OPAQUE` 允许你自定义 id 和 description 参数。</span><span class="sxs-lookup"><span data-stu-id="16bea-262">The scheme parameter, `OPAQUE`, allows you to customize the id and description parameters.</span></span>

```console
gacutil /i /r mydll.dll OPAQUE "Insert custom application details here" "Insert Custom description information here"
```

<span data-ttu-id="16bea-263">以下命令移除应用程序 `myDll.dll` 对 `myApp` 的引用。</span><span class="sxs-lookup"><span data-stu-id="16bea-263">The following command removes the reference to `myDll.dll` by the application `myApp`.</span></span> <span data-ttu-id="16bea-264">如果这是对该程序集的最后一个引用，则将同时从全局程序集缓存中移除该程序集。</span><span class="sxs-lookup"><span data-stu-id="16bea-264">If this is the last reference to the assembly, it will also remove the assembly from the global assembly cache.</span></span>

```console
gacutil /u /r myDll.dll FILEPATH c:\applications\myApp\myApp.exe MyApp
```

<span data-ttu-id="16bea-265">下面的命令列出全局程序集缓存的内容。</span><span class="sxs-lookup"><span data-stu-id="16bea-265">The following command lists the contents of the global assembly cache.</span></span>

```console
gacutil /l
```

## <a name="see-also"></a><span data-ttu-id="16bea-266">请参阅</span><span class="sxs-lookup"><span data-stu-id="16bea-266">See also</span></span>

- [<span data-ttu-id="16bea-267">工具</span><span class="sxs-lookup"><span data-stu-id="16bea-267">Tools</span></span>](index.md)
- [<span data-ttu-id="16bea-268">全局程序集缓存</span><span class="sxs-lookup"><span data-stu-id="16bea-268">Global Assembly Cache</span></span>](../app-domains/gac.md)
- [<span data-ttu-id="16bea-269">Regasm.exe（程序集注册工具）</span><span class="sxs-lookup"><span data-stu-id="16bea-269">Regasm.exe (Assembly Registration Tool)</span></span>](regasm-exe-assembly-registration-tool.md)
- [<span data-ttu-id="16bea-270">命令提示</span><span class="sxs-lookup"><span data-stu-id="16bea-270">Command Prompts</span></span>](developer-command-prompt-for-vs.md)
