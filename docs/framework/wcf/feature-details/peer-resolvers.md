---
title: 对等解析程序
ms.date: 03/30/2017
ms.assetid: d86d12a1-7358-450f-9727-b6afb95adb9c
ms.openlocfilehash: ef72f44a7dd7f3e8f3108e4f77dcdbdf8ef1b1b7
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/15/2020
ms.locfileid: "90554627"
---
# <a name="peer-resolvers"></a><span data-ttu-id="ecfd3-102">对等解析程序</span><span class="sxs-lookup"><span data-stu-id="ecfd3-102">Peer Resolvers</span></span>
<span data-ttu-id="ecfd3-103">为了连接到网格，对等节点需要获得其他节点的 IP 地址。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-103">In order to connect to a mesh, a peer node requires the IP addresses of other nodes.</span></span> <span data-ttu-id="ecfd3-104">IP 地址可通过联系解析程序服务来获取，该服务获取网格 ID，然后返回与向该特定网格 ID 注册的节点对应的地址列表。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-104">IP addresses are obtained by contacting a resolver service, which takes the mesh ID and returns a list of addresses corresponding to nodes registered with that particular mesh ID.</span></span> <span data-ttu-id="ecfd3-105">解析程序保持已注册地址的列表，此列表是它通过让网格中的每个节点向该服务注册而创建的。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-105">The resolver keeps a list of registered addresses, which it creates by having each node in the mesh register with the service.</span></span>  
  
 <span data-ttu-id="ecfd3-106">可以通过 `Resolver` 的 <xref:System.ServiceModel.NetPeerTcpBinding> 属性指定使用哪个 PeerResolver 服务。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-106">You can specify which PeerResolver service to use through the `Resolver` property of the <xref:System.ServiceModel.NetPeerTcpBinding>.</span></span>  
  
## <a name="supported-peer-resolvers"></a><span data-ttu-id="ecfd3-107">支持的对等解析程序</span><span class="sxs-lookup"><span data-stu-id="ecfd3-107">Supported Peer Resolvers</span></span>  
 <span data-ttu-id="ecfd3-108">对等通道支持两种类型的解析程序：对等名称解析协议 (PNRP) 和自定义解析程序服务。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-108">Peer Channel supports two types of resolvers: Peer Name Resolution Protocol (PNRP), and custom resolver services.</span></span>  
  
 <span data-ttu-id="ecfd3-109">默认情况下，对等通道使用 PNRP 对等解析程序服务发现网格中的对等方和邻居。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-109">By default, Peer Channel uses the PNRP peer resolver service for discovery of peers and neighbors in the mesh.</span></span> <span data-ttu-id="ecfd3-110">对于 PNRP 不可用或不可行的情况/平台，Windows Communication Foundation (WCF) 提供一种基于服务器的替代发现服务，即 <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> 。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-110">For situations/platforms where PNRP is not available or feasible, Windows Communication Foundation (WCF) provides an alternative, server-based discovery service - the <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService>.</span></span> <span data-ttu-id="ecfd3-111">也可以通过编写实现 <xref:System.ServiceModel.PeerResolvers.IPeerResolverContract> 接口的类来显式定义自定义解析程序服务。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-111">You can also explicitly define a custom resolver service by writing a class that implements the <xref:System.ServiceModel.PeerResolvers.IPeerResolverContract> interface.</span></span>  
  
### <a name="peer-name-resolution-protocol-pnrp"></a><span data-ttu-id="ecfd3-112">对等名称解析协议 (PNRP)</span><span class="sxs-lookup"><span data-stu-id="ecfd3-112">Peer Name Resolution Protocol (PNRP)</span></span>  
 <span data-ttu-id="ecfd3-113">PNRP （适用于 Windows Vista 的默认冲突解决程序）是一个分布式的无服务器名称解析程序服务。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-113">PNRP, the default resolver for Windows Vista, is a distributed, serverless name resolver service.</span></span> <span data-ttu-id="ecfd3-114">还可以通过安装高级网络包，在 Windows XP SP2 上使用 PNRP。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-114">PNRP can also be used on Windows XP SP2 by installing the Advanced Networking Pack.</span></span> <span data-ttu-id="ecfd3-115">只要满足一定条件（例如中间不存在企业防火墙），则任何两个运行相同版本 PNRP 的客户端都可以使用此协议找到对方。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-115">Any two clients running the same version of PNRP can locate each other using this protocol, provided they meet certain conditions (such as the lack of an intervening corporate firewall).</span></span> <span data-ttu-id="ecfd3-116">请注意，Windows Vista 附带的 PNRP 版本比高级网络包中包含的版本更新。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-116">Note that the version of PNRP that ships with Windows Vista is newer than the version included in the Advanced Networking Pack.</span></span> <span data-ttu-id="ecfd3-117">在 Microsoft 下载中心查看适用于 Windows XP SP2 的 PNRP 更新。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-117">Check the Microsoft Download Center for updates to PNRP for Windows XP SP2.</span></span>  
  
### <a name="custom-resolver-services"></a><span data-ttu-id="ecfd3-118">自定义解析程序服务</span><span class="sxs-lookup"><span data-stu-id="ecfd3-118">Custom Resolver Services</span></span>  
 <span data-ttu-id="ecfd3-119">当 PNRP 服务不可用或您希望完全控制网格形状时，可以使用自定义的基于服务器的解析程序服务。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-119">When the PNRP service is unavailable, or you want complete control over mesh shaping, you can use a custom, server-based resolver service.</span></span> <span data-ttu-id="ecfd3-120">可以通过编写一个实现 <xref:System.ServiceModel.PeerResolvers.IPeerResolverContract> 接口的解析程序类，或通过使用系统附带的默认实现 <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> 来显式定义此服务。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-120">You can explicitly define this service by writing a resolver class implementing the <xref:System.ServiceModel.PeerResolvers.IPeerResolverContract> interface, or by using the in-box default implementation, <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService>.</span></span>  
  
 <span data-ttu-id="ecfd3-121">按照该服务的默认实现，如果客户端不显式刷新注册，则在经过一定的时间后，客户端注册将到期。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-121">Under the default implementation of the service, client registrations expire after a certain amount of time if the client does not explicitly refresh the registration.</span></span> <span data-ttu-id="ecfd3-122">为了能及时地成功刷新注册，使用该解析程序服务的客户端必须了解客户端-服务器延迟的上限。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-122">Clients using the resolver service must be aware of the upper bound on client-server latency in order to successfully refresh registrations in time.</span></span> <span data-ttu-id="ecfd3-123">这需要在解析程序服务中选择适当的刷新超时 (`RefreshInterval`)。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-123">This involves choosing an appropriate refresh time-out (`RefreshInterval`) on the resolver service.</span></span> <span data-ttu-id="ecfd3-124"> (有关详细信息，请参阅 [CustomPeerResolverService：客户端注册中的](inside-the-custompeerresolverservice-client-registrations.md)。 ) </span><span class="sxs-lookup"><span data-stu-id="ecfd3-124">(For more information, see [Inside the CustomPeerResolverService: Client Registrations](inside-the-custompeerresolverservice-client-registrations.md).)</span></span>  
  
 <span data-ttu-id="ecfd3-125">应用程序编写者还必须考虑保护客户端和自定义解析程序服务之间连接的安全。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-125">The application writer must also consider securing the connection between clients and the custom resolver service.</span></span> <span data-ttu-id="ecfd3-126">使用客户端用来联系解析程序服务的 <xref:System.ServiceModel.NetTcpBinding> 上的安全设置，可以达到此目的。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-126">You may do this by using security settings on the <xref:System.ServiceModel.NetTcpBinding> that clients use to contact the resolver service.</span></span> <span data-ttu-id="ecfd3-127">在用于创建对等通道的 `ChannelFactory` 上，必须指定凭据（如果使用）。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-127">You must specify credentials (if used) on the `ChannelFactory` used to create Peer Channel.</span></span> <span data-ttu-id="ecfd3-128">这些凭据将被传递到用来创建通向自定义解析程序的通道的 `ChannelFactory`。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-128">These credentials are passed to the `ChannelFactory` used to create channels to the custom resolver.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="ecfd3-129">当在本地网络和临时网络中使用自定义解析程序时，强烈建议使用或支持链接本地网络或临时网络的应用程序中包含相应的逻辑，以便选择要在连接时使用的单个链接本地地址。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-129">When using local and impromptu networks with a custom resolver, it is strongly advised that applications using or supporting link-local or impromptu networks include logic that selects a single link-local address to use when connecting.</span></span> <span data-ttu-id="ecfd3-130">这可以防止具有多个链接本地地址的计算机产生任何混淆。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-130">This prevents any confusion potentially caused by computers with multiple link-local addresses.</span></span> <span data-ttu-id="ecfd3-131">有鉴于此，对等通道仅支持在任一时刻使用单个链接本地地址。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-131">In accordance with this, Peer Channel only supports using a single link-local address at any one time.</span></span> <span data-ttu-id="ecfd3-132">可以使用 `ListenIpAddress` 上的 <xref:System.ServiceModel.NetPeerTcpBinding> 属性来指定该地址。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-132">You may specify this address with the `ListenIpAddress` property on the <xref:System.ServiceModel.NetPeerTcpBinding>.</span></span>  
  
 <span data-ttu-id="ecfd3-133">有关如何实现自定义冲突解决程序的演示，请参阅 [对等通道自定义对等解析程序](/previous-versions/dotnet/netframework-3.5/ms751466(v=vs.90))。</span><span class="sxs-lookup"><span data-stu-id="ecfd3-133">For a demonstration of how to implement a custom resolver, see [Peer Channel Custom Peer Resolver](/previous-versions/dotnet/netframework-3.5/ms751466(v=vs.90)).</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="ecfd3-134">本节内容</span><span class="sxs-lookup"><span data-stu-id="ecfd3-134">In This Section</span></span>  
 [<span data-ttu-id="ecfd3-135">CustomPeerResolverService 内部：客户端注册</span><span class="sxs-lookup"><span data-stu-id="ecfd3-135">Inside the CustomPeerResolverService: Client Registrations</span></span>](inside-the-custompeerresolverservice-client-registrations.md)  
  
## <a name="see-also"></a><span data-ttu-id="ecfd3-136">请参阅</span><span class="sxs-lookup"><span data-stu-id="ecfd3-136">See also</span></span>

- [<span data-ttu-id="ecfd3-137">对等通道概念</span><span class="sxs-lookup"><span data-stu-id="ecfd3-137">Peer Channel Concepts</span></span>](peer-channel-concepts.md)
- [<span data-ttu-id="ecfd3-138">对等通道安全性</span><span class="sxs-lookup"><span data-stu-id="ecfd3-138">Peer Channel Security</span></span>](peer-channel-security.md)
- [<span data-ttu-id="ecfd3-139">生成对等通道应用程序</span><span class="sxs-lookup"><span data-stu-id="ecfd3-139">Building a Peer Channel Application</span></span>](building-a-peer-channel-application.md)
