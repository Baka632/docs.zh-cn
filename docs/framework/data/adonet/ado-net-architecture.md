---
title: 体系结构
description: 了解 ADO.NET 体系结构，其中包括用于访问和操作数据的两个主要组件： .NET Framework 数据提供程序和数据集。
ms.date: 03/30/2017
ms.assetid: fcd45b99-ae8f-45ab-8b97-d887beda734e
ms.openlocfilehash: 8d45c1d0b33f3e7bf86a42561bfaa13772aa5a31
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/24/2020
ms.locfileid: "91166906"
---
# <a name="adonet-architecture"></a><span data-ttu-id="00f42-103">ADO.NET 体系结构</span><span class="sxs-lookup"><span data-stu-id="00f42-103">ADO.NET Architecture</span></span>

<span data-ttu-id="00f42-104">以前，数据处理主要依赖于基于连接的双层模型。</span><span class="sxs-lookup"><span data-stu-id="00f42-104">Data processing has traditionally relied primarily on a connection-based, two-tier model.</span></span> <span data-ttu-id="00f42-105">随着数据处理越来越多地使用多层体系结构，程序员正在向断开方法转换，以便为他们的应用程序提供更好的可伸缩性。</span><span class="sxs-lookup"><span data-stu-id="00f42-105">As data processing increasingly uses multi-tier architectures, programmers are switching to a disconnected approach to provide better scalability for their applications.</span></span>  
  
## <a name="adonet-components"></a><span data-ttu-id="00f42-106">ADO.NET 组件</span><span class="sxs-lookup"><span data-stu-id="00f42-106">ADO.NET Components</span></span>  

 <span data-ttu-id="00f42-107">用于访问和操作数据的 ADO.NET 的两个主要组件是 .NET Framework 的数据访问接口和 <xref:System.Data.DataSet> 。</span><span class="sxs-lookup"><span data-stu-id="00f42-107">The two main components of ADO.NET for accessing and manipulating data are the .NET Framework data providers and the <xref:System.Data.DataSet>.</span></span>  
  
### <a name="net-framework-data-providers"></a><span data-ttu-id="00f42-108">.NET Framework 数据提供程序</span><span class="sxs-lookup"><span data-stu-id="00f42-108">.NET Framework Data Providers</span></span>  

 <span data-ttu-id="00f42-109">.NET Framework 数据提供程序是专门为数据操作以及快速、只进、只读访问数据而设计的组件。</span><span class="sxs-lookup"><span data-stu-id="00f42-109">The .NET Framework Data Providers are components that have been explicitly designed for data manipulation and fast, forward-only, read-only access to data.</span></span> <span data-ttu-id="00f42-110">`Connection` 对象提供到数据源的连接。</span><span class="sxs-lookup"><span data-stu-id="00f42-110">The `Connection` object provides connectivity to a data source.</span></span> <span data-ttu-id="00f42-111">使用 `Command` 对象可以访问用于返回数据、修改数据、运行存储过程以及发送或检索参数信息的数据库命令。</span><span class="sxs-lookup"><span data-stu-id="00f42-111">The `Command` object enables access to database commands to return data, modify data, run stored procedures, and send or retrieve parameter information.</span></span> <span data-ttu-id="00f42-112">`DataReader` 可从数据源提供高性能的数据流。</span><span class="sxs-lookup"><span data-stu-id="00f42-112">The `DataReader` provides a high-performance stream of data from the data source.</span></span> <span data-ttu-id="00f42-113">最后，`DataAdapter` 在 `DataSet` 对象和数据源之间起到桥梁作用。</span><span class="sxs-lookup"><span data-stu-id="00f42-113">Finally, the `DataAdapter` provides the bridge between the `DataSet` object and the data source.</span></span> <span data-ttu-id="00f42-114">`DataAdapter` 使用 `Command` 对象在数据源中执行 SQL 命令以向 `DataSet` 中加载数据，并将对 `DataSet` 中数据的更改协调回数据源。</span><span class="sxs-lookup"><span data-stu-id="00f42-114">The `DataAdapter` uses `Command` objects to execute SQL commands at the data source to both load the `DataSet` with data and reconcile changes that were made to the data in the `DataSet` back to the data source.</span></span> <span data-ttu-id="00f42-115">有关详细信息，请参阅 [.NET Framework 数据访问接口](data-providers.md) 和 [检索和修改 ADO.NET 中的数据](retrieving-and-modifying-data.md)。</span><span class="sxs-lookup"><span data-stu-id="00f42-115">For more information, see [.NET Framework Data Providers](data-providers.md) and [Retrieving and Modifying Data in ADO.NET](retrieving-and-modifying-data.md).</span></span>  
  
### <a name="the-dataset"></a><span data-ttu-id="00f42-116">DataSet</span><span class="sxs-lookup"><span data-stu-id="00f42-116">The DataSet</span></span>  

 <span data-ttu-id="00f42-117">ADO.NET `DataSet` 是专门为独立于任何数据源的数据访问而设计的。</span><span class="sxs-lookup"><span data-stu-id="00f42-117">The ADO.NET `DataSet` is explicitly designed for data access independent of any data source.</span></span> <span data-ttu-id="00f42-118">因此，它可以用于多种不同的数据源，用于 XML 数据，或用于管理应用程序本地的数据。</span><span class="sxs-lookup"><span data-stu-id="00f42-118">As a result, it can be used with multiple and differing data sources, used with XML data, or used to manage data local to the application.</span></span> <span data-ttu-id="00f42-119">`DataSet` 包含一个或多个 <xref:System.Data.DataTable> 对象的集合，这些对象由数据行和数据列以及有关 `DataTable` 对象中数据的主键、外键、约束和关系信息组成。</span><span class="sxs-lookup"><span data-stu-id="00f42-119">The `DataSet` contains a collection of one or more <xref:System.Data.DataTable> objects consisting of rows and columns of data, and also primary key, foreign key, constraint, and relation information about the data in the `DataTable` objects.</span></span> <span data-ttu-id="00f42-120">有关详细信息，请参阅 [数据集、数据表和 dataview](./dataset-datatable-dataview/index.md)。</span><span class="sxs-lookup"><span data-stu-id="00f42-120">For more information, see [DataSets, DataTables, and DataViews](./dataset-datatable-dataview/index.md).</span></span>  
  
 <span data-ttu-id="00f42-121">下图说明了 .NET Framework 数据访问接口与之间的关系 `DataSet` 。</span><span class="sxs-lookup"><span data-stu-id="00f42-121">The following diagram illustrates the relationship between a .NET Framework data provider and a `DataSet`.</span></span>  
  
 <span data-ttu-id="00f42-122">![ADO.Net 图](./media/ado-1-bpuedev11.png "ado_1_bpuedev11")</span><span class="sxs-lookup"><span data-stu-id="00f42-122">![ADO.Net graphic](./media/ado-1-bpuedev11.png "ado_1_bpuedev11")</span></span>  
<span data-ttu-id="00f42-123">ADO.NET 体系结构</span><span class="sxs-lookup"><span data-stu-id="00f42-123">ADO.NET architecture</span></span>  
  
### <a name="choosing-a-datareader-or-a-dataset"></a><span data-ttu-id="00f42-124">选择 DataReader 或 DataSet</span><span class="sxs-lookup"><span data-stu-id="00f42-124">Choosing a DataReader or a DataSet</span></span>  

 <span data-ttu-id="00f42-125">如果确定应用程序是否应使用 `DataReader` (请参阅 [使用 DataReader 检索数据](retrieving-data-using-a-datareader.md)) 或 `DataSet` (查看数据 [集、数据表和 dataview](./dataset-datatable-dataview/index.md)) ，请考虑应用程序所需的功能类型。</span><span class="sxs-lookup"><span data-stu-id="00f42-125">When you decide whether your application should use a `DataReader` (see [Retrieving Data Using a DataReader](retrieving-data-using-a-datareader.md)) or a `DataSet` (see [DataSets, DataTables, and DataViews](./dataset-datatable-dataview/index.md)), consider the type of functionality that your application requires.</span></span> <span data-ttu-id="00f42-126">使用 `DataSet` 可执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="00f42-126">Use a `DataSet` to do the following:</span></span>  
  
- <span data-ttu-id="00f42-127">在应用程序中将数据缓存在本地，以便可以对数据进行处理。</span><span class="sxs-lookup"><span data-stu-id="00f42-127">Cache data locally in your application so that you can manipulate it.</span></span> <span data-ttu-id="00f42-128">如果只需要读取查询结果，则 `DataReader` 是更好的选择。</span><span class="sxs-lookup"><span data-stu-id="00f42-128">If you only need to read the results of a query, the `DataReader` is the better choice.</span></span>  
  
- <span data-ttu-id="00f42-129">在层间或从 XML Web services 对数据进行远程处理。</span><span class="sxs-lookup"><span data-stu-id="00f42-129">Remote data between tiers or from an XML Web service.</span></span>  
  
- <span data-ttu-id="00f42-130">与数据进行动态交互，例如绑定到 Windows 窗体控件或组合并关联来自多个源的数据。</span><span class="sxs-lookup"><span data-stu-id="00f42-130">Interact with data dynamically such as binding to a Windows Forms control or combining and relating data from multiple sources.</span></span>  
  
- <span data-ttu-id="00f42-131">对数据执行大量的处理，而不需要与数据源保持打开的连接，从而将该连接释放给其他客户端使用。</span><span class="sxs-lookup"><span data-stu-id="00f42-131">Perform extensive processing on data without requiring an open connection to the data source, which frees the connection to be used by other clients.</span></span>  
  
 <span data-ttu-id="00f42-132">如果不需要 `DataSet` 所提供的功能，则可以通过使用 `DataReader` 以只进、只读方式返回数据，从而提高应用程序的性能。</span><span class="sxs-lookup"><span data-stu-id="00f42-132">If you do not require the functionality provided by the `DataSet`, you can improve the performance of your application by using the `DataReader` to return your data in a forward-only, read-only manner.</span></span> <span data-ttu-id="00f42-133">尽管 `DataAdapter` 使用 `DataReader` 填充 (的内容 `DataSet` ，请参阅使用 [从 DataAdapter 填充数据集](populating-a-dataset-from-a-dataadapter.md)) 中，你可以通过使用来 `DataReader` 提高性能，因为你将保存将使用的内存 `DataSet` ，并避免创建和填充的内容所需的处理 `DataSet` 。</span><span class="sxs-lookup"><span data-stu-id="00f42-133">Although the `DataAdapter` uses the `DataReader` to fill the contents of a `DataSet` (see [Populating a DataSet from a DataAdapter](populating-a-dataset-from-a-dataadapter.md)), by using the `DataReader`, you can boost performance because you will save memory that would be consumed by the `DataSet`, and avoid the processing that is required to create and fill the contents of the `DataSet`.</span></span>  
  
## <a name="linq-to-dataset"></a><span data-ttu-id="00f42-134">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="00f42-134">LINQ to DataSet</span></span>  

 <span data-ttu-id="00f42-135">LINQ to DataSet 提供对在 DataSet 对象中缓存的数据的查询功能和编译时类型检查。</span><span class="sxs-lookup"><span data-stu-id="00f42-135">LINQ to DataSet provides query capabilities and compile-time type checking over data cached in a DataSet object.</span></span> <span data-ttu-id="00f42-136">它使您可以使用一种 .NET Framework 开发语言（例如 C# 或 Visual Basic）来编写查询。</span><span class="sxs-lookup"><span data-stu-id="00f42-136">It allows you to write queries in one of the .NET Framework development language, such as C# or Visual Basic.</span></span> <span data-ttu-id="00f42-137">有关详细信息，请参阅 [LINQ to DataSet](linq-to-dataset.md)。</span><span class="sxs-lookup"><span data-stu-id="00f42-137">For more information, see [LINQ to DataSet](linq-to-dataset.md).</span></span>  
  
## <a name="linq-to-sql"></a><span data-ttu-id="00f42-138">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="00f42-138">LINQ to SQL</span></span>  

 <span data-ttu-id="00f42-139">LINQ to SQL 支持查询无需使用中间概念模型即可映射到关系数据库数据结构的对象模型。</span><span class="sxs-lookup"><span data-stu-id="00f42-139">LINQ to SQL supports queries against an object model that is mapped to the data structures of a relational database without using an intermediate conceptual model.</span></span> <span data-ttu-id="00f42-140">每个表均由独立的类表示，从而使对象模型与关系数据库架构紧密地耦合在一起。</span><span class="sxs-lookup"><span data-stu-id="00f42-140">Each table is represented by a separate class, tightly coupling the object model to the relational database schema.</span></span> <span data-ttu-id="00f42-141">LINQ to SQL 可将对象模型中的语言集成查询转换为 Transact-SQL 并将其发送到数据库以便执行。</span><span class="sxs-lookup"><span data-stu-id="00f42-141">LINQ to SQL translates language-integrated queries in the object model into Transact-SQL and sends them to the database for execution.</span></span> <span data-ttu-id="00f42-142">当数据库返回结果时，LINQ to SQL 将结果转换回对象。</span><span class="sxs-lookup"><span data-stu-id="00f42-142">When the database returns the results, LINQ to SQL translates the results back into objects.</span></span> <span data-ttu-id="00f42-143">有关详细信息，请参阅 [LINQ to SQL](./sql/linq/index.md)。</span><span class="sxs-lookup"><span data-stu-id="00f42-143">For more information, see [LINQ to SQL](./sql/linq/index.md).</span></span>  
  
## <a name="adonet-entity-framework"></a><span data-ttu-id="00f42-144">ADO.NET 实体框架</span><span class="sxs-lookup"><span data-stu-id="00f42-144">ADO.NET Entity Framework</span></span>  

 <span data-ttu-id="00f42-145">ADO.NET 实体框架专门用于让开发人员能够通过针对概念应用程序模型进行编程（而不是直接针对关系存储架构进行编程）来创建数据访问应用程序。</span><span class="sxs-lookup"><span data-stu-id="00f42-145">The ADO.NET Entity Framework is designed to enable developers to create data access applications by programming against a conceptual application model instead of programming directly against a relational storage schema.</span></span> <span data-ttu-id="00f42-146">这样做的目的是减少面向数据的应用程序所需的编码和维护工作。</span><span class="sxs-lookup"><span data-stu-id="00f42-146">The goal is to decrease the amount of code and maintenance required for data-oriented applications.</span></span> <span data-ttu-id="00f42-147">有关详细信息，请参阅 [ADO.NET 实体框架](./ef/index.md)。</span><span class="sxs-lookup"><span data-stu-id="00f42-147">For more information, see [ADO.NET Entity Framework](./ef/index.md).</span></span>  
  
## <a name="wcf-data-services"></a><span data-ttu-id="00f42-148">WCF 数据服务</span><span class="sxs-lookup"><span data-stu-id="00f42-148">WCF Data Services</span></span>  

 <span data-ttu-id="00f42-149">WCF 数据服务用于在 Web 或 intranet 上部署数据服务。</span><span class="sxs-lookup"><span data-stu-id="00f42-149">WCF Data Services is used to deploy data services on the Web or an intranet.</span></span> <span data-ttu-id="00f42-150">这些数据将按照实体数据模型的规范组织成不同的实体和关系。</span><span class="sxs-lookup"><span data-stu-id="00f42-150">The data is structured as entities and relationships according to the specifications of the Entity Data Model.</span></span> <span data-ttu-id="00f42-151">在此模型上部署的数据可通过标准的 HTTP 协议进行寻址。</span><span class="sxs-lookup"><span data-stu-id="00f42-151">Data deployed on this model is addressable by standard HTTP protocol.</span></span> <span data-ttu-id="00f42-152">有关详细信息，请参阅 [WCF Data Services 4.5](../wcf/index.md)。</span><span class="sxs-lookup"><span data-stu-id="00f42-152">For more information, see [WCF Data Services 4.5](../wcf/index.md).</span></span>  
  
## <a name="xml-and-adonet"></a><span data-ttu-id="00f42-153">XML 和 ADO.NET</span><span class="sxs-lookup"><span data-stu-id="00f42-153">XML and ADO.NET</span></span>  

 <span data-ttu-id="00f42-154">ADO.NET 利用 XML 的强大功能来提供对数据的断开连接访问。</span><span class="sxs-lookup"><span data-stu-id="00f42-154">ADO.NET leverages the power of XML to provide disconnected access to data.</span></span> <span data-ttu-id="00f42-155">ADO.NET 是与 .NET Framework 中的 XML 类一起设计的：两者都是单个体系结构的组成部分。</span><span class="sxs-lookup"><span data-stu-id="00f42-155">ADO.NET was designed hand-in-hand with the XML classes in the .NET Framework; both are components of a single architecture.</span></span>  
  
 <span data-ttu-id="00f42-156">.NET Framework 聚合在对象中的 ADO.NET 和中的 XML 类 `DataSet` 。</span><span class="sxs-lookup"><span data-stu-id="00f42-156">ADO.NET and the XML classes in the .NET Framework converge in the `DataSet` object.</span></span> <span data-ttu-id="00f42-157">无论 XML 源是文件还是 XML 流，都可以用其中的数据来填充 `DataSet`。</span><span class="sxs-lookup"><span data-stu-id="00f42-157">The `DataSet` can be populated with data from an XML source, whether it is a file or an XML stream.</span></span> <span data-ttu-id="00f42-158">无论 `DataSet` 中数据的源是什么，都可以将 `DataSet` 作为符合万维网联合会 (W3C) 的 XML 进行编写，其架构作为 XML 架构定义语言 (XSD) 架构。</span><span class="sxs-lookup"><span data-stu-id="00f42-158">The `DataSet` can be written as World-Wide Web Consortium (W3C) compliant XML that includes its schema as XML schema definition language (XSD) schema, regardless of the source of the data in the `DataSet`.</span></span> <span data-ttu-id="00f42-159">由于 `DataSet` 的本机序列化格式为 XML，因此它是用于在层间移动数据的绝佳媒介，这使 `DataSet` 成为了与 XML Web 服务之间远程处理数据和架构上下文的最佳选择。</span><span class="sxs-lookup"><span data-stu-id="00f42-159">Because of the native serialization format of the `DataSet` is XML, it is an excellent medium for moving data between tiers, making the `DataSet` an optimal choice for remoting data and schema context to and from an XML Web service.</span></span> <span data-ttu-id="00f42-160">有关详细信息，请参阅 [XML 文档和数据](../../../standard/data/xml/index.md)。</span><span class="sxs-lookup"><span data-stu-id="00f42-160">For more information, see [XML Documents and Data](../../../standard/data/xml/index.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="00f42-161">请参阅</span><span class="sxs-lookup"><span data-stu-id="00f42-161">See also</span></span>

- [<span data-ttu-id="00f42-162">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="00f42-162">ADO.NET Overview</span></span>](ado-net-overview.md)
