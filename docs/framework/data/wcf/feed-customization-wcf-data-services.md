---
title: 源自定义（WCF 数据服务）
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, feeds
- WCF Data Services, Atom protocol
- Atom Publishing Protocol [WCF Data Services]
- WCF Data Services, customizing feeds
ms.assetid: 0d1a39bc-6462-4683-bd7d-e74e0fd28a85
ms.openlocfilehash: bf25737d98a880ac720318de18b687b4df5b0708
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/24/2020
ms.locfileid: "91172627"
---
# <a name="feed-customization-wcf-data-services"></a><span data-ttu-id="a481d-102">源自定义（WCF 数据服务）</span><span class="sxs-lookup"><span data-stu-id="a481d-102">Feed Customization (WCF Data Services)</span></span>

<span data-ttu-id="a481d-103">WCF 数据服务使用 Open Data Protocol (OData) 将数据公开为源。</span><span class="sxs-lookup"><span data-stu-id="a481d-103">WCF Data Services uses the Open Data Protocol (OData) to expose data as a feed.</span></span> <span data-ttu-id="a481d-104">OData 支持用于数据馈送的 Atom 和 JavaScript 对象表示法 (JSON) 格式。</span><span class="sxs-lookup"><span data-stu-id="a481d-104">OData supports both Atom and JavaScript Object Notation (JSON) formats for data feeds.</span></span> <span data-ttu-id="a481d-105">使用 Atom 馈送时，OData 提供一种标准方法，用于将数据（如实体和关系）序列化为可包含在 HTTP 消息正文中的 XML 格式。</span><span class="sxs-lookup"><span data-stu-id="a481d-105">When you use an Atom feed, OData provides a standard method to serialize data, such as entities and relationships, into an XML format that can be included in the body of HTTP message.</span></span> <span data-ttu-id="a481d-106">OData 定义实体中包含的数据与 Atom 元素之间的默认实体属性映射。</span><span class="sxs-lookup"><span data-stu-id="a481d-106">OData defines a default entity-property mapping between the data that is contained in entities and Atom elements.</span></span> <span data-ttu-id="a481d-107">有关详细信息，请参阅 [OData： Atom 格式](https://www.odata.org/documentation/odata-version-2-0/atom-format/)。</span><span class="sxs-lookup"><span data-stu-id="a481d-107">For more information, see [OData: Atom Format](https://www.odata.org/documentation/odata-version-2-0/atom-format/).</span></span>  
  
 <span data-ttu-id="a481d-108">您的应用程序方案可能要求以自定义方式而非标准源格式序列化数据服务返回的属性数据。</span><span class="sxs-lookup"><span data-stu-id="a481d-108">You may have an application scenario that requires that the property data returned by the data service be serialized in a customized manner rather than in the standard feed format.</span></span> <span data-ttu-id="a481d-109">使用 OData，你可以在数据馈送中自定义序列化，以便可以将实体的属性映射到某个条目的未使用的元素和属性，或者映射到源中条目的自定义元素。</span><span class="sxs-lookup"><span data-stu-id="a481d-109">With OData, you can customize the serialization in a data feed so that properties of an entity may be mapped to unused elements and attributes of an entry or to custom elements of an entry in the feed.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="a481d-110">只有 Atom 馈送才支持源自定义。</span><span class="sxs-lookup"><span data-stu-id="a481d-110">Feed customization is only supported for Atom feeds.</span></span> <span data-ttu-id="a481d-111">当为返回的源请求 JSON 格式时，不会返回自定义源。</span><span class="sxs-lookup"><span data-stu-id="a481d-111">Custom feeds are not returned when the JSON format is requested for the returned feed.</span></span>  
  
 <span data-ttu-id="a481d-112">使用 WCF 数据服务，可以通过手动将属性应用于数据模型中的实体类型，为 Atom 有效负载定义备用实体属性映射。</span><span class="sxs-lookup"><span data-stu-id="a481d-112">With WCF Data Services, you can define an alternate entity-property mapping for an Atom payload by manually applying attributes to entity types in the data model.</span></span> <span data-ttu-id="a481d-113">数据服务的数据源提供程序确定应当如何应用这些特性。</span><span class="sxs-lookup"><span data-stu-id="a481d-113">The data source provider of the data service determines how you should apply these attributes.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="a481d-114">定义自定义源时，必须保证已定义自定义映射的所有实体属性都包含在投影中。</span><span class="sxs-lookup"><span data-stu-id="a481d-114">When you define custom feeds, you must guarantee that all entity properties that have custom mappings defined are included in the projection.</span></span> <span data-ttu-id="a481d-115">如果投影中不包含某个已映射的实体属性，则可能会丢失数据。</span><span class="sxs-lookup"><span data-stu-id="a481d-115">When a mapped entity property is not included in the projection, data loss might occur.</span></span> <span data-ttu-id="a481d-116">有关详细信息，请参阅 [查询投影](query-projections-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="a481d-116">For more information, see [Query Projections](query-projections-wcf-data-services.md).</span></span>  
  
## <a name="customizing-feeds-with-the-entity-framework-provider"></a><span data-ttu-id="a481d-117">使用实体框架提供程序自定义源</span><span class="sxs-lookup"><span data-stu-id="a481d-117">Customizing Feeds with the Entity Framework Provider</span></span>  

 <span data-ttu-id="a481d-118">在 .edmx 文件中，用于实体框架提供程序的数据模型以 XML 格式表示。</span><span class="sxs-lookup"><span data-stu-id="a481d-118">The data model used with the Entity Framework provider is represented as XML in the .edmx file.</span></span> <span data-ttu-id="a481d-119">在这种情况下，用于定义自定义源的特性将会添加到表示数据模型中的实体类型和属性的 `EntityType` 和 `Property` 元素中。</span><span class="sxs-lookup"><span data-stu-id="a481d-119">In this case, the attributes that define custom feeds are added to the `EntityType` and `Property` elements that represent entity types and properties in the data model.</span></span> <span data-ttu-id="a481d-120">这些源自定义属性未定义为[ \[ MC-CSDL \] ：概念架构定义文件格式](/openspecs/windows_protocols/mc-csdl/c03ad8c3-e8b7-4306-af96-a9e52bb3df12)，这是实体框架提供程序用于定义数据模型的格式。</span><span class="sxs-lookup"><span data-stu-id="a481d-120">These feed customization attributes are not defined in [\[MC-CSDL\]: Conceptual Schema Definition File Format](/openspecs/windows_protocols/mc-csdl/c03ad8c3-e8b7-4306-af96-a9e52bb3df12), which is the format that the Entity Framework provider uses to define the data model.</span></span> <span data-ttu-id="a481d-121">因此，必须在某个特定的架构命名空间中声明源自定义特性，此架构命名空间应按 `m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"` 格式定义。</span><span class="sxs-lookup"><span data-stu-id="a481d-121">Therefore, you must declare feed customization attributes in a specific schema namespace, which is defined as `m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"`.</span></span> <span data-ttu-id="a481d-122">以下 XML 片段显示应用于 `Property` 实体类型的 `Products` 元素的源自定义特性，这些特性定义 `ProductName`、`ReorderLevel` 和 `UnitsInStock` 属性。</span><span class="sxs-lookup"><span data-stu-id="a481d-122">The following XML fragment shows feed customization attributes applied to `Property` elements of the `Products` entity type that define the `ProductName`, `ReorderLevel`, and `UnitsInStock` properties.</span></span>  
  
 [!code-xml[Astoria Custom Feeds#EdmFeedAttributes](../../../../samples/snippets/xml/VS_Snippets_Misc/astoria_custom_feeds/xml/northwind.csdl#edmfeedattributes)]  
  
 <span data-ttu-id="a481d-123">这些特性为 `Products` 实体集生成以下自定义数据源。</span><span class="sxs-lookup"><span data-stu-id="a481d-123">These attributes produce the following customized data feed for the `Products` entity set.</span></span> <span data-ttu-id="a481d-124">在自定义数据源中，`ProductName` 属性值同时显示在 `author` 元素以及 `ProductName` 属性元素中，`UnitsInStock` 属性显示在具有其自己的唯一命名空间并且其 `ReorderLevel` 属性作为特性的自定义元素中：</span><span class="sxs-lookup"><span data-stu-id="a481d-124">In the customized data feed, the `ProductName` property value is displayed in both in the `author` element and as the `ProductName` property element, and the `UnitsInStock` property is displayed in a custom element that has its own unique namespace and with the `ReorderLevel` property as an attribute:</span></span>  
  
 [!code-xml[Astoria Custom Feeds#EdmFeedResultProduct](../../../../samples/snippets/xml/VS_Snippets_Misc/astoria_custom_feeds/xml/edmfeedresult.xml#edmfeedresultproduct)]  
  
 <span data-ttu-id="a481d-125">有关详细信息，请参阅 [如何：利用实体框架提供程序自定义源](how-to-customize-feeds-with-ef-provider-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="a481d-125">For more information, see [How to: Customize Feeds with the Entity Framework Provider](how-to-customize-feeds-with-ef-provider-wcf-data-services.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="a481d-126">由于实体设计器不支持数据模型扩展，因此必须手动修改包含数据模型的 XML 文件。</span><span class="sxs-lookup"><span data-stu-id="a481d-126">Because extensions to the data model are not supported by the Entity Designer, you must manually modify the XML file that contains the data model.</span></span> <span data-ttu-id="a481d-127">有关实体数据模型工具生成的 .edmx 文件的详细信息，请参阅实体框架) 中的 [.Edmx 文件概述 (](/previous-versions/dotnet/netframework-4.0/cc982042(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="a481d-127">For more information about the .edmx file that is generated by the Entity Data Model tools, see [.edmx File Overview (Entity Framework)](/previous-versions/dotnet/netframework-4.0/cc982042(v=vs.100)).</span></span>  
  
### <a name="custom-feed-attributes"></a><span data-ttu-id="a481d-128">自定义源特性</span><span class="sxs-lookup"><span data-stu-id="a481d-128">Custom Feed Attributes</span></span>  

 <span data-ttu-id="a481d-129">下表列出了一些 XML 特性，这些特性自定义可添加到用于定义数据模型的概念架构定义语言 (CSDL) 的源。</span><span class="sxs-lookup"><span data-stu-id="a481d-129">The following table shows the XML attributes that customize feeds that you can add to the conceptual schema definition language (CSDL) that defines the data model.</span></span> <span data-ttu-id="a481d-130">这些特性等效于用于反射提供程序的 <xref:System.Data.Services.Common.EntityPropertyMappingAttribute> 的属性。</span><span class="sxs-lookup"><span data-stu-id="a481d-130">These attributes are equivalent to the properties of the <xref:System.Data.Services.Common.EntityPropertyMappingAttribute> used with the reflection provider.</span></span>  
  
|<span data-ttu-id="a481d-131">属性名称</span><span class="sxs-lookup"><span data-stu-id="a481d-131">Attribute name</span></span>|<span data-ttu-id="a481d-132">描述</span><span class="sxs-lookup"><span data-stu-id="a481d-132">Description</span></span>|  
|--------------------|-----------------|  
|`FC_ContentKind`|<span data-ttu-id="a481d-133">指示内容类型。</span><span class="sxs-lookup"><span data-stu-id="a481d-133">Indicates the type of the content.</span></span> <span data-ttu-id="a481d-134">以下关键字定义联合内容类型。</span><span class="sxs-lookup"><span data-stu-id="a481d-134">The following keywords define syndication content types.</span></span><br /><br /> <span data-ttu-id="a481d-135">`text:` 属性值在源中显示为文本。</span><span class="sxs-lookup"><span data-stu-id="a481d-135">`text:` The property value is displayed in the feed as text.</span></span><br /><br /> <span data-ttu-id="a481d-136">`html:` 属性值在源中显示为 HTML。</span><span class="sxs-lookup"><span data-stu-id="a481d-136">`html:` The property value is displayed in the feed as HTML.</span></span><br /><br /> <span data-ttu-id="a481d-137">`xhtml:` 属性值在源中显示为 XML 格式的 HTML。</span><span class="sxs-lookup"><span data-stu-id="a481d-137">`xhtml:` The property value is displayed in the feed as XML-formatted HTML.</span></span><br /><br /> <span data-ttu-id="a481d-138">这些关键字等效于用于反射提供程序的 <xref:System.Data.Services.Common.SyndicationTextContentKind> 枚举的值。</span><span class="sxs-lookup"><span data-stu-id="a481d-138">These keywords are equivalent to the values of the <xref:System.Data.Services.Common.SyndicationTextContentKind> enumeration used with the reflection provider.</span></span><br /><br /> <span data-ttu-id="a481d-139">如果使用了 `FC_NsPrefix` 和 `FC_NsUri` 特性，则不支持此特性。</span><span class="sxs-lookup"><span data-stu-id="a481d-139">This attribute is not supported when the `FC_NsPrefix` and `FC_NsUri` attributes are used.</span></span><br /><br /> <span data-ttu-id="a481d-140">为 `xhtml` 特性指定值 `FC_ContentKind` 时，必须确保该属性值包含格式正确的 XML。</span><span class="sxs-lookup"><span data-stu-id="a481d-140">When you specify a value of `xhtml` for the `FC_ContentKind` attribute, you must ensure that the property value contains properly formatted XML.</span></span> <span data-ttu-id="a481d-141">数据服务返回值，但不执行任何转换。</span><span class="sxs-lookup"><span data-stu-id="a481d-141">The data service returns the value without performing any transformations.</span></span> <span data-ttu-id="a481d-142">还必须确保返回的 XML 中任何 XML 元素前缀在映射的源中定义了命名空间 URI 和前缀。</span><span class="sxs-lookup"><span data-stu-id="a481d-142">You must also ensure that any XML element prefixes in the returned XML have a namespace URI and prefix defined in the mapped feed.</span></span>|  
|`FC_KeepInContent`|<span data-ttu-id="a481d-143">指示是否应将引用的属性值包含到源的内容部分和映射的位置中。</span><span class="sxs-lookup"><span data-stu-id="a481d-143">Indicates that the referenced property value should be included both in the content section of the feed and in the mapped location.</span></span> <span data-ttu-id="a481d-144">有效值为 `true` 和 `false`。</span><span class="sxs-lookup"><span data-stu-id="a481d-144">Valid values are `true` and `false`.</span></span> <span data-ttu-id="a481d-145">若要使结果源与 WCF 数据服务早期版本向后兼容，请将值指定 `true` 为以确保该值包含在源的内容部分中。</span><span class="sxs-lookup"><span data-stu-id="a481d-145">To make the resulting feed backward-compatible with earlier versions of WCF Data Services, specify a value of `true` to make sure that the value is included in the content section of the feed.</span></span>|  
|`FC_NsPrefix`|<span data-ttu-id="a481d-146">非联合映射中的 XML 元素的命名空间前缀。</span><span class="sxs-lookup"><span data-stu-id="a481d-146">The namespace prefix of the XML element in a non-syndication mapping.</span></span> <span data-ttu-id="a481d-147">此特性必须与 `FC_NsUri` 特性一起使用，但不能与 `FC_ContentKind` 特性一起使用。</span><span class="sxs-lookup"><span data-stu-id="a481d-147">This attribute must be used with the `FC_NsUri` attribute and cannot be used with the `FC_ContentKind` attribute.</span></span>|  
|`FC_NsUri`|<span data-ttu-id="a481d-148">非联合映射中的 XML 元素的命名空间 URI。</span><span class="sxs-lookup"><span data-stu-id="a481d-148">The namespace URI of the XML element in a non-syndication mapping.</span></span> <span data-ttu-id="a481d-149">此特性必须与 `FC_NsPrefix` 特性一起使用，但不能与 `FC_ContentKind` 特性一起使用。</span><span class="sxs-lookup"><span data-stu-id="a481d-149">This attribute must be used with the `FC_NsPrefix` attribute and cannot be used with the `FC_ContentKind` attribute.</span></span>|  
|`FC_SourcePath`|<span data-ttu-id="a481d-150">应用此源映射规则的实体属性的路径。</span><span class="sxs-lookup"><span data-stu-id="a481d-150">The path of the property of the entity to which this feed mapping rule applies.</span></span> <span data-ttu-id="a481d-151">仅当在 `EntityType` 元素中使用时，才支持此特性。</span><span class="sxs-lookup"><span data-stu-id="a481d-151">This attribute is only supported when it is used in an `EntityType` element.</span></span><br /><br /> <span data-ttu-id="a481d-152"><xref:System.Data.Services.Common.EntityPropertyMappingAttribute.SourcePath%2A> 属性无法直接引用复杂类型。</span><span class="sxs-lookup"><span data-stu-id="a481d-152">The <xref:System.Data.Services.Common.EntityPropertyMappingAttribute.SourcePath%2A> property cannot directly reference a complex type.</span></span> <span data-ttu-id="a481d-153">对于复杂类型，必须使用路径表达式，在此路径表达式中，使用反斜杠 (`/`) 字符分隔属性名称。</span><span class="sxs-lookup"><span data-stu-id="a481d-153">For complex types, you must use a path expression where property names are separated by a backslash (`/`) character.</span></span> <span data-ttu-id="a481d-154">例如，对于 `Person` 具有整数属性 `Age` 和复杂属性的实体类型，允许使用以下值：</span><span class="sxs-lookup"><span data-stu-id="a481d-154">For example, the following values are allowed for an entity type `Person` with an integer property `Age` and a complex property</span></span><br /><br /> <span data-ttu-id="a481d-155">`Address`:</span><span class="sxs-lookup"><span data-stu-id="a481d-155">`Address`:</span></span><br /><br /> `Age`<br /><br /> `Address/Street`<br /><br /> <span data-ttu-id="a481d-156">不能将 <xref:System.Data.Services.Common.EntityPropertyMappingAttribute.SourcePath%2A> 属性设置为包含空格或在属性名称中无效的任何其他字符的值。</span><span class="sxs-lookup"><span data-stu-id="a481d-156">The <xref:System.Data.Services.Common.EntityPropertyMappingAttribute.SourcePath%2A> property cannot be set to a value that contains a space or any other character that is not valid in a property name.</span></span>|  
|`FC_TargetPath`|<span data-ttu-id="a481d-157">属性将映射到的结果源中的目标元素的名称。</span><span class="sxs-lookup"><span data-stu-id="a481d-157">The name of the target element of the resulting feed to map the property.</span></span> <span data-ttu-id="a481d-158">此元素可以是按 Atom 规范定义的元素，也可以是自定义元素。</span><span class="sxs-lookup"><span data-stu-id="a481d-158">This element can be an element defined by the Atom specification or a custom element.</span></span><br /><br /> <span data-ttu-id="a481d-159">以下关键字是指向 OData 源中特定位置的预定义联合目标路径值。</span><span class="sxs-lookup"><span data-stu-id="a481d-159">The following keywords are predefined syndication target-path values that point to specific location in an OData feed.</span></span><br /><br /> <span data-ttu-id="a481d-160">`SyndicationAuthorEmail:``atom:email`元素的子元素 `atom:author` 。</span><span class="sxs-lookup"><span data-stu-id="a481d-160">`SyndicationAuthorEmail:` The `atom:email` child element of the `atom:author` element.</span></span><br /><br /> <span data-ttu-id="a481d-161">`SyndicationAuthorName:``atom:name`元素的子元素 `atom:author` 。</span><span class="sxs-lookup"><span data-stu-id="a481d-161">`SyndicationAuthorName:` The `atom:name` child element of the `atom:author` element.</span></span><br /><br /> <span data-ttu-id="a481d-162">`SyndicationAuthorUri:``atom:uri`元素的子元素 `atom:author` 。</span><span class="sxs-lookup"><span data-stu-id="a481d-162">`SyndicationAuthorUri:` The `atom:uri` child element of the `atom:author` element.</span></span><br /><br /> <span data-ttu-id="a481d-163">`SyndicationContributorEmail:``atom:email`元素的子元素 `atom:contributor` 。</span><span class="sxs-lookup"><span data-stu-id="a481d-163">`SyndicationContributorEmail:` The `atom:email` child element of the `atom:contributor` element.</span></span><br /><br /> <span data-ttu-id="a481d-164">`SyndicationContributorName:``atom:name`元素的子元素 `atom:contributor` 。</span><span class="sxs-lookup"><span data-stu-id="a481d-164">`SyndicationContributorName:` The `atom:name` child element of the `atom:contributor` element.</span></span><br /><br /> <span data-ttu-id="a481d-165">`SyndicationContributorUri:``atom:uri`元素的子元素 `atom:contributor` 。</span><span class="sxs-lookup"><span data-stu-id="a481d-165">`SyndicationContributorUri:` The `atom:uri` child element of the `atom:contributor` element.</span></span><br /><br /> <span data-ttu-id="a481d-166">`SyndicationCustomProperty:` 自定义属性元素。</span><span class="sxs-lookup"><span data-stu-id="a481d-166">`SyndicationCustomProperty:` A custom property element.</span></span> <span data-ttu-id="a481d-167">映射到自定义元素时，目标必须是路径表达式，在此路径表达式中，使用反斜杠 (`/`) 分隔嵌套元素，并使用 `@` 指定特性。</span><span class="sxs-lookup"><span data-stu-id="a481d-167">When mapping to a custom element, the target must be a path expression in which nested elements are separated by a backslash (`/`) and attributes are specified by an ampersand (`@`).</span></span> <span data-ttu-id="a481d-168">在以下示例中，字符串 `UnitsInStock/@ReorderLevel` 将属性值映射到根项元素的 `ReorderLevel` 子元素上的 `UnitsInStock` 特性。</span><span class="sxs-lookup"><span data-stu-id="a481d-168">In the following example, the string `UnitsInStock/@ReorderLevel` maps a property value to an attribute named `ReorderLevel` on a child element named `UnitsInStock` of the root entry element.</span></span><br /><br /> `<Property Name="ReorderLevel" Type="Int16"               m:FC_TargetPath="UnitsInStock/@ReorderLevel"               m:FC_NsPrefix="Northwind"               m:FC_NsUri="http://schemas.examples.microsoft.com/dataservices"               m:FC_KeepInContent="false"               />`<br /><br /> <span data-ttu-id="a481d-169">如果目标是自定义元素名称，还必须指定 `FC_NsPrefix` 和 `FC_NsUri` 特性。</span><span class="sxs-lookup"><span data-stu-id="a481d-169">When the target is a custom element name, the `FC_NsPrefix` and `FC_NsUri` attributes must also be specified.</span></span><br /><br /> <span data-ttu-id="a481d-170">`SyndicationPublished:``atom:published`元素。</span><span class="sxs-lookup"><span data-stu-id="a481d-170">`SyndicationPublished:` The `atom:published` element.</span></span><br /><br /> <span data-ttu-id="a481d-171">`SyndicationRights:``atom:rights`元素。</span><span class="sxs-lookup"><span data-stu-id="a481d-171">`SyndicationRights:` The `atom:rights` element.</span></span><br /><br /> <span data-ttu-id="a481d-172">`SyndicationSummary:``atom:summary`元素。</span><span class="sxs-lookup"><span data-stu-id="a481d-172">`SyndicationSummary:` The `atom:summary` element.</span></span><br /><br /> <span data-ttu-id="a481d-173">`SyndicationTitle:``atom:title`元素。</span><span class="sxs-lookup"><span data-stu-id="a481d-173">`SyndicationTitle:` The `atom:title` element.</span></span><br /><br /> <span data-ttu-id="a481d-174">`SyndicationUpdated:``atom:updated`元素。</span><span class="sxs-lookup"><span data-stu-id="a481d-174">`SyndicationUpdated:` The `atom:updated` element.</span></span><br /><br /> <span data-ttu-id="a481d-175">这些关键字等效于用于反射提供程序的 <xref:System.Data.Services.Common.SyndicationItemProperty> 枚举的值。</span><span class="sxs-lookup"><span data-stu-id="a481d-175">These keywords are equivalent to the values of the <xref:System.Data.Services.Common.SyndicationItemProperty> enumeration used with the reflection provider.</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="a481d-176">特性名称和值是区分大小写的。</span><span class="sxs-lookup"><span data-stu-id="a481d-176">Attribute names and values are case-sensitive.</span></span> <span data-ttu-id="a481d-177">特性可以应用于 `EntityType` 元素，也可以应用于一个或多个 `Property` 元素，但不能同时应用于二者。</span><span class="sxs-lookup"><span data-stu-id="a481d-177">Attributes can be applied either to the `EntityType` element or to one or more `Property` elements, but not to both.</span></span>  
  
## <a name="customizing-feeds-with-the-reflection-provider"></a><span data-ttu-id="a481d-178">使用反射提供程序自定义源</span><span class="sxs-lookup"><span data-stu-id="a481d-178">Customizing Feeds with the Reflection Provider</span></span>  

 <span data-ttu-id="a481d-179">若要为使用反射提供程序实现的数据模型自定义源，请将 <xref:System.Data.Services.Common.EntityPropertyMappingAttribute> 特性的一个或多个实例添加到表示数据模型中的实体类型的类中。</span><span class="sxs-lookup"><span data-stu-id="a481d-179">To customize feeds for a data model that was implemented by using the reflection provider, add one or more instances of the <xref:System.Data.Services.Common.EntityPropertyMappingAttribute> attribute to the classes that represent entity types in the data model.</span></span> <span data-ttu-id="a481d-180"><xref:System.Data.Services.Common.EntityPropertyMappingAttribute> 类的属性对应于在上一节中介绍的源自定义特性。</span><span class="sxs-lookup"><span data-stu-id="a481d-180">The properties of the <xref:System.Data.Services.Common.EntityPropertyMappingAttribute> class correspond to the feed customization attributes that are described in the previous section.</span></span> <span data-ttu-id="a481d-181">以下是 `Order` 类型的声明示例，该示例为两个属性定义了自定义源映射。</span><span class="sxs-lookup"><span data-stu-id="a481d-181">The following is an example of the declaration of the `Order` type, with custom feed mapping defined for both properties.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="a481d-182">主题 [如何：使用反射提供程序创建数据服务](create-a-data-service-using-rp-wcf-data-services.md)中定义了此示例的数据模型。</span><span class="sxs-lookup"><span data-stu-id="a481d-182">The data model for this example is defined in the topic [How to: Create a Data Service Using the Reflection Provider](create-a-data-service-using-rp-wcf-data-services.md).</span></span>  
  
 [!code-csharp[Astoria Custom Feeds#CustomOrderFeed](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_custom_feeds/cs/orderitems.svc.cs#customorderfeed)]
 [!code-vb[Astoria Custom Feeds#CustomOrderFeed](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_custom_feeds/vb/orderitems.svc.vb#customorderfeed)]  
  
 <span data-ttu-id="a481d-183">这些特性为 `Orders` 实体集生成以下自定义数据源。</span><span class="sxs-lookup"><span data-stu-id="a481d-183">These attributes produce the following customized data feed for the `Orders` entity set.</span></span> <span data-ttu-id="a481d-184">在此自定义源中， `OrderId` 属性值仅显示在 `title` 的元素中， `entry` `Customer` 属性值同时显示在 `author` 元素和 `Customer` 属性元素中：</span><span class="sxs-lookup"><span data-stu-id="a481d-184">In this customized feed, the `OrderId` property value displays only in the `title` element of the `entry` and the `Customer` property value displays both in the `author` element and as the `Customer` property element:</span></span>  
  
 [!code-xml[Astoria Custom Feeds#IQueryableFeedResult](../../../../samples/snippets/xml/VS_Snippets_Misc/astoria_custom_feeds/xml/iqueryablefeedresult.xml#iqueryablefeedresult)]  
  
 <span data-ttu-id="a481d-185">有关详细信息，请参阅 [如何：用反射提供程序自定义源](how-to-customize-feeds-with-the-reflection-provider-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="a481d-185">For more information, see [How to: Customize Feeds with the Reflection Provider](how-to-customize-feeds-with-the-reflection-provider-wcf-data-services.md).</span></span>  
  
## <a name="customizing-feeds-with-a-custom-data-service-provider"></a><span data-ttu-id="a481d-186">使用自定义数据服务提供程序自定义源</span><span class="sxs-lookup"><span data-stu-id="a481d-186">Customizing Feeds with a Custom Data Service Provider</span></span>  

 <span data-ttu-id="a481d-187">通过对表示数据模型中实体类型的 <xref:System.Data.Services.Providers.ResourceType.AddEntityPropertyMappingAttribute%2A> 调用 <xref:System.Data.Services.Providers.ResourceType>，可以为资源类型定义通过使用自定义数据服务提供程序定义的数据模型的源自定义。</span><span class="sxs-lookup"><span data-stu-id="a481d-187">Feed customization for a data model defined by using a custom data service provider is defined for a resource type by calling the <xref:System.Data.Services.Providers.ResourceType.AddEntityPropertyMappingAttribute%2A> on the <xref:System.Data.Services.Providers.ResourceType> that represents an entity type in the data model.</span></span> <span data-ttu-id="a481d-188">有关详细信息，请参阅 [自定义数据服务提供程序](custom-data-service-providers-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="a481d-188">For more information, see [Custom Data Service Providers](custom-data-service-providers-wcf-data-services.md).</span></span>  
  
## <a name="consuming-custom-feeds"></a><span data-ttu-id="a481d-189">使用自定义源</span><span class="sxs-lookup"><span data-stu-id="a481d-189">Consuming Custom Feeds</span></span>  

 <span data-ttu-id="a481d-190">当应用程序直接使用 OData 源时，它必须能够处理返回的源中的任何自定义元素和特性。</span><span class="sxs-lookup"><span data-stu-id="a481d-190">When your application directly consumes an OData feed, it must be able to process any customized elements and attributes in the returned feed.</span></span> <span data-ttu-id="a481d-191">如果已在数据模型中实现自定义源，不管数据服务提供程序如何，`$metadata` 终结点都会返回自定义源信息，并作为数据服务返回的 CSDL 中的自定义源特性。</span><span class="sxs-lookup"><span data-stu-id="a481d-191">When you have implemented custom feeds in your data model, regardless of the data service provider, the `$metadata` endpoint returns custom feed information as custom feed attributes in the CSDL returned by the data service.</span></span> <span data-ttu-id="a481d-192">使用 **添加服务引用** 对话框或 [datasvcutil.exe](wcf-data-service-client-utility-datasvcutil-exe.md) 工具生成客户端数据服务类时，将使用自定义的源属性来保证正确处理对数据服务的请求和响应。</span><span class="sxs-lookup"><span data-stu-id="a481d-192">When you use the **Add Service Reference** dialog or the [datasvcutil.exe](wcf-data-service-client-utility-datasvcutil-exe.md) tool to generate client data service classes, the customized feed attributes are used to guarantee that requests and responses to the data service are handled correctly.</span></span>  
  
## <a name="feed-customization-considerations"></a><span data-ttu-id="a481d-193">源自定义注意事项</span><span class="sxs-lookup"><span data-stu-id="a481d-193">Feed Customization Considerations</span></span>  

 <span data-ttu-id="a481d-194">定义自定义源映射时，应考虑下列事项。</span><span class="sxs-lookup"><span data-stu-id="a481d-194">You should consider the following when defining custom feed mappings.</span></span>  
  
- <span data-ttu-id="a481d-195">当源中的映射元素仅包含空白时，WCF 数据服务客户端将源中的映射元素视为空。</span><span class="sxs-lookup"><span data-stu-id="a481d-195">The WCF Data Services client treats mapped elements in a feed as empty when they contain only white space.</span></span> <span data-ttu-id="a481d-196">因此，仅包含空白的映射元素在具有相同空白的客户端上不具体化。</span><span class="sxs-lookup"><span data-stu-id="a481d-196">Because of this, mapped elements that contain only white space are not materialized on the client with the same white space.</span></span> <span data-ttu-id="a481d-197">若要在客户端上保留此空格，必须 `KeepInContext` `true` 在 "源映射" 属性中将的值设置为。</span><span class="sxs-lookup"><span data-stu-id="a481d-197">To preserve this white space on the client, you must set the value of `KeepInContext` to `true` in the feed mapping attribute.</span></span>  
  
## <a name="versioning-requirements"></a><span data-ttu-id="a481d-198">版本控制要求</span><span class="sxs-lookup"><span data-stu-id="a481d-198">Versioning Requirements</span></span>  

 <span data-ttu-id="a481d-199">源自定义具有以下 OData 协议版本要求：</span><span class="sxs-lookup"><span data-stu-id="a481d-199">Feed customization has the following OData protocol versioning requirements:</span></span>  
  
- <span data-ttu-id="a481d-200">源自定义要求客户端和数据服务都支持 OData 协议版本2.0 和更高版本。</span><span class="sxs-lookup"><span data-stu-id="a481d-200">Feed customization requires that both the client and data service support version 2.0 of the OData protocol and later versions.</span></span>  
  
 <span data-ttu-id="a481d-201">有关详细信息，请参阅 [数据服务版本控制](data-service-versioning-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="a481d-201">For more information, see [Data Service Versioning](data-service-versioning-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a481d-202">请参阅</span><span class="sxs-lookup"><span data-stu-id="a481d-202">See also</span></span>

- [<span data-ttu-id="a481d-203">反射提供程序</span><span class="sxs-lookup"><span data-stu-id="a481d-203">Reflection Provider</span></span>](reflection-provider-wcf-data-services.md)
- [<span data-ttu-id="a481d-204">实体框架提供程序</span><span class="sxs-lookup"><span data-stu-id="a481d-204">Entity Framework Provider</span></span>](entity-framework-provider-wcf-data-services.md)
