---
title: 获取 UI 自动化元素
description: 查看为用户界面（UI）元素获取 UI 自动化元素（AutomationElement）对象的各种方法。
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, obtaining elements
- elements, UI Automation, obtaining
ms.assetid: c2caaf45-e59c-42a1-bc9b-77a6de520171
ms.openlocfilehash: 2b741dde3b30334ba8fa990d73044da7e3bdd2da
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/24/2020
ms.locfileid: "87168159"
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="2bc58-103">获取 UI 自动化元素</span><span class="sxs-lookup"><span data-stu-id="2bc58-103">Obtaining UI Automation Elements</span></span>
> [!NOTE]
> <span data-ttu-id="2bc58-104">本文档适用于想要使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 命名空间中定义的托管 <xref:System.Windows.Automation> 类的 .NET Framework 开发人员。</span><span class="sxs-lookup"><span data-stu-id="2bc58-104">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="2bc58-105">有关 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]的最新信息，请参阅 [Windows 自动化 API：UI 自动化](/windows/win32/winauto/entry-uiauto-win32)。</span><span class="sxs-lookup"><span data-stu-id="2bc58-105">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>  
  
 <span data-ttu-id="2bc58-106">本主题描述获取 <xref:System.Windows.Automation.AutomationElement> 元素的 [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] 对象的各种方法。</span><span class="sxs-lookup"><span data-stu-id="2bc58-106">This topic describes the various ways of obtaining <xref:System.Windows.Automation.AutomationElement> objects for [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] elements.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="2bc58-107">如果客户端应用程序可以尝试在其自己的用户界面中查找元素，则必须在一个单独的线程上进行所有 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 调用。</span><span class="sxs-lookup"><span data-stu-id="2bc58-107">If your client application might attempt to find elements in its own user interface, you must make all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls on a separate thread.</span></span> <span data-ttu-id="2bc58-108">有关更多信息，请参见 [UI Automation Threading Issues](ui-automation-threading-issues.md)。</span><span class="sxs-lookup"><span data-stu-id="2bc58-108">For more information, see [UI Automation Threading Issues](ui-automation-threading-issues.md).</span></span>  
  
<a name="The_Root_Element"></a>
## <a name="root-element"></a><span data-ttu-id="2bc58-109">Root 元素</span><span class="sxs-lookup"><span data-stu-id="2bc58-109">Root Element</span></span>  
 <span data-ttu-id="2bc58-110">所有 <xref:System.Windows.Automation.AutomationElement> 对象搜索都必须具有一个起点。</span><span class="sxs-lookup"><span data-stu-id="2bc58-110">All searches for <xref:System.Windows.Automation.AutomationElement> objects must have a starting-place.</span></span> <span data-ttu-id="2bc58-111">此起点可以是任何元素，包括桌面、应用程序窗口或控件。</span><span class="sxs-lookup"><span data-stu-id="2bc58-111">This can be any element, including the desktop, an application window, or a control.</span></span>  
  
 <span data-ttu-id="2bc58-112">所有元素所起源于的桌面根元素是从静态的 <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=nameWithType> 属性中获取的。</span><span class="sxs-lookup"><span data-stu-id="2bc58-112">The root element for the desktop, from which all elements are descended, is obtained from the static <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=nameWithType> property.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="2bc58-113">通常，你应当尝试只获取 <xref:System.Windows.Automation.AutomationElement.RootElement%2A>的直接子项。</span><span class="sxs-lookup"><span data-stu-id="2bc58-113">In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span></span> <span data-ttu-id="2bc58-114">对后代的搜索可能循环访问数百个甚至数千个元素，这可能导致堆栈溢出。</span><span class="sxs-lookup"><span data-stu-id="2bc58-114">A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow.</span></span> <span data-ttu-id="2bc58-115">如果尝试在较低级别上获取特定元素，应该从应用程序窗口或者从较低级别的容器中开始搜索。</span><span class="sxs-lookup"><span data-stu-id="2bc58-115">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>  
  
<a name="Using_Conditions"></a>
## <a name="conditions"></a><span data-ttu-id="2bc58-116">条件</span><span class="sxs-lookup"><span data-stu-id="2bc58-116">Conditions</span></span>  
 <span data-ttu-id="2bc58-117">对于用于检索 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 元素的大多数方法，必须指定一个 <xref:System.Windows.Automation.Condition>，这是一组用于定义要检索的元素的条件。</span><span class="sxs-lookup"><span data-stu-id="2bc58-117">For most techniques you can use to retrieve [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements, you must specify a <xref:System.Windows.Automation.Condition>, which is a set of criteria defining what elements you want to retrieve.</span></span>  
  
 <span data-ttu-id="2bc58-118">最简单的条件是 <xref:System.Windows.Automation.Condition.TrueCondition>，这是一个指定要返回搜索范围内的所有元素的预定义对象。</span><span class="sxs-lookup"><span data-stu-id="2bc58-118">The simplest condition is <xref:System.Windows.Automation.Condition.TrueCondition>, a predefined object specifying that all elements within the search scope are to be returned.</span></span> <span data-ttu-id="2bc58-119"><xref:System.Windows.Automation.Condition.FalseCondition>是 <xref:System.Windows.Automation.Condition.TrueCondition>的对立条件，其作用不大，因为它将阻止找到任何元素。</span><span class="sxs-lookup"><span data-stu-id="2bc58-119"><xref:System.Windows.Automation.Condition.FalseCondition>, the converse of <xref:System.Windows.Automation.Condition.TrueCondition>, is less useful, as it would prevent any elements from being found.</span></span>  
  
 <span data-ttu-id="2bc58-120">下面是三个其他的预定义条件，这些条件既可以单独使用，也可以与其他条件一起使用： <xref:System.Windows.Automation.Automation.ContentViewCondition>、 <xref:System.Windows.Automation.Automation.ControlViewCondition>和 <xref:System.Windows.Automation.Automation.RawViewCondition>。</span><span class="sxs-lookup"><span data-stu-id="2bc58-120">Three other predefined conditions can be used alone or in combination with other conditions: <xref:System.Windows.Automation.Automation.ContentViewCondition>, <xref:System.Windows.Automation.Automation.ControlViewCondition>, and <xref:System.Windows.Automation.Automation.RawViewCondition>.</span></span> <span data-ttu-id="2bc58-121">单独使用的等效于 ，因为它不根据元素的  或  属性来筛选元素。</span><span class="sxs-lookup"><span data-stu-id="2bc58-121"><xref:System.Windows.Automation.Automation.RawViewCondition>, used by itself, is equivalent to <xref:System.Windows.Automation.Condition.TrueCondition>, because it does not filter elements by their <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> or <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> properties.</span></span>  
  
 <span data-ttu-id="2bc58-122">其他条件是根据一个或多个 <xref:System.Windows.Automation.PropertyCondition> 对象（每个对象都指定一个属性值）建立的。</span><span class="sxs-lookup"><span data-stu-id="2bc58-122">Other conditions are built up from one or more <xref:System.Windows.Automation.PropertyCondition> objects, each of which specifies a property value.</span></span> <span data-ttu-id="2bc58-123">例如，个 <xref:System.Windows.Automation.PropertyCondition> 可以指定元素处于启用状态或元素支持某种控件模式。</span><span class="sxs-lookup"><span data-stu-id="2bc58-123">For example, a <xref:System.Windows.Automation.PropertyCondition> might specify that the element is enabled, or that it supports a certain control pattern.</span></span>  
  
 <span data-ttu-id="2bc58-124">通过构造 <xref:System.Windows.Automation.AndCondition>、 <xref:System.Windows.Automation.OrCondition>和 <xref:System.Windows.Automation.NotCondition>类型的对象，可以用布尔逻辑将条件结合起来。</span><span class="sxs-lookup"><span data-stu-id="2bc58-124">Conditions can be combined using Boolean logic by constructing objects of types <xref:System.Windows.Automation.AndCondition>, <xref:System.Windows.Automation.OrCondition>, and <xref:System.Windows.Automation.NotCondition>.</span></span>  
  
<a name="Search_Scope"></a>
## <a name="search-scope"></a><span data-ttu-id="2bc58-125">搜索范围</span><span class="sxs-lookup"><span data-stu-id="2bc58-125">Search Scope</span></span>  
 <span data-ttu-id="2bc58-126">用 <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> 或 <xref:System.Windows.Automation.AutomationElement.FindAll%2A> 执行的搜索必须具有一个范围和一个起点。</span><span class="sxs-lookup"><span data-stu-id="2bc58-126">Searches done by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A> must have a scope as well as a starting-place.</span></span>  
  
 <span data-ttu-id="2bc58-127">范围定义了要搜索的起点周围的空间。</span><span class="sxs-lookup"><span data-stu-id="2bc58-127">The scope defines the space around the starting-place that is to be searched.</span></span> <span data-ttu-id="2bc58-128">这可以包括元素本身、其同级项、父项、上级、直接子项以及后代。</span><span class="sxs-lookup"><span data-stu-id="2bc58-128">This might include the element itself, its siblings, its parent, its ancestors, its immediate children, and its descendants.</span></span>  
  
 <span data-ttu-id="2bc58-129">搜索范围由按位组合的 <xref:System.Windows.Automation.TreeScope> 枚举值来定义。</span><span class="sxs-lookup"><span data-stu-id="2bc58-129">The scope of a search is defined by a bitwise combination of values from the <xref:System.Windows.Automation.TreeScope> enumeration.</span></span>  
  
<a name="Finding_a_Known_Element"></a>
## <a name="finding-a-known-element"></a><span data-ttu-id="2bc58-130">查找已知元素</span><span class="sxs-lookup"><span data-stu-id="2bc58-130">Finding a Known Element</span></span>  
 <span data-ttu-id="2bc58-131">若要查找由已知元素的 <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>、 <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>或者某些其他属性或属性组合标识的已知元素，最简单的方法是使用 <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="2bc58-131">To find a known element, identified by its <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>, or some other property or combination of properties, it is easiest to use the <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> method.</span></span> <span data-ttu-id="2bc58-132">如果查找的元素是一个应用程序窗口，则搜索的起点可以是 <xref:System.Windows.Automation.AutomationElement.RootElement%2A>。</span><span class="sxs-lookup"><span data-stu-id="2bc58-132">If the element sought is an application window, the starting-point of the search can be the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span></span>  
  
 <span data-ttu-id="2bc58-133">这种查找 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 元素的方法在自动化测试方案中最有用。</span><span class="sxs-lookup"><span data-stu-id="2bc58-133">This way of finding [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements is most useful in automated testing scenarios.</span></span>  
  
<a name="Finding_Elements_in_a_Subtree"></a>
## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="2bc58-134">查找子树中的元素</span><span class="sxs-lookup"><span data-stu-id="2bc58-134">Finding Elements in a Subtree</span></span>  
 <span data-ttu-id="2bc58-135">若要查找与已知元素有关且满足特定条件的所有元素，可以使用 <xref:System.Windows.Automation.AutomationElement.FindAll%2A>。</span><span class="sxs-lookup"><span data-stu-id="2bc58-135">To find all elements meeting specific criteria that are related to a known element, you can use <xref:System.Windows.Automation.AutomationElement.FindAll%2A>.</span></span> <span data-ttu-id="2bc58-136">例如，可以使用这种方法从列表或菜单中检索列表项或菜单项，或找出对话框中的所有控件。</span><span class="sxs-lookup"><span data-stu-id="2bc58-136">For example, you could use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>  
  
<a name="Walking_a_Subtree"></a>
## <a name="walking-a-subtree"></a><span data-ttu-id="2bc58-137">浏览子树</span><span class="sxs-lookup"><span data-stu-id="2bc58-137">Walking a Subtree</span></span>  
 <span data-ttu-id="2bc58-138">如果你事先不了解可与客户端一起使用的应用程序，则可以使用 <xref:System.Windows.Automation.TreeWalker> 类构造一个包含所有相关元素的子树。</span><span class="sxs-lookup"><span data-stu-id="2bc58-138">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using the <xref:System.Windows.Automation.TreeWalker> class.</span></span> <span data-ttu-id="2bc58-139">你的应用程序可能会执行此操作以响应焦点更改事件；也就是说，在应用程序或控件接收输入焦点时，UI 自动化客户端将检查子项，可能还会检查有焦点的元素的所有后代。</span><span class="sxs-lookup"><span data-stu-id="2bc58-139">Your application might do this in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>  
  
 <span data-ttu-id="2bc58-140">使用 <xref:System.Windows.Automation.TreeWalker> 的另一种方法是识别元素的上级。</span><span class="sxs-lookup"><span data-stu-id="2bc58-140">Another way in which <xref:System.Windows.Automation.TreeWalker> can be used is to identify the ancestors of an element.</span></span> <span data-ttu-id="2bc58-141">例如，通过向上浏览树，你可以识别控件的父窗口。</span><span class="sxs-lookup"><span data-stu-id="2bc58-141">For example, by walking up the tree you can identify the parent window of a control.</span></span>  
  
 <span data-ttu-id="2bc58-142">通过创建类的对象（通过传递 <xref:System.Windows.Automation.TreeWalker> 来定义相关元素），或者使用以下定义为 <xref:System.Windows.Automation.Condition>的字段的预定义对象之一，你可以使用 <xref:System.Windows.Automation.TreeWalker>。</span><span class="sxs-lookup"><span data-stu-id="2bc58-142">You can use <xref:System.Windows.Automation.TreeWalker> either by creating an object of the class (defining the elements of interest by passing a <xref:System.Windows.Automation.Condition>), or by using one of the following predefined objects that are defined as fields of <xref:System.Windows.Automation.TreeWalker>.</span></span>  
  
|||  
|-|-|  
|<xref:System.Windows.Automation.TreeWalker.ContentViewWalker>|<span data-ttu-id="2bc58-143">仅查找 <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> 属性为 `true`的元素。</span><span class="sxs-lookup"><span data-stu-id="2bc58-143">Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Automation.TreeWalker.ControlViewWalker>|<span data-ttu-id="2bc58-144">仅查找 <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> 属性为 `true`的元素。</span><span class="sxs-lookup"><span data-stu-id="2bc58-144">Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Automation.TreeWalker.RawViewWalker>|<span data-ttu-id="2bc58-145">查找所有元素。</span><span class="sxs-lookup"><span data-stu-id="2bc58-145">Finds all elements.</span></span>|  
  
 <span data-ttu-id="2bc58-146">在获得 <xref:System.Windows.Automation.TreeWalker>之后，可以直接使用它。</span><span class="sxs-lookup"><span data-stu-id="2bc58-146">After you have obtained a <xref:System.Windows.Automation.TreeWalker>, using it is straightforward.</span></span> <span data-ttu-id="2bc58-147">只需调用 `Get` 方法便可在子树的元素中导航。</span><span class="sxs-lookup"><span data-stu-id="2bc58-147">Simply call the `Get` methods to navigate among elements of the subtree.</span></span>  
  
 <span data-ttu-id="2bc58-148"><xref:System.Windows.Automation.TreeWalker.Normalize%2A> 方法可用于从视图外的另一元素导航到子树中的某个元素。</span><span class="sxs-lookup"><span data-stu-id="2bc58-148">The <xref:System.Windows.Automation.TreeWalker.Normalize%2A> method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="2bc58-149">例如，假设你已使用 <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>创建了一个子树视图。</span><span class="sxs-lookup"><span data-stu-id="2bc58-149">For example, suppose you have created a view of a subtree by using <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>.</span></span> <span data-ttu-id="2bc58-150">然后，你的应用程序收到通知，得知滚动条已经接收了输入焦点。</span><span class="sxs-lookup"><span data-stu-id="2bc58-150">Your application then receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="2bc58-151">因为滚动条不是内容元素，所以子树视图中未呈现滚动条。</span><span class="sxs-lookup"><span data-stu-id="2bc58-151">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="2bc58-152">但是，你可以将表示滚动条的 <xref:System.Windows.Automation.AutomationElement> 传递到 <xref:System.Windows.Automation.TreeWalker.Normalize%2A> 并检索内容视图中最接近的上级。</span><span class="sxs-lookup"><span data-stu-id="2bc58-152">However, you can pass the <xref:System.Windows.Automation.AutomationElement> representing the scroll bar to <xref:System.Windows.Automation.TreeWalker.Normalize%2A> and retrieve the nearest ancestor that is in the content view.</span></span>  
  
<a name="Other_Ways_to_Retrieve_an_Element"></a>
## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="2bc58-153">检索元素的其他方法</span><span class="sxs-lookup"><span data-stu-id="2bc58-153">Other Ways to Retrieve an Element</span></span>  
 <span data-ttu-id="2bc58-154">除了搜索和导航，你还可以通过以下方法来检索 <xref:System.Windows.Automation.AutomationElement> 。</span><span class="sxs-lookup"><span data-stu-id="2bc58-154">In addition to searches and navigation, you can retrieve an <xref:System.Windows.Automation.AutomationElement> in the following ways.</span></span>  
  
### <a name="from-an-event"></a><span data-ttu-id="2bc58-155">从事件中</span><span class="sxs-lookup"><span data-stu-id="2bc58-155">From an Event</span></span>  
 <span data-ttu-id="2bc58-156">当你的应用程序接收 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 事件时，传递到事件处理程序的源对象是 <xref:System.Windows.Automation.AutomationElement>。</span><span class="sxs-lookup"><span data-stu-id="2bc58-156">When your application receives a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] event, the source object passed to your event handler is an <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="2bc58-157">例如，如果你订阅焦点更改事件，则传递到 <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> 的源是收到焦点的元素。</span><span class="sxs-lookup"><span data-stu-id="2bc58-157">For example, if you have subscribed to focus-changed events, the source passed to your <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> is the element that received the focus.</span></span>  
  
 <span data-ttu-id="2bc58-158">有关详细信息，请参阅 [Subscribe to UI Automation Events](subscribe-to-ui-automation-events.md)。</span><span class="sxs-lookup"><span data-stu-id="2bc58-158">For more information, see [Subscribe to UI Automation Events](subscribe-to-ui-automation-events.md).</span></span>  
  
### <a name="from-a-point"></a><span data-ttu-id="2bc58-159">从某个点中</span><span class="sxs-lookup"><span data-stu-id="2bc58-159">From a Point</span></span>  
 <span data-ttu-id="2bc58-160">如果你具有屏幕坐标（例如，光标位置），则可以使用静态 <xref:System.Windows.Automation.AutomationElement> 方法来检索 <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> 。</span><span class="sxs-lookup"><span data-stu-id="2bc58-160">If you have screen coordinates (for example, a cursor position), you can retrieve an <xref:System.Windows.Automation.AutomationElement> by using the static <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> method.</span></span>  
  
### <a name="from-a-window-handle"></a><span data-ttu-id="2bc58-161">从窗口句柄中</span><span class="sxs-lookup"><span data-stu-id="2bc58-161">From a Window Handle</span></span>  
 <span data-ttu-id="2bc58-162">若要从 HWND 中检索 <xref:System.Windows.Automation.AutomationElement> ，请使用静态 <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="2bc58-162">To retrieve an <xref:System.Windows.Automation.AutomationElement> from an HWND, use the static <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> method.</span></span>  
  
### <a name="from-the-focused-control"></a><span data-ttu-id="2bc58-163">从具有焦点的控件中</span><span class="sxs-lookup"><span data-stu-id="2bc58-163">From the Focused Control</span></span>  
 <span data-ttu-id="2bc58-164">可以从静态 <xref:System.Windows.Automation.AutomationElement> 属性中检索表示焦点控件的 <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> 。</span><span class="sxs-lookup"><span data-stu-id="2bc58-164">You can retrieve an <xref:System.Windows.Automation.AutomationElement> that represents the focused control from the static <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2bc58-165">另请参阅</span><span class="sxs-lookup"><span data-stu-id="2bc58-165">See also</span></span>

- [<span data-ttu-id="2bc58-166">基于属性条件查找 UI 自动化元素</span><span class="sxs-lookup"><span data-stu-id="2bc58-166">Find a UI Automation Element Based on a Property Condition</span></span>](find-a-ui-automation-element-based-on-a-property-condition.md)
- [<span data-ttu-id="2bc58-167">使用 TreeWalker 在 UI 自动化元素之间导航</span><span class="sxs-lookup"><span data-stu-id="2bc58-167">Navigate Among UI Automation Elements with TreeWalker</span></span>](navigate-among-ui-automation-elements-with-treewalker.md)
- [<span data-ttu-id="2bc58-168">UI 自动化树概述</span><span class="sxs-lookup"><span data-stu-id="2bc58-168">UI Automation Tree Overview</span></span>](ui-automation-tree-overview.md)
