---
title: .NET Standard
description: 了解 .NET Standard 及其版本以及支持它的 .NET 实现。
ms.date: 10/05/2020
ms.technology: dotnet-standard
ms.custom: updateeachrelease
ms.assetid: c044882c-af15-45f2-96d1-534557a5ee9b
ms.openlocfilehash: a4736e46eb7c25b64278bed8f2c2457002936b81
ms.sourcegitcommit: 67ebdb695fd017d79d9f1f7f35d145042d5a37f7
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/20/2020
ms.locfileid: "92224154"
---
# <a name="net-standard"></a><span data-ttu-id="bbaa2-103">.NET Standard</span><span class="sxs-lookup"><span data-stu-id="bbaa2-103">.NET Standard</span></span>

<span data-ttu-id="bbaa2-104">[.NET Standard](https://github.com/dotnet/standard) 是针对多个 .NET 实现推出的一套正式的 .NET API 规范。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-104">[.NET Standard](https://github.com/dotnet/standard) is a formal specification of .NET APIs that are available on multiple .NET implementations.</span></span> <span data-ttu-id="bbaa2-105">推出 .NET Standard 的背后动机是要提高 .NET 生态系统中的一致性。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-105">The motivation behind .NET Standard was to establish greater uniformity in the .NET ecosystem.</span></span> <span data-ttu-id="bbaa2-106">但是，.NET 5 采用不同的方法来建立一致性，这种新方法在很多情况下都不需要 .NET Standard。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-106">However, .NET 5 adopts a different approach to establishing uniformity, and this new approach eliminates the need for .NET Standard in many scenarios.</span></span> <span data-ttu-id="bbaa2-107">有关详细信息，请参阅本文后续部分的 [.NET 5 和 .NET Standard](#net-5-and-net-standard)。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-107">For more information, see [.NET 5 and .NET Standard](#net-5-and-net-standard) later in this article.</span></span>

## <a name="net-implementation-support"></a><span data-ttu-id="bbaa2-108">.NET 实现支持</span><span class="sxs-lookup"><span data-stu-id="bbaa2-108">.NET implementation support</span></span>

<span data-ttu-id="bbaa2-109">各种 .NET 实现以特定版本的 .NET Standard 为目标。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-109">The various .NET implementations target specific versions of .NET Standard.</span></span> <span data-ttu-id="bbaa2-110">每个 .NET 实现版本都会公布它所支持的最高 .NET Standard 版本，这种声明意味着它也支持以前的版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-110">Each .NET implementation version advertises the highest .NET Standard version it supports, a statement that means it also supports previous versions.</span></span> <span data-ttu-id="bbaa2-111">例如，.NET Framework 4.6 实现 .NET Standard 1.3。也就是说，它会公开在 .NET Standard 版本 1.0 到 1.3 中定义的所有 API。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-111">For example, .NET Framework 4.6 implements .NET Standard 1.3, which means that it exposes all APIs defined in .NET Standard versions 1.0 through 1.3.</span></span> <span data-ttu-id="bbaa2-112">同样，.NET Framework 4.6.1 实现 .NET Standard 1.4，而 .NET 5.0 则实现 .NET Standard 2.1。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-112">Similarly, .NET Framework 4.6.1 implements .NET Standard 1.4, while .NET 5.0 implements .NET Standard 2.1.</span></span>

<span data-ttu-id="bbaa2-113">下表列出了支持每个 .NET Standard 版本的最低实现版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-113">The following table lists the **minimum** implementation versions that support each .NET Standard version.</span></span> <span data-ttu-id="bbaa2-114">这意味着所列实现的更高版本也支持相应的 .NET Standard 版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-114">That means that later versions of a listed implementation also support the corresponding .NET Standard version.</span></span> <span data-ttu-id="bbaa2-115">例如，.NET Core 2.1 及更高版本支持 .NET Standard 2.0 及更早版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-115">For example, .NET Core 2.1 and later versions support .NET Standard 2.0 and earlier versions.</span></span>

[!INCLUDE [net-standard-table](../../includes/net-standard-table.md)]

<span data-ttu-id="bbaa2-116">若要查找可以定位的 .NET Standard 最高版本，请按照以下步骤操作：</span><span class="sxs-lookup"><span data-stu-id="bbaa2-116">To find the highest version of .NET Standard that you can target, do the following steps:</span></span>

1. <span data-ttu-id="bbaa2-117">查找要运行的 .NET 实现所在的行。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-117">Find the row that indicates the .NET implementation you want to run on.</span></span>
1. <span data-ttu-id="bbaa2-118">在这一行中从右向左查找可以定位的 .NET Standard 版本所在的列。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-118">Find the column in that row that indicates your version starting from right to left.</span></span>
1. <span data-ttu-id="bbaa2-119">列标题指示目标支持的 .NET Standard 版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-119">The column header indicates the .NET Standard version that your target supports.</span></span> <span data-ttu-id="bbaa2-120">此外可以面向任何更低的 .NET Standard 版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-120">You may also target any lower .NET Standard version.</span></span> <span data-ttu-id="bbaa2-121">更高版本的 .NET Standard 还支持实现。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-121">Higher .NET Standard versions will also support your implementation.</span></span>
1. <span data-ttu-id="bbaa2-122">对要定位的每个平台重复执行此过程。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-122">Repeat this process for each platform you want to target.</span></span> <span data-ttu-id="bbaa2-123">如果有多个目标平台，应选择它们都支持的最高版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-123">If you have more than one target platform, you should pick the smaller version among them.</span></span> <span data-ttu-id="bbaa2-124">例如，如果要在 .NET Framework 4.8 和 .NET 5.0 上运行，可以使用的最高 .NET Standard 版本是 .NET Standard 2.0。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-124">For example, if you want to run on .NET Framework 4.8 and .NET 5.0, the highest .NET Standard version you can use is .NET Standard 2.0.</span></span>

### <a name="which-net-standard-version-to-target"></a><span data-ttu-id="bbaa2-125">要定位哪个 .NET Standard 版本</span><span class="sxs-lookup"><span data-stu-id="bbaa2-125">Which .NET Standard version to target</span></span>

<span data-ttu-id="bbaa2-126">选择目标 .NET Standard 版本时，请权衡以下因素：</span><span class="sxs-lookup"><span data-stu-id="bbaa2-126">When choosing a .NET Standard version to target, consider this trade-off:</span></span>

- <span data-ttu-id="bbaa2-127">版本越高，可用于库的代码的 API 就越多。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-127">The higher the version, the more APIs are available to your library's code.</span></span>
- <span data-ttu-id="bbaa2-128">版本越低，可使用你的库的应用和库就越多。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-128">The lower the version, the more apps and libraries can use your library.</span></span>

<span data-ttu-id="bbaa2-129">建议尽可能将最低版本的 .NET Standard 作为目标。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-129">We recommend you target the *lowest* version of .NET Standard possible.</span></span> <span data-ttu-id="bbaa2-130">因此，在找到可以定位的最高版本 .NET Standard 后，请按照以下步骤操作：</span><span class="sxs-lookup"><span data-stu-id="bbaa2-130">So, after you find the highest .NET Standard version you can target, follow these steps:</span></span>

1. <span data-ttu-id="bbaa2-131">定位前一更低版本的 .NET Standard，然后生成项目。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-131">Target the next lower version of .NET Standard and build your project.</span></span>
2. <span data-ttu-id="bbaa2-132">如果成功生成项目，请重复执行第 1 步。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-132">If your project builds successfully, repeat step 1.</span></span> <span data-ttu-id="bbaa2-133">否则，重新定位到后一较高版本，这就是应该使用的版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-133">Otherwise, retarget to the next higher version and that's the version you should use.</span></span>

<span data-ttu-id="bbaa2-134">但是，定位更低版本的 .NET Standard 会引入许多支持依赖项。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-134">However, targeting lower .NET Standard versions introduces a number of support dependencies.</span></span> <span data-ttu-id="bbaa2-135">如果项目定位 .NET Standard 1.x，我们建议  还定位 .NET Standard 2.0。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-135">If your project targets .NET Standard 1.x, we recommend that you *also* target .NET Standard 2.0.</span></span> <span data-ttu-id="bbaa2-136">这简化了在 .NET Standard 2.0 兼容实现上运行的库的用户的依赖项关系图，并减少了下载所需的包数。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-136">This simplifies the dependency graph for users of your library that run on .NET Standard 2.0 compatible implementations, and it reduces the number of packages they need to download.</span></span>

### <a name="net-standard-versioning-rules"></a><span data-ttu-id="bbaa2-137">.NET Standard 版本控制规则</span><span class="sxs-lookup"><span data-stu-id="bbaa2-137">.NET Standard versioning rules</span></span>

<span data-ttu-id="bbaa2-138">版本控制规则主要有两个：</span><span class="sxs-lookup"><span data-stu-id="bbaa2-138">There are two primary versioning rules:</span></span>

- <span data-ttu-id="bbaa2-139">累加性：.NET Standard 版本在逻辑上形成同心圆。也就是说，较高的版本包含较低版本的所有 API。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-139">Additive: .NET Standard versions are logically concentric circles: higher versions incorporate all APIs from previous versions.</span></span> <span data-ttu-id="bbaa2-140">版本之间没有重大更改。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-140">There are no breaking changes between versions.</span></span>
- <span data-ttu-id="bbaa2-141">不可变：一旦发布，.NET Standard 版本就会冻结起来。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-141">Immutable: Once shipped, .NET Standard versions are frozen.</span></span>

<span data-ttu-id="bbaa2-142">在 .NET Standard 2.1 版本之后，将不会有新版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-142">There will be no new .NET Standard versions after 2.1.</span></span> <span data-ttu-id="bbaa2-143">有关详细信息，请参阅本文后续部分的 [.NET 5 和 .NET Standard](#net-5-and-net-standard)。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-143">For more information, see [.NET 5 and .NET Standard](#net-5-and-net-standard) later in this article.</span></span>

## <a name="specification"></a><span data-ttu-id="bbaa2-144">规范</span><span class="sxs-lookup"><span data-stu-id="bbaa2-144">Specification</span></span>

<span data-ttu-id="bbaa2-145">.NET Standard 规范是一组标准化的 API。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-145">The .NET Standard specification is a standardized set of APIs.</span></span> <span data-ttu-id="bbaa2-146">此规范由 .NET 实现者（具体而言，由 Microsoft（包括 .NET Framework、NET Core 和 Mono）和 Unity）进行维护。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-146">The specification is maintained by .NET implementors, specifically Microsoft (includes .NET Framework, .NET Core, and Mono) and Unity.</span></span>

### <a name="official-artifacts"></a><span data-ttu-id="bbaa2-147">正式项目</span><span class="sxs-lookup"><span data-stu-id="bbaa2-147">Official artifacts</span></span>

<span data-ttu-id="bbaa2-148">正式规范是一组用于定义标准中包含的 API 的 .cs 文件。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-148">The official specification is a set of *.cs* files that define the APIs that are part of the standard.</span></span> <span data-ttu-id="bbaa2-149">[dotnet/standard 存储库](https://github.com/dotnet/standard)中的 [Ref 目录](https://github.com/dotnet/standard/tree/master/src/netstandard/ref)定义了 .NET Standard API。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-149">The [ref directory](https://github.com/dotnet/standard/tree/master/src/netstandard/ref) in the [dotnet/standard repository](https://github.com/dotnet/standard) defines the .NET Standard APIs.</span></span>

<span data-ttu-id="bbaa2-150">[NETStandard.Library](https://www.nuget.org/packages/NETStandard.Library) 元包（[源代码](https://github.com/dotnet/standard/blob/master/src/netstandard/pkg/NETStandard.Library.dependencies.props)）描述用于部分定义一个或多个 .NET Standard 版本的库集。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-150">The [NETStandard.Library](https://www.nuget.org/packages/NETStandard.Library) metapackage ([source](https://github.com/dotnet/standard/blob/master/src/netstandard/pkg/NETStandard.Library.dependencies.props)) describes the set of libraries that define (in part) one or more .NET Standard versions.</span></span>

<span data-ttu-id="bbaa2-151">给定的组件（如 `System.Runtime`）描述：</span><span class="sxs-lookup"><span data-stu-id="bbaa2-151">A given component, like `System.Runtime`, describes:</span></span>

- <span data-ttu-id="bbaa2-152">.NET Standard 的一部分（即其范围）。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-152">Part of .NET Standard (just its scope).</span></span>
- <span data-ttu-id="bbaa2-153">.NET Standard 在此范围内的多个版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-153">Multiple versions of .NET Standard, for that scope.</span></span>

<span data-ttu-id="bbaa2-154">标准库提供派生项目以方便读取，并实现某些开发人员方案（例如，使用编译器）。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-154">Derivative artifacts are provided to enable more convenient reading and to enable certain developer scenarios (for example, using a compiler).</span></span>

- [<span data-ttu-id="bbaa2-155">Markdown 中的 API 列表</span><span class="sxs-lookup"><span data-stu-id="bbaa2-155">API list in markdown</span></span>](https://github.com/dotnet/standard/tree/master/docs/versions)
- <span data-ttu-id="bbaa2-156">引用程序集，以 NuGet 包的形式分发，由 [NETStandard.Library](https://www.nuget.org/packages/NETStandard.Library/) 元包引用。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-156">Reference assemblies, distributed as NuGet packages and referenced by the [NETStandard.Library](https://www.nuget.org/packages/NETStandard.Library/) metapackage.</span></span>

### <a name="package-representation"></a><span data-ttu-id="bbaa2-157">包表示形式</span><span class="sxs-lookup"><span data-stu-id="bbaa2-157">Package representation</span></span>

<span data-ttu-id="bbaa2-158">.NET Standard 引用程序集的主要分发载体是 NuGet 包。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-158">The primary distribution vehicle for the .NET Standard reference assemblies is NuGet packages.</span></span> <span data-ttu-id="bbaa2-159">实现会以适用于每个 .NET 实现的各种方式提供。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-159">Implementations are delivered in a variety of ways, appropriate for each .NET implementation.</span></span>

<span data-ttu-id="bbaa2-160">NuGet 包面向一个或多个[框架](frameworks.md)。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-160">NuGet packages target one or more [frameworks](frameworks.md).</span></span> <span data-ttu-id="bbaa2-161">.NET Standard 包面向“.NET Standard”框架。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-161">.NET Standard packages target the ".NET Standard" framework.</span></span> <span data-ttu-id="bbaa2-162">可以使用 `netstandard` [精简 TFM](frameworks.md)（例如 `netstandard1.4`）来设定 .NET Standard 框架作为目标。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-162">You can target the .NET Standard framework using the `netstandard` [compact TFM](frameworks.md) (for example, `netstandard1.4`).</span></span> <span data-ttu-id="bbaa2-163">计划在多个 .NET 实现上运行的库应将此框架作为目标。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-163">Libraries that are intended to run on multiple implementations of .NET should target this framework.</span></span> <span data-ttu-id="bbaa2-164">对于最广泛的 API 集，将 `netstandard2.0` 设定为目标，因为 .NET Standard 2.0 的可用 API 数量比 .NET Standard 1.6 的两倍还多。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-164">For the broadest set of APIs, target `netstandard2.0` since the number of available APIs more than doubled between .NET Standard 1.6 and 2.0.</span></span>

<span data-ttu-id="bbaa2-165">[`NETStandard.Library`](https://www.nuget.org/packages/NETStandard.Library/) 元包引用定义 .NET Standard 的一整套 NuGet 包。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-165">The [`NETStandard.Library`](https://www.nuget.org/packages/NETStandard.Library/) metapackage references the complete set of NuGet packages that define .NET Standard.</span></span>  <span data-ttu-id="bbaa2-166">要指定 `netstandard` 作为目标，最常见的方法是引用此元包。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-166">The most common way to target `netstandard` is by referencing this metapackage.</span></span> <span data-ttu-id="bbaa2-167">它描述并提供了对大约 40 个 .NET 库及定义 .Net Standard 的相关 API 的访问权限。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-167">It describes and provides access to the ~40 .NET libraries and associated APIs that define .NET Standard.</span></span> <span data-ttu-id="bbaa2-168">可以引用以 `netstandard` 为目标的其他包来使用其他 API。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-168">You can reference additional packages that target `netstandard` to get access to additional APIs.</span></span>

### <a name="versioning"></a><span data-ttu-id="bbaa2-169">版本管理</span><span class="sxs-lookup"><span data-stu-id="bbaa2-169">Versioning</span></span>

<span data-ttu-id="bbaa2-170">规范并不是单一的，而是一组以线性方式进行版本控制的 API。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-170">The specification is not singular, but a linearly versioned set of APIs.</span></span> <span data-ttu-id="bbaa2-171">该标准的第一个版本建立了一组基准 API。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-171">The first version of the standard establishes a baseline set of APIs.</span></span> <span data-ttu-id="bbaa2-172">后续版本将添加 API，并继承以前的版本定义的 API。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-172">Subsequent versions add APIs and inherit APIs defined by previous versions.</span></span> <span data-ttu-id="bbaa2-173">在从 Standard 中移除 API 方面，并没有成文的规定。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-173">There is no established provision for removing APIs from the Standard.</span></span>

<span data-ttu-id="bbaa2-174">.NET Standard 并不特定于任何一种 .NET 实现，也不与其中任一实现的版本控制方案匹配。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-174">.NET Standard is not specific to any one .NET implementation, nor does it match the versioning scheme of any of those implementations.</span></span>

<span data-ttu-id="bbaa2-175">如前所述，在 .NET Standard 2.1 版本之后，将不会有新版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-175">As noted earlier, there will be no new .NET Standard versions after 2.1.</span></span>

## <a name="target-net-standard"></a><span data-ttu-id="bbaa2-176">定位 .NET Standard</span><span class="sxs-lookup"><span data-stu-id="bbaa2-176">Target .NET Standard</span></span>

<span data-ttu-id="bbaa2-177">可以结合使用 `netstandard` 框架和 `NETStandard.Library` 元包来[构建 .NET Standard 库](../core/tutorials/libraries.md)。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-177">You can [build .NET Standard Libraries](../core/tutorials/libraries.md) using a combination of the `netstandard` framework and the `NETStandard.Library` metapackage.</span></span>

## <a name="net-framework-compatibility-mode"></a><span data-ttu-id="bbaa2-178">.NET Framework 兼容性模式</span><span class="sxs-lookup"><span data-stu-id="bbaa2-178">.NET Framework compatibility mode</span></span>

<span data-ttu-id="bbaa2-179">从 .NET Standard 2.0 开始，引入了 .NET Framework 兼容性模式。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-179">Starting with .NET Standard 2.0, the .NET Framework compatibility mode was introduced.</span></span> <span data-ttu-id="bbaa2-180">此兼容性模式允许 .NET Standard 项目引用 .NET Framework 库，就像其针对 .NET Standard 编译一样。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-180">This compatibility mode allows .NET Standard projects to reference .NET Framework libraries as if they were compiled for .NET Standard.</span></span> <span data-ttu-id="bbaa2-181">引用 .NET Framework 库并不适用于所有项目，，例如使用 Windows Presentation Foundation (WPF) API 的库。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-181">Referencing .NET Framework libraries doesn't work for all projects, such as libraries that use Windows Presentation Foundation (WPF) APIs.</span></span>

<span data-ttu-id="bbaa2-182">有关详细信息，请参阅 [.NET Framework兼容性模式](../core/porting/third-party-deps.md#net-framework-compatibility-mode)。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-182">For more information, see [.NET Framework compatibility mode](../core/porting/third-party-deps.md#net-framework-compatibility-mode).</span></span>

## <a name="net-standard-libraries-and-visual-studio"></a><span data-ttu-id="bbaa2-183">.NET Standard 库和 Visual Studio</span><span class="sxs-lookup"><span data-stu-id="bbaa2-183">.NET Standard libraries and Visual Studio</span></span>

<span data-ttu-id="bbaa2-184">要在 Visual Studio 中生成 .NET Standard 库，请确保 Windows 上已安装 [Visual Studio 2019](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=inline+link&utm_content=download+vs2019) 或 Visual Studio 2017 版本 15.3 或更高版本，或 macOS 上已安装 [Visual Studio for Mac 版本 7.1](https://visualstudio.microsoft.com/vs/mac/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=inline+link) 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-184">In order to build .NET Standard libraries in Visual Studio, make sure you have [Visual Studio 2019](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=inline+link&utm_content=download+vs2019) or Visual Studio 2017 version 15.3 or later installed on Windows, or [Visual Studio for Mac version 7.1](https://visualstudio.microsoft.com/vs/mac/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=inline+link) or later installed on macOS.</span></span>

<span data-ttu-id="bbaa2-185">如果项目中只需使用 .NET Standard 2.0 库，也可在 Visual Studio 2015 中执行此操作。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-185">If you only need to consume .NET Standard 2.0 libraries in your projects, you can also do that in Visual Studio 2015.</span></span> <span data-ttu-id="bbaa2-186">但是需要安装 NuGet client 3.6 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-186">However, you need NuGet client 3.6 or higher installed.</span></span> <span data-ttu-id="bbaa2-187">可从 [NuGet 下载](https://www.nuget.org/downloads)页面下载适用于 Visual Studio 2015 的 NuGet 客户端。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-187">You can download the NuGet client for Visual Studio 2015 from the [NuGet downloads](https://www.nuget.org/downloads) page.</span></span>

## <a name="net-5-and-net-standard"></a><span data-ttu-id="bbaa2-188">.NET 5 和 .NET Standard</span><span class="sxs-lookup"><span data-stu-id="bbaa2-188">.NET 5 and .NET Standard</span></span>

<span data-ttu-id="bbaa2-189">.NET 5 是 Microsoft 正在积极开发的 .NET 实现。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-189">.NET 5 is the implementation of .NET that Microsoft is actively developing.</span></span> <span data-ttu-id="bbaa2-190">它是具有一组统一功能和 API 的单一产品，可用于 Windows 桌面应用和跨平台控制台应用、云服务和网站。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-190">It's a single product with a uniform set of capabilities and APIs that can be used for Windows desktop apps and cross-platform console apps, cloud services, and websites.</span></span> <span data-ttu-id="bbaa2-191">.NET 5.0 [TFM](frameworks.md) 反映了以下广泛的应用场景：</span><span class="sxs-lookup"><span data-stu-id="bbaa2-191">The .NET 5.0 [TFMs](frameworks.md) reflect this broad range of scenarios:</span></span>

* `net5.0`

  <span data-ttu-id="bbaa2-192">此 TFM 适用于在任何位置运行的代码。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-192">This TFM is for code that runs everywhere.</span></span> <span data-ttu-id="bbaa2-193">它仅包括跨平台工作的技术（少数例外情况除外）。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-193">With a few exceptions, it includes only technologies that work cross-platform.</span></span> <span data-ttu-id="bbaa2-194">对于 .NET 5 代码，`net5.0` 替换了 `netcoreapp` 和 `netstandard` TFM。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-194">For .NET 5 code, `net5.0` replaces both `netcoreapp` and `netstandard` TFMs.</span></span>

* `net5.0-windows`

  <span data-ttu-id="bbaa2-195">这是一个[特定于 OS 的 TFM](frameworks.md#net-5-os-specific-tfms) 的示例，该 TFM 可向 `net5.0` 引用的所有内容添加特定于 OS 的功能。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-195">This is an example of [OS-specific TFMs](frameworks.md#net-5-os-specific-tfms) that add OS-specific functionality to everything that `net5.0` refers to.</span></span>

### <a name="when-to-target-net50-vs-netstandard"></a><span data-ttu-id="bbaa2-196">以 net5.0 为目标与以 netstandard 为目标的情形</span><span class="sxs-lookup"><span data-stu-id="bbaa2-196">When to target net5.0 vs. netstandard</span></span>

<span data-ttu-id="bbaa2-197">对于以 `netstandard` 为目标的现有代码，无需将 TFM 更改为 `net5.0`。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-197">For existing code that targets `netstandard`, there's no need to change the TFM to `net5.0`.</span></span> <span data-ttu-id="bbaa2-198">.NET 5.0 可实现 .NET Standard 2.1 及更早版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-198">.NET 5.0 implements .NET Standard 2.1 and earlier.</span></span> <span data-ttu-id="bbaa2-199">将目标从 .NET Standard 更改为 .NET 5.0 的唯一原因是获取对更多运行时功能、语言功能或 API 的访问权限。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-199">The only reason to retarget from .NET Standard to .NET 5.0 would be to gain access to more runtime features, language features, or APIs.</span></span> <span data-ttu-id="bbaa2-200">例如，为了使用 C# 9，需要以 .NET 5.0 为目标。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-200">For example, in order to use C# 9, you need to target .NET 5.0.</span></span> <span data-ttu-id="bbaa2-201">可同时以 .NET 5.0 和 .NET Standard 为目标来访问较新的功能，并仍然可将库供其他 .NET 实现使用。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-201">You can multitarget .NET 5.0 and .NET Standard to get access to newer features and still have your library available to other .NET implementations.</span></span>

<span data-ttu-id="bbaa2-202">下面是适用于 .NET 5 新代码的一些准则：</span><span class="sxs-lookup"><span data-stu-id="bbaa2-202">Here are some guidelines for new code for .NET 5:</span></span>

* <span data-ttu-id="bbaa2-203">应用组件</span><span class="sxs-lookup"><span data-stu-id="bbaa2-203">App components</span></span>

  <span data-ttu-id="bbaa2-204">如果要使用库将应用程序分解成多个组件，建议以 `net5.x` 作为目标，其中 `5.x` 是应用程序可将其作为目标的最早的 .NET 5 版本。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-204">If you're using libraries to break down an application into several components, we recommend you target `net5.x` where `5.x` is the earliest .NET 5 version that your application can target.</span></span> <span data-ttu-id="bbaa2-205">为简单起见，最好在同一 .NET 版本中保留构成应用程序的所有项目。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-205">For simplicity, it's best to keep all projects that make up your application on the same version of .NET.</span></span> <span data-ttu-id="bbaa2-206">然后，可以假设任何位置均具有相同的 BCL 功能。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-206">Then you can assume the same BCL features everywhere.</span></span>

* <span data-ttu-id="bbaa2-207">可重用的库</span><span class="sxs-lookup"><span data-stu-id="bbaa2-207">Reusable libraries</span></span>

  <span data-ttu-id="bbaa2-208">如果要构建计划在 NuGet 上发布的可重用的库，请考虑在覆盖范围和可用功能集之间进行权衡。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-208">If you're building reusable libraries that you plan to ship on NuGet, consider the trade-off between reach and available feature set.</span></span> <span data-ttu-id="bbaa2-209">.NET Standard 2.0 是 .NET Framework 支持的最新版本，因此它具有相当大的功能集，可提供良好的覆盖范围。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-209">.NET Standard 2.0 is the latest version that is supported by .NET Framework, so it gives good reach with a fairly large feature set.</span></span> <span data-ttu-id="bbaa2-210">我们建议你不要以 .NET Standard 1.x 作为目标，因为这样会限制可用的功能集，使覆盖范围的增幅降至最低。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-210">We don't recommend targeting .NET Standard 1.x, as you'd limit the available feature set for a minimal increase in reach.</span></span>

  <span data-ttu-id="bbaa2-211">如果你不需要支持 .NET Framework，可以选择 .NET Standard 2.1 或 .NET 5。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-211">If you don't need to support .NET Framework, you could go with .NET Standard 2.1 or .NET 5.</span></span> <span data-ttu-id="bbaa2-212">我们建议你跳过 .NET Standard 2.1，而直接选择 .NET 5。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-212">We recommend you skip .NET Standard 2.1 and go straight to .NET 5.</span></span> <span data-ttu-id="bbaa2-213">大多数广泛使用的库最终都将同时以 .NET Standard 2.0 和 .NET 5 作为目标。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-213">Most widely used libraries will end up multi-targeting for both .NET Standard 2.0 and .NET 5.</span></span> <span data-ttu-id="bbaa2-214">支持 .NET Standard 2.0 可提供最大的覆盖范围，而支持 .NET 5 可确保你可以为已使用 .NET 5 的客户利用最新的平台功能。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-214">Supporting .NET Standard 2.0 gives you the most reach, while supporting .NET 5 ensures you can leverage the latest platform features for customers that are already on .NET 5.</span></span>

### <a name="net-standard-problems"></a><span data-ttu-id="bbaa2-215">.NET Standard 的问题</span><span class="sxs-lookup"><span data-stu-id="bbaa2-215">.NET Standard problems</span></span>

<span data-ttu-id="bbaa2-216">下面是一些关于 .NET Standard 的问题，这些问题有助于解释为什么最好使用 .NET 5 来跨平台和工作负载共享代码：</span><span class="sxs-lookup"><span data-stu-id="bbaa2-216">Here are some problems with .NET Standard that help explain why .NET 5 is the better way to share code across platforms and workloads:</span></span>

- <span data-ttu-id="bbaa2-217">添加新 API 的速度缓慢</span><span class="sxs-lookup"><span data-stu-id="bbaa2-217">Slowness to add new APIs</span></span>

  <span data-ttu-id="bbaa2-218">.NET Standard 是作为所有 .NET 实现都必须支持的 API 集创建的，因此会对添加新 API 的建议进行审核。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-218">.NET Standard was created as an API set that all .NET implementations would have to support, so there was a review process for proposals to add new APIs.</span></span> <span data-ttu-id="bbaa2-219">目标是仅标准化可在所有当前和未来的 .NET 平台中实现的 API。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-219">The goal was to standardize only APIs that could be implemented in all current and future .NET platforms.</span></span> <span data-ttu-id="bbaa2-220">因此，如果某个功能错过了特定版本，则你可能需要等待几年，该功能才会被添加到 Standard 版本中。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-220">The result was that if a feature missed a particular release, you might have to wait for a couple of years before it got added to a version of the Standard.</span></span> <span data-ttu-id="bbaa2-221">然后，你需要等待更长的时间，新版本的 .NET Standard 才能受到广泛支持。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-221">Then you'd wait even longer for the new version of .NET Standard to be widely supported.</span></span>

  <span data-ttu-id="bbaa2-222">.NET 5 中的解决方案：实现某项功能时，该功能便已可供所有 .NET 5 应用和库使用，因为代码基底是共享的。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-222">**Solution in .NET 5:** When a feature is implemented, it's already available for every .NET 5 app and library because the code base is shared.</span></span> <span data-ttu-id="bbaa2-223">由于 API 规范与其实现之间没有区别，因此相较于使用 .NET Standard，你可以更快地利用新功能。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-223">And since there's no difference between the API specification and its implementation, you're able to take advantage of new features much quicker than with .NET Standard.</span></span>

- <span data-ttu-id="bbaa2-224">复杂的版本控制</span><span class="sxs-lookup"><span data-stu-id="bbaa2-224">Complex versioning</span></span>

  <span data-ttu-id="bbaa2-225">API 规范与其实现的分离导致 API 规范版本与实现版本之间出现复杂的映射。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-225">The separation of the API specification from its implementations results in complex mapping between API specification versions and implementation versions.</span></span> <span data-ttu-id="bbaa2-226">这种复杂性在本文前面显示的表以及其解释方式说明中显而易见。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-226">This complexity is evident in the table shown earlier in this article and the instructions for how to interpret it.</span></span>

  <span data-ttu-id="bbaa2-227">.NET 5 中的解决方案：.NET 5.x API 规范与其实现之间不存在任何分离。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-227">**Solution in .NET 5:** There's no separation between a .NET 5.x API specification and its implementation.</span></span> <span data-ttu-id="bbaa2-228">由此实现了一个简化的 TFM 方案。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-228">The result is a simplified TFM scheme.</span></span> <span data-ttu-id="bbaa2-229">提供了一个适用于所有工作负载的 TFM 前缀：`net5.0` 用于库、控制台应用和 Web 应用。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-229">There's one TFM prefix for all workloads: `net5.0` is used for libraries, console apps, and web apps.</span></span> <span data-ttu-id="bbaa2-230">唯一的变化是针对特定平台[指定特定于平台的 API 的后缀](frameworks.md#net-5-os-specific-tfms)，例如 `net5.0-windows`。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-230">The only variation is a [suffix that specifies platform-specific APIs](frameworks.md#net-5-os-specific-tfms) for a particular platform, such as `net5.0-windows`.</span></span> <span data-ttu-id="bbaa2-231">由于此 TFM 命名约定，你可以轻松判断给定应用是否可以使用给定的库。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-231">Thanks to this TFM naming convention, you can easily tell whether a given app can use a given library.</span></span> <span data-ttu-id="bbaa2-232">不需要版本号等效表（如 .NET Standard 的版本号等效表）。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-232">No version number equivalents table like the one for .NET Standard is needed.</span></span>

- <span data-ttu-id="bbaa2-233">运行时出现不受平台支持的异常</span><span class="sxs-lookup"><span data-stu-id="bbaa2-233">Platform-unsupported exceptions at run time</span></span>

  <span data-ttu-id="bbaa2-234">.NET Standard 公开了特定于平台的 API。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-234">.NET Standard exposes platform-specific APIs.</span></span> <span data-ttu-id="bbaa2-235">代码在编译时可能不会出错，并且看起来可以移植到任何平台（即该代码不可移植也是如此）。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-235">Your code might compile without errors and appear to be portable to any platform even if it isn't portable.</span></span> <span data-ttu-id="bbaa2-236">当它在不具有给定 API 实现的平台上运行时，会出现运行时错误。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-236">When it runs on a platform that doesn't have an implementation for a given API, you get run-time errors.</span></span>

  <span data-ttu-id="bbaa2-237">.NET 5 中的解决方案：.NET 5 SDK 包括默认启用的代码分析器。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-237">**Solution in .NET 5:** The .NET 5 SDK includes code analyzers that are enabled by default.</span></span> <span data-ttu-id="bbaa2-238">平台兼容性分析器会检测对你打算在其上运行的平台所不支持的 API 的意外使用情况。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-238">The platform compatibility analyzer detects unintentional use of APIs that aren't supported on the platforms you intend to run on.</span></span> <span data-ttu-id="bbaa2-239">有关详细信息，请参阅[平台兼容性分析器](analyzers/platform-compat-analyzer.md)。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-239">For more information, see [Platform compatibility analyzer](analyzers/platform-compat-analyzer.md).</span></span>

### <a name="net-standard-not-deprecated"></a><span data-ttu-id="bbaa2-240">未弃用 .NET Standard</span><span class="sxs-lookup"><span data-stu-id="bbaa2-240">.NET Standard not deprecated</span></span>

<span data-ttu-id="bbaa2-241">对于可由多个 .NET 实现使用的库，仍需要 .NET Standard。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-241">.NET Standard is still needed for libraries that can be used by multiple .NET implementations.</span></span> <span data-ttu-id="bbaa2-242">在以下情况下，建议以 .NET Standard 作为目标：</span><span class="sxs-lookup"><span data-stu-id="bbaa2-242">We recommend you target .NET Standard in the following scenarios:</span></span>

* <span data-ttu-id="bbaa2-243">使用 `netstandard2.0` 在 .NET Framework 和 .NET 的所有其他实现之间共享代码。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-243">Use `netstandard2.0` to share code between .NET Framework and all other implementations of .NET.</span></span>
* <span data-ttu-id="bbaa2-244">使用 `netstandard2.1` 在 Mono、Xamarin 和 .NET Core 3.x 之间共享代码。</span><span class="sxs-lookup"><span data-stu-id="bbaa2-244">Use `netstandard2.1` to share code between Mono, Xamarin, and .NET Core 3.x.</span></span>

## <a name="see-also"></a><span data-ttu-id="bbaa2-245">另请参阅</span><span class="sxs-lookup"><span data-stu-id="bbaa2-245">See also</span></span>

- [<span data-ttu-id="bbaa2-246">.NET Standard 版本（源）</span><span class="sxs-lookup"><span data-stu-id="bbaa2-246">.NET Standard versions (source)</span></span>](https://github.com/dotnet/standard/blob/master/docs/versions.md)
- [<span data-ttu-id="bbaa2-247">.NET Standard 版本（交互式 UI）</span><span class="sxs-lookup"><span data-stu-id="bbaa2-247">.NET Standard versions (interactive UI)</span></span>](https://dotnet.microsoft.com/platform/dotnet-standard#versions)
- [<span data-ttu-id="bbaa2-248">生成 .NET Standard 库</span><span class="sxs-lookup"><span data-stu-id="bbaa2-248">Build a .NET Standard library</span></span>](../core/tutorials/library-with-visual-studio.md)
- [<span data-ttu-id="bbaa2-249">跨平台定位</span><span class="sxs-lookup"><span data-stu-id="bbaa2-249">Cross-platform targeting</span></span>](./library-guidance/cross-platform-targeting.md)
