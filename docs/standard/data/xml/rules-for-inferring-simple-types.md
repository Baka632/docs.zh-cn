---
title: 推断简单类型的规则
ms.date: 03/30/2017
ms.assetid: 394624d6-4da0-430a-8a88-46efe40f14de
ms.openlocfilehash: b8fa3037d9ad5af057f477733ffdea74681f5549
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/24/2020
ms.locfileid: "95686535"
---
# <a name="rules-for-inferring-simple-types"></a><span data-ttu-id="dc7ed-102">推断简单类型的规则</span><span class="sxs-lookup"><span data-stu-id="dc7ed-102">Rules for Inferring Simple Types</span></span>

<span data-ttu-id="dc7ed-103">描述 <xref:System.Xml.Schema.XmlSchemaInference> 类如何推断属性和元素的数据类型。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-103">Describes how the <xref:System.Xml.Schema.XmlSchemaInference> class infers the data type for attributes and elements.</span></span>  
  
 <span data-ttu-id="dc7ed-104"><xref:System.Xml.Schema.XmlSchemaInference> 类将属性和元素的数据类型推断为简单类型。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-104">The <xref:System.Xml.Schema.XmlSchemaInference> class infers the data type for attributes and elements as simple types.</span></span> <span data-ttu-id="dc7ed-105">本节描述可能的推断类型、如何将多个不同的值协调为单个类型以及如何处理架构定义 `xsi` 属性。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-105">This section describes the potential inferred types, how multiple differing values are reconciled to a single type, and how schema-defining `xsi` attributes are handled.</span></span>  
  
## <a name="inferred-types"></a><span data-ttu-id="dc7ed-106">推断类型</span><span class="sxs-lookup"><span data-stu-id="dc7ed-106">Inferred Types</span></span>  

 <span data-ttu-id="dc7ed-107"><xref:System.Xml.Schema.XmlSchemaInference> 类将元素和属性值推断为简单类型，并在生成的架构中包含类型属性。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-107">The <xref:System.Xml.Schema.XmlSchemaInference> class infers element and attribute values as simple types and includes a type attribute in the resulting schema.</span></span> <span data-ttu-id="dc7ed-108">所有推断类型都是简单类型。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-108">All inferred types are simple types.</span></span> <span data-ttu-id="dc7ed-109">生成的架构中不包括任何基类型或方面。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-109">No base types or facets are included as part of the resulting schema.</span></span>  
  
 <span data-ttu-id="dc7ed-110">在 XML 文档中遇到的值会分别进行检查。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-110">Values are examined individually as they are encountered in the XML document.</span></span> <span data-ttu-id="dc7ed-111">在检查时会推断值的类型。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-111">The type is inferred for a value at the time it is examined.</span></span> <span data-ttu-id="dc7ed-112">如果已推断了某个属性或元素的类型，在遇到该属性或元素的值与当前的推断类型不匹配时，<xref:System.Xml.Schema.XmlSchemaInference> 类将提升规则集中每个规则的类型。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-112">If a type has been inferred for an attribute or element, and a value for the attribute or element is encountered that does not match the currently inferred type, the <xref:System.Xml.Schema.XmlSchemaInference> class promotes the type for each of a set of rules.</span></span> <span data-ttu-id="dc7ed-113">这些规则在本主题后面的“类型提升”一节中讨论。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-113">These rules are discussed in the Type Promotion section, later in this topic.</span></span>  
  
 <span data-ttu-id="dc7ed-114">下表列出生成的架构中可能包含的推断类型。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-114">The following table lists the possible inferred types for the resulting schema.</span></span>  
  
|<span data-ttu-id="dc7ed-115">简单类型</span><span class="sxs-lookup"><span data-stu-id="dc7ed-115">Simple Type</span></span>|<span data-ttu-id="dc7ed-116">描述</span><span class="sxs-lookup"><span data-stu-id="dc7ed-116">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="dc7ed-117">boolean</span><span class="sxs-lookup"><span data-stu-id="dc7ed-117">boolean</span></span>|<span data-ttu-id="dc7ed-118">true、false、0、1.</span><span class="sxs-lookup"><span data-stu-id="dc7ed-118">True, false, 0, 1.</span></span>|  
|<span data-ttu-id="dc7ed-119">byte</span><span class="sxs-lookup"><span data-stu-id="dc7ed-119">byte</span></span>|<span data-ttu-id="dc7ed-120">范围在 –128 到 127 之间的整数。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-120">Integers in the range of –128 to 127.</span></span>|  
|<span data-ttu-id="dc7ed-121">unsignedByte</span><span class="sxs-lookup"><span data-stu-id="dc7ed-121">unsignedByte</span></span>|<span data-ttu-id="dc7ed-122">范围在 0 到 255 之间的整数。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-122">Integers in the range of 0 to 255.</span></span>|  
|<span data-ttu-id="dc7ed-123">short</span><span class="sxs-lookup"><span data-stu-id="dc7ed-123">short</span></span>|<span data-ttu-id="dc7ed-124">范围在 -32768 到 32767 之间的整数。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-124">Integers in the range of –32768 to 32767.</span></span>|  
|<span data-ttu-id="dc7ed-125">unsignedShort</span><span class="sxs-lookup"><span data-stu-id="dc7ed-125">unsignedShort</span></span>|<span data-ttu-id="dc7ed-126">范围在 0 到 65535 之间的整数。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-126">Integers in the range of 0 to 65535.</span></span>|  
|<span data-ttu-id="dc7ed-127">int</span><span class="sxs-lookup"><span data-stu-id="dc7ed-127">int</span></span>|<span data-ttu-id="dc7ed-128">范围在 -2147483648 到 2147483647 之间的整数。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-128">Integers in the range of –2147483648 to 2147483647.</span></span>|  
|<span data-ttu-id="dc7ed-129">unsignedInt</span><span class="sxs-lookup"><span data-stu-id="dc7ed-129">unsignedInt</span></span>|<span data-ttu-id="dc7ed-130">范围在 0 到 4294967295 之间的整数。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-130">Integers in the range of 0 to 4294967295.</span></span>|  
|<span data-ttu-id="dc7ed-131">long</span><span class="sxs-lookup"><span data-stu-id="dc7ed-131">long</span></span>|<span data-ttu-id="dc7ed-132">范围在 -9223372036854775808 到 9223372036854775807 之间的整数。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-132">Integers in the range of –9223372036854775808 to 9223372036854775807.</span></span>|  
|<span data-ttu-id="dc7ed-133">unsignedLong</span><span class="sxs-lookup"><span data-stu-id="dc7ed-133">unsignedLong</span></span>|<span data-ttu-id="dc7ed-134">范围在 0 到 18446744073709551615 之间的整数。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-134">Integers in the range of 0 to 18446744073709551615.</span></span>|  
|<span data-ttu-id="dc7ed-135">integer</span><span class="sxs-lookup"><span data-stu-id="dc7ed-135">integer</span></span>|<span data-ttu-id="dc7ed-136">可能使用“-”前缀的有穷位数字。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-136">A finite number of digits possibly prefixed with "-".</span></span>|  
|<span data-ttu-id="dc7ed-137">decimal</span><span class="sxs-lookup"><span data-stu-id="dc7ed-137">decimal</span></span>|<span data-ttu-id="dc7ed-138">精度为 0 到 28 位的数值。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-138">Numerical values that contain from 0 to 28 digits of precision.</span></span>|  
|<span data-ttu-id="dc7ed-139">float</span><span class="sxs-lookup"><span data-stu-id="dc7ed-139">float</span></span>|<span data-ttu-id="dc7ed-140">可以依次后接“E”或“e”和表示指数的整数值的十进制数。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-140">Decimals optionally followed by "E" or "e" followed by an integer value representing the exponent.</span></span> <span data-ttu-id="dc7ed-141">十进制值的范围可以在 -16777216 到 16777216 之间。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-141">Decimal values can be in the range of -16777216 to 16777216.</span></span> <span data-ttu-id="dc7ed-142">指数值的范围可以在 -149 到 104 之间。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-142">Exponent values can be in the range of –149 to 104.</span></span><br /><br /> <span data-ttu-id="dc7ed-143">float 允许表示无穷值和非数值的特殊值。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-143">Float allows for special values to represent infinity and non-numeric values.</span></span> <span data-ttu-id="dc7ed-144">特殊的浮点型值有：0、-0、INF、-INF、NaN。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-144">Special values for float are: 0, -0, INF, -INF, NaN.</span></span>|  
|<span data-ttu-id="dc7ed-145">double</span><span class="sxs-lookup"><span data-stu-id="dc7ed-145">double</span></span>|<span data-ttu-id="dc7ed-146">与 float 相同，只是十进制值的范围可以在 -9007199254740992 到 9007199254740992 之间，指数值的范围可以在 –1075 到 970 之间。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-146">The same as float except decimal values can be in the range of -9007199254740992 to 9007199254740992, and exponent values can be in the range of –1075 to 970.</span></span><br /><br /> <span data-ttu-id="dc7ed-147">double 允许表示无穷值和非数值的特殊值。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-147">Double allows for special values to represent infinity and non-numeric values.</span></span> <span data-ttu-id="dc7ed-148">特殊的浮点型值有：0、-0、INF、-INF、NaN。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-148">Special values for float are: 0, -0, INF, -INF, NaN.</span></span>|  
|<span data-ttu-id="dc7ed-149">duration</span><span class="sxs-lookup"><span data-stu-id="dc7ed-149">duration</span></span>|<span data-ttu-id="dc7ed-150">W3C duration 格式。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-150">The W3C duration format.</span></span>|  
|<span data-ttu-id="dc7ed-151">dateTime</span><span class="sxs-lookup"><span data-stu-id="dc7ed-151">dateTime</span></span>|<span data-ttu-id="dc7ed-152">W3C dateTime 格式。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-152">The W3C dateTime format.</span></span>|  
|<span data-ttu-id="dc7ed-153">time</span><span class="sxs-lookup"><span data-stu-id="dc7ed-153">time</span></span>|<span data-ttu-id="dc7ed-154">W3C time 格式。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-154">The W3C time format.</span></span>|  
|<span data-ttu-id="dc7ed-155">date</span><span class="sxs-lookup"><span data-stu-id="dc7ed-155">date</span></span>|<span data-ttu-id="dc7ed-156">年份值限制在 0001 到 9999 之间。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-156">Year values are restricted from 0001 to 9999.</span></span>|  
|<span data-ttu-id="dc7ed-157">gYearMonth</span><span class="sxs-lookup"><span data-stu-id="dc7ed-157">gYearMonth</span></span>|<span data-ttu-id="dc7ed-158">W3C 公历月份和年份的格式。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-158">The W3C Gregorian month and year format.</span></span>|  
|<span data-ttu-id="dc7ed-159">string</span><span class="sxs-lookup"><span data-stu-id="dc7ed-159">string</span></span>|<span data-ttu-id="dc7ed-160">一个或多个 Unicode 字符。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-160">One or more Unicode characters.</span></span>|  
  
## <a name="type-promotion"></a><span data-ttu-id="dc7ed-161">类型提升</span><span class="sxs-lookup"><span data-stu-id="dc7ed-161">Type Promotion</span></span>  

 <span data-ttu-id="dc7ed-162"><xref:System.Xml.Schema.XmlSchemaInference> 类一次检查一个属性和元素的值。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-162">The <xref:System.Xml.Schema.XmlSchemaInference> class examines attribute and element values one at a time.</span></span> <span data-ttu-id="dc7ed-163">在遇到值时，将推断限制性最强的无符号类型。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-163">As values are encountered, the most restrictive, unsigned type is inferred.</span></span> <span data-ttu-id="dc7ed-164">如果已推断了某个属性或元素的类型，在遇到与当前推断类型不匹配的新值时，推断类型将提升为新类型，以便适用于当前推断类型和新值。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-164">If a type has been inferred for an attribute or element, and a new value is encountered that does not match the currently inferred type, the inferred type is promoted to a new type that applies to both the currently inferred type and the new value.</span></span> <span data-ttu-id="dc7ed-165"><xref:System.Xml.Schema.XmlSchemaInference> 类在提升推断类型时会考虑以前的值。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-165">The <xref:System.Xml.Schema.XmlSchemaInference> class does consider previous values when promoting the inferred type.</span></span>  
  
 <span data-ttu-id="dc7ed-166">例如，考虑两个 XML 文档中的以下 XML 片断：</span><span class="sxs-lookup"><span data-stu-id="dc7ed-166">For example, consider the following XML fragments from two XML documents:</span></span>  
  
 `<MyElement1 attr1="12" />`  
  
 `<MyElement1 attr1="52344" />`  
  
 <span data-ttu-id="dc7ed-167">在遇到第一个 `attr1` 值时，根据值 `attr1`，`unsignedByte` 的类型推断为 `12`。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-167">When the first `attr1` value is encountered, the type of `attr1` is inferred as `unsignedByte` based on the value `12`.</span></span> <span data-ttu-id="dc7ed-168">在遇到第二个 `attr1` 时，根据当前推断类型 `unsignedShort` 和当前值 `unsignedByte`，类型提升为 `52344`。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-168">When the second `attr1` is encountered, the type is promoted to `unsignedShort` based on the currently inferred type of `unsignedByte` and the current value `52344`.</span></span>  
  
 <span data-ttu-id="dc7ed-169">现在，考虑两个 XML 文档中的以下 XML：</span><span class="sxs-lookup"><span data-stu-id="dc7ed-169">Now, consider the following XML from two XML documents:</span></span>  
  
 `<MyElement2 attr2="0" />`  
  
 `<MyElement2 attr2="true" />`  
  
 <span data-ttu-id="dc7ed-170">在遇到第一个 `attr2` 值时，根据值 `attr2`，`unsignedByte` 的类型推断为 `0`。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-170">When the first `attr2` value is encountered, the type of `attr2` is inferred as `unsignedByte` based on the value `0`.</span></span> <span data-ttu-id="dc7ed-171">在遇到第二个 `attr2` 时，根据当前推断类型 `string` 和当前值 `unsignedByte`，类型提升为 `true`，因为 <xref:System.Xml.Schema.XmlSchemaInference> 类在提升推断类型时会考虑以前的值。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-171">When the second `attr2` is encountered, the type is promoted to `string` based on the currently inferred type of `unsignedByte` and the current value `true` because the <xref:System.Xml.Schema.XmlSchemaInference> class does consider previous values when promoting the inferred type.</span></span> <span data-ttu-id="dc7ed-172">但是，如果在同一个 XML 文档中遇到 `attr2` 的两个实例，而不是如上所述在两个不同的 XML 文档中，`attr2` 将推断为 `boolean`。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-172">However, if both instances of `attr2` were encountered in the same XML document and not in two different XML documents as illustrated above, `attr2` would have been inferred as `boolean`.</span></span>  
  
### <a name="ignored-attributes-from-the-httpswwww3org2001xmlschema-instance-namespace"></a><span data-ttu-id="dc7ed-173">从 <https://www.w3.org/2001/XMLSchema-instance> 命名空间忽略的属性</span><span class="sxs-lookup"><span data-stu-id="dc7ed-173">Ignored attributes from the <https://www.w3.org/2001/XMLSchema-instance> namespace</span></span>

<span data-ttu-id="dc7ed-174">在架构引用过程中忽略下列架构定义属性。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-174">The following are schema-defining attributes that are ignored during schema inference.</span></span>  
  
|<span data-ttu-id="dc7ed-175">特性</span><span class="sxs-lookup"><span data-stu-id="dc7ed-175">Attribute</span></span>|<span data-ttu-id="dc7ed-176">描述</span><span class="sxs-lookup"><span data-stu-id="dc7ed-176">Description</span></span>|  
|---------------|-----------------|  
|`xsi:type`|<span data-ttu-id="dc7ed-177">如果遇到指定了 `xsi:type` 类型的元素，将忽略 `xsi:type`。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-177">If an element is encountered with `xsi:type` specified, the `xsi:type` is ignored.</span></span>|  
|`xsi:nil`|<span data-ttu-id="dc7ed-178">如果遇到具有 `xsi:nil` 属性的元素，推断架构中的元素声明的值将为 `nillable="true"`。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-178">If an element with an `xsi:nil` attribute is encountered, its element declaration in the inferred schema has the value of `nillable="true"`.</span></span> <span data-ttu-id="dc7ed-179">`xsi:nil` 属性设置为 `true` 的元素不能包含子元素。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-179">An element with an `xsi:nil` attribute set to `true` cannot have child elements.</span></span>|  
|`xsi:schemaLocation`|<span data-ttu-id="dc7ed-180">如果遇到 `xsi:schemaLocation`，将忽略。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-180">If `xsi:schemaLocation` is encountered, it is ignored.</span></span>|  
|`xsi:noNamespaceSchemaLocation`|<span data-ttu-id="dc7ed-181">如果遇到 `xsi:noNamespaceSchemaLocation`，将忽略。</span><span class="sxs-lookup"><span data-stu-id="dc7ed-181">If `xsi:noNamespaceSchemaLocation` is encountered, it is ignored.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="dc7ed-182">请参阅</span><span class="sxs-lookup"><span data-stu-id="dc7ed-182">See also</span></span>

- [<span data-ttu-id="dc7ed-183">XML 架构对象模型 (SOM)</span><span class="sxs-lookup"><span data-stu-id="dc7ed-183">XML Schema Object Model (SOM)</span></span>](xml-schema-object-model-som.md)
- [<span data-ttu-id="dc7ed-184">从 XML 文档推断架构</span><span class="sxs-lookup"><span data-stu-id="dc7ed-184">Inferring Schemas from XML Documents</span></span>](inferring-schemas-from-xml-documents.md)
- [<span data-ttu-id="dc7ed-185">推断架构节点类型和结构的规则</span><span class="sxs-lookup"><span data-stu-id="dc7ed-185">Rules for Inferring Schema Node Types and Structure</span></span>](rules-for-inferring-schema-node-types-and-structure.md)
