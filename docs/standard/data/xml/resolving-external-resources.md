---
title: 解析外部资源
ms.date: 03/30/2017
ms.assetid: ad3fa320-4b8f-4e5c-b549-01157591007a
ms.openlocfilehash: 460fee3464c7de9a6ad0ca97bf5341fe5078fb47
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/18/2020
ms.locfileid: "94820366"
---
# <a name="resolving-external-resources"></a><span data-ttu-id="d1cb2-102">解析外部资源</span><span class="sxs-lookup"><span data-stu-id="d1cb2-102">Resolving External Resources</span></span>
<span data-ttu-id="d1cb2-103">XmlDocument  类使用 XmlDocument  的 XmlResolver  属性，定位没有在 XML 数据中内联的资源，如外部文档类型定义 (DTD)、实体和架构。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-103">The **XmlResolver** property of the **XmlDocument** is used by the **XmlDocument** class to locate resources that are not inline in the XML data, such as external document type definitions (DTDs), entities, and schemas.</span></span> <span data-ttu-id="d1cb2-104">这些项可以位于网络或本地驱动器上，并通过统一资源标识符 (URI) 进行标识。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-104">These items can be located on a network or on a local drive, and are identifiable by a Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="d1cb2-105">这样一来，XmlDocument  可以解析文档中的 EntityReference  节点，并根据外部 DTD 或架构验证文档。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-105">This allows the **XmlDocument** to resolve **EntityReference** nodes that are present in the document and validate the document according to the external DTD or schema.</span></span>  
  
## <a name="fully-trusted-xmldocument"></a><span data-ttu-id="d1cb2-106">完全受信任的 XmlDocument</span><span class="sxs-lookup"><span data-stu-id="d1cb2-106">Fully-Trusted XmlDocument</span></span>  
 <span data-ttu-id="d1cb2-107">XmlResolver  属性影响 XmlDocument.Load  方法的功能。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-107">The **XmlResolver** property affects the functionality of the **XmlDocument.Load** method.</span></span> <span data-ttu-id="d1cb2-108">下表展示了 XmlDocument.XmlResolver  属性在 XmlDocument  对象完全受信任时的工作原理。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-108">The table below shows how the **XmlDocument.XmlResolver** property works when the **XmlDocument** object is fully trusted.</span></span> <span data-ttu-id="d1cb2-109">下表展示了 Load 输入是 TextReader  、String  、Stream  或 URI  时的 XmlDocument.Load  方法。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-109">The following table shows the **XmlDocument.Load** methods when the input to the Load is a **TextReader**, **String**, **Stream**, or **URI**.</span></span> <span data-ttu-id="d1cb2-110">如果 XmlDocument  是从 XmlReader  中加载，此表不适用于 Load  方法。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-110">This table does not apply to the **Load** method if the **XmlDocument** is loaded from an **XmlReader**.</span></span>  
  
|<span data-ttu-id="d1cb2-111">XmlResolver 属性</span><span class="sxs-lookup"><span data-stu-id="d1cb2-111">XmlResolver property</span></span>|<span data-ttu-id="d1cb2-112">函数</span><span class="sxs-lookup"><span data-stu-id="d1cb2-112">Function</span></span>|<span data-ttu-id="d1cb2-113">说明</span><span class="sxs-lookup"><span data-stu-id="d1cb2-113">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="d1cb2-114">属性设置为之前创建且用户已设置属性的 XmlResolver  类。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-114">The property is set to an **XmlResolver** class that has been previously created and has properties already set on it by the user.</span></span>|<span data-ttu-id="d1cb2-115">XmlDocument  使用给定的 XmlResolver  ，以解析文件名、对外部资源（如 DTD、实体和架构）的引用。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-115">The **XmlDocument** uses the **XmlResolver** that is given to resolve file names, to resolve references to external resources such as DTDs, entities, and schemas.</span></span><br /><br /> <span data-ttu-id="d1cb2-116">XmlResolver  还用来解析在 XmlDocument  中添加或编辑节点时需要的外部资源。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-116">The **XmlResolver** is also used when resolving external resources that are needed when adding or editing nodes in the **XmlDocument**.</span></span>|<span data-ttu-id="d1cb2-117">指定给 XmlDocument  的 XmlResolver  是，每当需要定位和解析外部资源时使用的解析程序。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-117">The **XmlResolver** given to the **XmlDocument** is the resolver that is used whenever external resources need to be located and resolved.</span></span>|  
|<span data-ttu-id="d1cb2-118">此属性设置为 null  （Microsoft Visual Basic .NET 中的 Nothing  ）。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-118">The property is set to **null** (**Nothing** in Microsoft Visual Basic .NET).</span></span>|<span data-ttu-id="d1cb2-119">不支持需要外部资源的功能，如定位外部架构或 DTD。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-119">Features that require an external resource are not supported, such as locating an external schema, or DTD.</span></span> <span data-ttu-id="d1cb2-120">也不能解析外部实体，而且也不支持执行编辑功能（如插入需要解析的实体节点）。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-120">Nor will external entities be resolved, and performing editing functions, such as inserting entity nodes that require resolution, are not supported.</span></span>|<span data-ttu-id="d1cb2-121">XmlDocument  将文件加载为匿名文件，而且不尝试解析其他任何资源。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-121">The **XmlDocument** loads files as anonymous and does not attempt to resolve any other resources.</span></span>|  
|<span data-ttu-id="d1cb2-122">不设置此属性，而是将其保留为默认状态。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-122">The property is not set, but left in its default state.</span></span>|<span data-ttu-id="d1cb2-123">解析文件名和定位外部 DTD、实体和架构时，XmlDocument  实例化并使用含 NULL 凭据的 XmlUrlResolver  ，null  凭据在编辑节点时使用。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-123">An **XmlUrlResolver** with NULL credentials will be instantiated and used by the **XmlDocument** when resolving file names, locating external DTDs, entities, and schemas, and **null** credentials are used when editing nodes.</span></span>||  
  
 <span data-ttu-id="d1cb2-124">下表展示了 Load  输入是 XmlReader  且 XmlDocument  完全受信任时的 XmlDocument.Load  方法。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-124">The following table shows the **XmlDocument.Load** method when the input to the **Load** is an **XmlReader** and the **XmlDocument** is fully trusted.</span></span>  
  
|<span data-ttu-id="d1cb2-125">XmlResolver 属性</span><span class="sxs-lookup"><span data-stu-id="d1cb2-125">XmlResolver property</span></span>|<span data-ttu-id="d1cb2-126">函数</span><span class="sxs-lookup"><span data-stu-id="d1cb2-126">Function</span></span>|<span data-ttu-id="d1cb2-127">说明</span><span class="sxs-lookup"><span data-stu-id="d1cb2-127">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="d1cb2-128">XmlDocument  使用的 XmlResolver  类与 XmlReader  使用的类相同。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-128">The **XmlResolver** class used by the **XmlDocument** is the same class being used by the **XmlReader**.</span></span>|<span data-ttu-id="d1cb2-129">XmlDocument  使用分配给 XmlReader  的 XmlResolver  。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-129">The **XmlDocument** uses the **XmlResolver** that was assigned to the **XmlReader**.</span></span><br /><br /> <span data-ttu-id="d1cb2-130">无论 XmlDocument  信任级别如何，都无法设置 XmlDocument.Resolver  属性，因为它是从 XmlReader  获取 XmlResolver  。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-130">The **XmlDocument.Resolver** property cannot be set, regardless of the **XmlDocument** trust level, because it is getting an **XmlResolver** from the **XmlReader**.</span></span> <span data-ttu-id="d1cb2-131">不能试图通过设置 XmlDocument  的 XmlResolver  属性来重写 XmlReaders  的 XmlResolver  设置。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-131">You cannot attempt to override the settings of the **XmlReaders**' **XmlResolver** by setting the **XmlResolver** property of the **XmlDocument**.</span></span>|<span data-ttu-id="d1cb2-132">XmlReader  可以是 XmlTextReader  、XmlValidatingReader  或自定义编写的读取器。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-132">The **XmlReader** can be the **XmlTextReader**, **XmlValidatingReader**, or a custom-written reader.</span></span> <span data-ttu-id="d1cb2-133">如果使用的读取器支持实体解析，则解析外部实体。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-133">If the reader used supports entity resolution, external entities are resolved.</span></span> <span data-ttu-id="d1cb2-134">如果传递的读取器不支持实体引用，那么就不解析实体引用。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-134">If the reader passed does not support entity references, then entity references are not resolved.</span></span>|  
  
## <a name="semi-trusted-xmldocument"></a><span data-ttu-id="d1cb2-135">不完全受信任的 XmlDocument</span><span class="sxs-lookup"><span data-stu-id="d1cb2-135">Semi-Trusted XmlDocument</span></span>  
 <span data-ttu-id="d1cb2-136">下表展示了 XmlDocument.XmlResolver  属性在对象不完全受信任时的工作原理。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-136">The following table shows how the **XmlDocument.XmlResolver** property works when the object is semi-trusted.</span></span> <span data-ttu-id="d1cb2-137">如果 Load 输入是 TextReader  、String  、Stream  或 URI  时，此表适用于 XmlDocument.Load  方法。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-137">This table applies to the **XmlDocument.Load** methods when the input to the Load is a **TextReader**, **String**, **Stream**, or **URI**.</span></span> <span data-ttu-id="d1cb2-138">如果 XmlDocument  是从 XmlReader  中加载，此表不适用于 Load  方法。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-138">This table does not apply to the **Load** method if the **XmlDocument** is loaded from an **XmlReader**.</span></span>  
  
|<span data-ttu-id="d1cb2-139">XmlResolver 属性</span><span class="sxs-lookup"><span data-stu-id="d1cb2-139">XmlResolver property</span></span>|<span data-ttu-id="d1cb2-140">函数</span><span class="sxs-lookup"><span data-stu-id="d1cb2-140">Function</span></span>|<span data-ttu-id="d1cb2-141">说明</span><span class="sxs-lookup"><span data-stu-id="d1cb2-141">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="d1cb2-142">在不完全受信任的方案中，XmlResolver  属性只能设置为 null。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-142">In the semi-trusted scenario, the **XmlResolver** property cannot be set to anything other than null.</span></span>|<span data-ttu-id="d1cb2-143">解析文件名和定位外部 DTD、实体和架构时，XmlDocument  实例化并使用含 null  凭据的 XmlUrlResolver  ，null  凭据在编辑节点时使用。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-143">An **XmlUrlResolver** with **null** credentials will be instantiated and used by the **XmlDocument** when resolving file names, locating external DTDs, entities, and schemas, and **null** credentials are used when editing nodes.</span></span>|<span data-ttu-id="d1cb2-144">此行为与不设置  XmlResolver 而是保持为默认状态时的行为完全相同。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-144">This behavior is identical to the behavior when the **XmlResolver** property is not set, but left in its default state.</span></span><br /><br /> <span data-ttu-id="d1cb2-145">XmlDocument  对所有操作使用匿名权限。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-145">The **XmlDocument** uses anonymous permissions for all actions.</span></span>|  
|<span data-ttu-id="d1cb2-146">此属性设置为 null  （Microsoft Visual Basic .NET 中的 Nothing  ）。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-146">The property is set to **null** (**Nothing** in Microsoft Visual Basic .NET).</span></span>|<span data-ttu-id="d1cb2-147">不支持需要外部资源的功能，如定位外部架构或 DTD。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-147">No features that require an external resource are supported, such as locating an external schema or DTD.</span></span> <span data-ttu-id="d1cb2-148">也不能解析外部实体，而且也不支持执行编辑功能（如插入需要解析的实体节点）。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-148">Nor will external entities be resolved, and performing editing functions such as inserting entity nodes that require resolution, are not supported.</span></span>|<span data-ttu-id="d1cb2-149">如果属性为 null  ，行为是相同的，不管 XmlDocument  是完全受信任，还是不完全受信任。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-149">When the property is **null**, the behavior is the same regardless if the **XmlDocument** is fully trusted or semi-trusted.</span></span>|  
|<span data-ttu-id="d1cb2-150">不设置此属性，而是将其保留为默认状态。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-150">The property is not set, but left in its default state.</span></span>|<span data-ttu-id="d1cb2-151">解析文件名和定位外部 DTD、实体和架构时，XmlDocument  实例化并使用含 null  凭据的 XmlUrlResolver  ，null  凭据在编辑节点时使用。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-151">An **XmlUrlResolver** with **null** credentials will be instantiated and used by the **XmlDocument** when resolving file names, locating external DTDs, entities, and schemas, and **null** credentials are used when editing nodes.</span></span>|<span data-ttu-id="d1cb2-152">XmlDocument  对所有操作使用匿名权限。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-152">The **XmlDocument** uses anonymous permissions for all actions.</span></span>|  
  
 <span data-ttu-id="d1cb2-153">如果 Load  输入是 XmlReader  且 XmlDocument  不完全受信任，此表适用于 XmlDocument.Load  方法。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-153">This table applies to the **XmlDocument.Load** method when the input to the **Load** is an **XmlReader**, and the **XmlDocument** is semi-trusted.</span></span>  
  
|<span data-ttu-id="d1cb2-154">XmlResolver 属性</span><span class="sxs-lookup"><span data-stu-id="d1cb2-154">XmlResolver property</span></span>|<span data-ttu-id="d1cb2-155">函数</span><span class="sxs-lookup"><span data-stu-id="d1cb2-155">Function</span></span>|<span data-ttu-id="d1cb2-156">说明</span><span class="sxs-lookup"><span data-stu-id="d1cb2-156">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="d1cb2-157">XmlDocument  使用的 XmlResolver  类与 XmlReader  使用的类相同。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-157">The **XmlResolver** class used by the **XmlDocument** is the same one being used by the **XmlReader**.</span></span>|<span data-ttu-id="d1cb2-158">XmlDocument  使用分配给 XmlReader  的 XmlResolver  。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-158">The **XmlDocument** uses the **XmlResolver** that was assigned to the **XmlReader**.</span></span><br /><br /> <span data-ttu-id="d1cb2-159">无论 XmlDocument  信任级别如何，都无法设置 XmlDocument.Resolver  属性，因为它是从 XmlReader  获取 XmlResolver  。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-159">The **XmlDocument.Resolver** property cannot be set, regardless of the **XmlDocument** trust level, because it is getting an **XmlResolver** from the **XmlReader**.</span></span> <span data-ttu-id="d1cb2-160">不能试图通过设置 XmlDocument  的 XmlResolver  属性来重写 XmlReaders  的 XmlResolver  设置。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-160">You cannot attempt to override the settings of the **XmlReaders** **XmlResolver** by setting the **XmlResolver** property of the **XmlDocument**.</span></span>|<span data-ttu-id="d1cb2-161">XmlReader  可以是 XmlTextReader  、验证 <xref:System.Xml.XmlReader> 或自定义编写的读取器。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-161">The **XmlReader** can be the **XmlTextReader**, validating <xref:System.Xml.XmlReader>, or a custom-written reader.</span></span> <span data-ttu-id="d1cb2-162">如果使用的读取器支持实体解析，则解析外部实体。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-162">If the reader used supports entity resolution, external entities are resolved.</span></span> <span data-ttu-id="d1cb2-163">如果传递的读取器不支持实体引用，那么就不解析实体引用。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-163">If the reader passed in does not support entity references, then entity references are not resolved.</span></span>|  
  
 <span data-ttu-id="d1cb2-164">将 XmlResolver 设置为包含正确的凭据后，将可以访问外部资源。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-164">Setting the XmlResolver to contain the correct credentials allows access to external resources.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="d1cb2-165">无法检索 XmlResolver  属性。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-165">There is no way to retrieve the **XmlResolver** property.</span></span> <span data-ttu-id="d1cb2-166">这有助于防止用户重用已设置凭据的 XmlResolver  。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-166">This helps to prevent a user from reusing an **XmlResolver** on which credentials have been set.</span></span> <span data-ttu-id="d1cb2-167">此外，如果使用 XmlTextReader  或验证 <xref:System.Xml.XmlReader> 加载 XmlDocument  ，且 XmlDocument  有已设置的解析程序，XmlDocument  在 Load  阶段后不缓存这些读取器中的解析程序，因为这也会带来安全风险。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-167">Also, if an **XmlTextReader** or validating <xref:System.Xml.XmlReader> is used to load the **XmlDocument** and the **XmlDocument** has a resolver that has been set, the resolvers from these readers are not cached by the **XmlDocument** after the **Load** phase, since this also presents a security risk.</span></span>  
  
 <span data-ttu-id="d1cb2-168">有关详细信息，请参阅 <xref:System.Xml.XmlResolver> 引用页的“备注”部分。</span><span class="sxs-lookup"><span data-stu-id="d1cb2-168">For more information, see the Remarks section of the <xref:System.Xml.XmlResolver> reference page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d1cb2-169">请参阅</span><span class="sxs-lookup"><span data-stu-id="d1cb2-169">See also</span></span>

- [<span data-ttu-id="d1cb2-170">XML 文档对象模型 (DOM)</span><span class="sxs-lookup"><span data-stu-id="d1cb2-170">XML Document Object Model (DOM)</span></span>](xml-document-object-model-dom.md)
