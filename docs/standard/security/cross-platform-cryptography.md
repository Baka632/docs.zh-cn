---
title: .NET Core 和 .NET 5 中的跨平台加密
description: 了解 .NET 支持的平台上的加密功能。
ms.date: 06/19/2020
ms.technology: dotnet-standard
helpviewer_keywords:
- cryptography, cross-platform
- encryption, cross-platform
ms.openlocfilehash: 61fd49e53761deac278b770003eb97241b6c2be9
ms.sourcegitcommit: b7a8b09828bab4e90f66af8d495ecd7024c45042
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87557146"
---
# <a name="cross-platform-cryptography-in-net-core-and-net-5"></a><span data-ttu-id="e6ea9-103">.NET Core 和 .NET 5 中的跨平台加密</span><span class="sxs-lookup"><span data-stu-id="e6ea9-103">Cross-Platform Cryptography in .NET Core and .NET 5</span></span>

<span data-ttu-id="e6ea9-104">.NET Core 和 .NET 5 中的加密操作由操作系统 (操作系统) 库完成。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-104">Cryptographic operations in .NET Core and .NET 5 are done by operating system (OS) libraries.</span></span> <span data-ttu-id="e6ea9-105">此依赖项具有以下优势：</span><span class="sxs-lookup"><span data-stu-id="e6ea9-105">This dependency has advantages:</span></span>

* <span data-ttu-id="e6ea9-106">.NET 应用从操作系统可靠性中获益。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-106">.NET apps benefit from OS reliability.</span></span> <span data-ttu-id="e6ea9-107">为操作系统供应商提供了高优先级的安全加密库，使其免受漏洞的侵害。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-107">Keeping cryptography libraries safe from vulnerabilities is a high priority for OS vendors.</span></span> <span data-ttu-id="e6ea9-108">为此，它们提供了系统管理员应应用的更新。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-108">To do that, they provide updates that system administrators should be applying.</span></span>
* <span data-ttu-id="e6ea9-109">如果 OS 库是 FIPS 验证的，则 .NET 应用有权访问经过 FIPS 验证的算法。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-109">.NET apps have access to FIPS-validated algorithms if the OS libraries are FIPS-validated.</span></span>

<span data-ttu-id="e6ea9-110">对 OS 库的依赖也意味着，.NET 应用只能使用操作系统支持的加密功能。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-110">The dependency on OS libraries also means that .NET apps can only use cryptographic features that the OS supports.</span></span> <span data-ttu-id="e6ea9-111">虽然所有平台都支持某些核心功能，但 .NET 支持的某些功能无法在某些平台上使用。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-111">While all platforms support certain core features, some features that .NET supports can't be used on some platforms.</span></span> <span data-ttu-id="e6ea9-112">本文列出了每个平台支持的功能。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-112">This article identifies the features that are supported on each platform.</span></span>

<span data-ttu-id="e6ea9-113">本文假设你已熟悉如何在 .NET 中进行加密。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-113">This article assumes you have a working familiarity with cryptography in .NET.</span></span> <span data-ttu-id="e6ea9-114">有关详细信息，请参阅[.Net 加密模型](cryptography-model.md)和[.net 加密服务](cryptographic-services.md)。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-114">For more information, see [.NET Cryptography Model](cryptography-model.md) and [.NET Cryptographic Services](cryptographic-services.md).</span></span>

## <a name="hash-algorithms"></a><span data-ttu-id="e6ea9-115">哈希算法</span><span class="sxs-lookup"><span data-stu-id="e6ea9-115">Hash algorithms</span></span>

<span data-ttu-id="e6ea9-116">所有哈希算法和基于哈希的消息身份验证 (HMAC) 类（包括 `*Managed` 类）遵从操作系统库。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-116">All hash algorithm and hash-based message authentication (HMAC) classes, including the `*Managed` classes, defer to the OS libraries.</span></span> <span data-ttu-id="e6ea9-117">尽管各种 OS 库的性能有所不同，但它们应该是兼容的。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-117">While the various OS libraries differ in performance, they should be compatible.</span></span>

## <a name="symmetric-encryption"></a><span data-ttu-id="e6ea9-118">对称加密</span><span class="sxs-lookup"><span data-stu-id="e6ea9-118">Symmetric encryption</span></span>

<span data-ttu-id="e6ea9-119">基本的密码和链接由系统库完成，所有平台都支持所有这些操作。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-119">The underlying ciphers and chaining are done by the system libraries, and all are supported by all platforms.</span></span>

| <span data-ttu-id="e6ea9-120">密码 + 模式</span><span class="sxs-lookup"><span data-stu-id="e6ea9-120">Cipher + Mode</span></span> | <span data-ttu-id="e6ea9-121">Windows</span><span class="sxs-lookup"><span data-stu-id="e6ea9-121">Windows</span></span> | <span data-ttu-id="e6ea9-122">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-122">Linux</span></span> | <span data-ttu-id="e6ea9-123">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-123">macOS</span></span> |
|---------------|---------|-------|-------|
| <span data-ttu-id="e6ea9-124">AES-CBC</span><span class="sxs-lookup"><span data-stu-id="e6ea9-124">AES-CBC</span></span>       | <span data-ttu-id="e6ea9-125">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-125">✔️</span></span>     | <span data-ttu-id="e6ea9-126">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-126">✔️</span></span>    | <span data-ttu-id="e6ea9-127">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-127">✔️</span></span>   |
| <span data-ttu-id="e6ea9-128">AES-ECB</span><span class="sxs-lookup"><span data-stu-id="e6ea9-128">AES-ECB</span></span>       | <span data-ttu-id="e6ea9-129">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-129">✔️</span></span>     | <span data-ttu-id="e6ea9-130">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-130">✔️</span></span>    | <span data-ttu-id="e6ea9-131">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-131">✔️</span></span>   |
| <span data-ttu-id="e6ea9-132">3DES-CBC</span><span class="sxs-lookup"><span data-stu-id="e6ea9-132">3DES-CBC</span></span>      | <span data-ttu-id="e6ea9-133">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-133">✔️</span></span>     | <span data-ttu-id="e6ea9-134">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-134">✔️</span></span>    | <span data-ttu-id="e6ea9-135">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-135">✔️</span></span>   |
| <span data-ttu-id="e6ea9-136">3DES-ECB</span><span class="sxs-lookup"><span data-stu-id="e6ea9-136">3DES-ECB</span></span>      | <span data-ttu-id="e6ea9-137">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-137">✔️</span></span>     | <span data-ttu-id="e6ea9-138">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-138">✔️</span></span>    | <span data-ttu-id="e6ea9-139">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-139">✔️</span></span>   |
| <span data-ttu-id="e6ea9-140">DES-CBC</span><span class="sxs-lookup"><span data-stu-id="e6ea9-140">DES-CBC</span></span>       | <span data-ttu-id="e6ea9-141">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-141">✔️</span></span>     | <span data-ttu-id="e6ea9-142">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-142">✔️</span></span>    | <span data-ttu-id="e6ea9-143">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-143">✔️</span></span>   |
| <span data-ttu-id="e6ea9-144">DES-ECB</span><span class="sxs-lookup"><span data-stu-id="e6ea9-144">DES-ECB</span></span>       | <span data-ttu-id="e6ea9-145">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-145">✔️</span></span>     | <span data-ttu-id="e6ea9-146">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-146">✔️</span></span>    | <span data-ttu-id="e6ea9-147">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-147">✔️</span></span>   |

## <a name="authenticated-encryption"></a><span data-ttu-id="e6ea9-148">经过身份验证的加密</span><span class="sxs-lookup"><span data-stu-id="e6ea9-148">Authenticated encryption</span></span>

<span data-ttu-id="e6ea9-149">经过身份验证的加密 (通过和类为 AES-CCM 和 AES 提供) 支持 <xref:System.Security.Cryptography.AesCcm?displayProperty=fullName> <xref:System.Security.Cryptography.AesGcm?displayProperty=fullName> 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-149">Authenticated encryption (AE) support is provided for AES-CCM and AES-GCM via the <xref:System.Security.Cryptography.AesCcm?displayProperty=fullName> and <xref:System.Security.Cryptography.AesGcm?displayProperty=fullName> classes.</span></span>

<span data-ttu-id="e6ea9-150">在 Windows 和 Linux 上，由 OS 库提供 AES-CCM 和 AES GCM 的实现。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-150">On Windows and Linux, the implementations of AES-CCM and AES-GCM are provided by the OS libraries.</span></span>

### <a name="aes-ccm-and-aes-gcm-on-macos"></a><span data-ttu-id="e6ea9-151">MacOS 上的 AES-CCM 和 AES-GCM</span><span class="sxs-lookup"><span data-stu-id="e6ea9-151">AES-CCM and AES-GCM on macOS</span></span>

<span data-ttu-id="e6ea9-152">在 macOS 上，系统库不支持第三方代码的 AES-CCM 或 AES-GCM，因此 <xref:System.Security.Cryptography.AesCcm> 和 <xref:System.Security.Cryptography.AesGcm> 类使用 OpenSSL 来提供支持。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-152">On macOS, the system libraries don't support AES-CCM or AES-GCM for third-party code, so the <xref:System.Security.Cryptography.AesCcm> and <xref:System.Security.Cryptography.AesGcm> classes use OpenSSL for support.</span></span> <span data-ttu-id="e6ea9-153">MacOS 上的用户需要获取 OpenSSL (libcrypto) 的相应副本，这些类型才能正常工作，并且它必须位于系统默认加载库的路径中。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-153">Users on macOS need to obtain an appropriate copy of OpenSSL (libcrypto) for these types to function, and it must be in a path that the system would load a library from by default.</span></span> <span data-ttu-id="e6ea9-154">建议从包管理器（例如 Homebrew）安装 OpenSSL。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-154">We recommend that you install OpenSSL from a package manager such as Homebrew.</span></span>

<span data-ttu-id="e6ea9-155">`libcrypto.0.9.7.dylib` `libcrypto.0.9.8.dylib` MacOS 中包含的和库来自早期版本的 OpenSSL，不会使用。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-155">The `libcrypto.0.9.7.dylib` and `libcrypto.0.9.8.dylib` libraries included in macOS are from earlier versions of OpenSSL and will not be used.</span></span> <span data-ttu-id="e6ea9-156">`libcrypto.35.dylib`、 `libcrypto.41.dylib` 和 `libcrypto.42.dylib` 库来自 LibreSSL，不会使用。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-156">The `libcrypto.35.dylib`, `libcrypto.41.dylib`, and `libcrypto.42.dylib` libraries are from LibreSSL and will not be used.</span></span>

### <a name="aes-ccm-keys-nonces-and-tags"></a><span data-ttu-id="e6ea9-157">AES-CCM 密钥、nonce 和标记</span><span class="sxs-lookup"><span data-stu-id="e6ea9-157">AES-CCM keys, nonces, and tags</span></span>

* <span data-ttu-id="e6ea9-158">密钥大小</span><span class="sxs-lookup"><span data-stu-id="e6ea9-158">Key Sizes</span></span>

  <span data-ttu-id="e6ea9-159">AES-CCM 适用于128、192和256位密钥。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-159">AES-CCM works with 128, 192, and 256-bit keys.</span></span>

* <span data-ttu-id="e6ea9-160">Nonce 大小</span><span class="sxs-lookup"><span data-stu-id="e6ea9-160">Nonce Sizes</span></span>

  <span data-ttu-id="e6ea9-161"><xref:System.Security.Cryptography.AesCcm>类支持56、64、72、80、88、96和 104 (7、8、9、10、11、12和13字节) nonce。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-161">The <xref:System.Security.Cryptography.AesCcm> class supports 56, 64, 72, 80, 88, 96, and 104-bit (7, 8, 9, 10, 11, 12, and 13-byte) nonces.</span></span>

* <span data-ttu-id="e6ea9-162">标记大小</span><span class="sxs-lookup"><span data-stu-id="e6ea9-162">Tag Sizes</span></span>

  <span data-ttu-id="e6ea9-163"><xref:System.Security.Cryptography.AesCcm>类支持创建或处理32、48、64、80、96、112和 128 (4、8、10、12、14和16字节) 标记。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-163">The <xref:System.Security.Cryptography.AesCcm> class supports creating or processing 32, 48, 64, 80, 96, 112, and 128-bit (4, 8, 10, 12, 14, and 16-byte) tags.</span></span>

### <a name="aes-gcm-keys-nonces-and-tags"></a><span data-ttu-id="e6ea9-164">AES-GCM 密钥、nonce 和标记</span><span class="sxs-lookup"><span data-stu-id="e6ea9-164">AES-GCM keys, nonces, and tags</span></span>

* <span data-ttu-id="e6ea9-165">密钥大小</span><span class="sxs-lookup"><span data-stu-id="e6ea9-165">Key Sizes</span></span>

  <span data-ttu-id="e6ea9-166">AES-GCM 适用于128、192和256位密钥。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-166">AES-GCM works with 128, 192, and 256-bit keys.</span></span>

* <span data-ttu-id="e6ea9-167">Nonce 大小</span><span class="sxs-lookup"><span data-stu-id="e6ea9-167">Nonce Sizes</span></span>

  <span data-ttu-id="e6ea9-168"><xref:System.Security.Cryptography.AesGcm>类仅支持96位 (12 字节的) nonce。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-168">The <xref:System.Security.Cryptography.AesGcm> class supports only 96-bit (12-byte) nonces.</span></span>

* <span data-ttu-id="e6ea9-169">标记大小</span><span class="sxs-lookup"><span data-stu-id="e6ea9-169">Tag Sizes</span></span>

  <span data-ttu-id="e6ea9-170"><xref:System.Security.Cryptography.AesGcm>类支持创建或处理96、104、112、120和 128 (12、13、14、15和16字节的) 标记。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-170">The <xref:System.Security.Cryptography.AesGcm> class supports creating or processing 96, 104, 112, 120, and 128-bit (12, 13, 14, 15, and 16-byte) tags.</span></span>

## <a name="asymmetric-cryptography"></a><span data-ttu-id="e6ea9-171">非对称加密</span><span class="sxs-lookup"><span data-stu-id="e6ea9-171">Asymmetric cryptography</span></span>

<span data-ttu-id="e6ea9-172">本部分包括以下小节：</span><span class="sxs-lookup"><span data-stu-id="e6ea9-172">This section includes the following subsections:</span></span>

* [<span data-ttu-id="e6ea9-173">RSA</span><span class="sxs-lookup"><span data-stu-id="e6ea9-173">RSA</span></span>](#rsa)
* [<span data-ttu-id="e6ea9-174">ECDSA</span><span class="sxs-lookup"><span data-stu-id="e6ea9-174">ECDSA</span></span>](#ecdsa)
* [<span data-ttu-id="e6ea9-175">ECDH</span><span class="sxs-lookup"><span data-stu-id="e6ea9-175">ECDH</span></span>](#ecdh)
* [<span data-ttu-id="e6ea9-176">DSA</span><span class="sxs-lookup"><span data-stu-id="e6ea9-176">DSA</span></span>](#dsa)

### <a name="rsa"></a><span data-ttu-id="e6ea9-177">RSA</span><span class="sxs-lookup"><span data-stu-id="e6ea9-177">RSA</span></span>

<span data-ttu-id="e6ea9-178">RSA (Rivest – Rivest-shamir-adleman – Rivest-shamir-adleman) 密钥生成由 OS 库执行，并受其大小限制和性能特征的限制。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-178">RSA (Rivest–Shamir–Adleman) key generation is performed by the OS libraries and is subject to their size limitations and performance characteristics.</span></span>

<span data-ttu-id="e6ea9-179">RSA 密钥操作由 OS 库执行，可以加载的密钥类型受操作系统要求的限制。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-179">RSA key operations are performed by the OS libraries, and the types of key that can be loaded are subject to OS requirements.</span></span>

<span data-ttu-id="e6ea9-180">.NET 不会 (未填充) RSA 操作公开 "原始"。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-180">.NET does not expose "raw" (unpadded) RSA operations.</span></span>

<span data-ttu-id="e6ea9-181">OS 库用于加密和解密填充。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-181">The OS libraries are used for encryption and decryption padding.</span></span> <span data-ttu-id="e6ea9-182">并非所有平台都支持相同的填充选项：</span><span class="sxs-lookup"><span data-stu-id="e6ea9-182">Not all platforms support the same padding options:</span></span>

| <span data-ttu-id="e6ea9-183">填充模式</span><span class="sxs-lookup"><span data-stu-id="e6ea9-183">Padding Mode</span></span>                          | <span data-ttu-id="e6ea9-184">Windows (CNG) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-184">Windows (CNG)</span></span> | <span data-ttu-id="e6ea9-185">Linux (OpenSSL) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-185">Linux (OpenSSL)</span></span> | <span data-ttu-id="e6ea9-186">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-186">macOS</span></span> | <span data-ttu-id="e6ea9-187">Windows (CAPI) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-187">Windows (CAPI)</span></span> |
|---------------------------------------|---------------|-----------------|-------|----------------|
| <span data-ttu-id="e6ea9-188">PKCS1 加密</span><span class="sxs-lookup"><span data-stu-id="e6ea9-188">PKCS1 Encryption</span></span>                      | <span data-ttu-id="e6ea9-189">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-189">✔️</span></span>           | <span data-ttu-id="e6ea9-190">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-190">✔️</span></span>              | <span data-ttu-id="e6ea9-191">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-191">✔️</span></span>   | <span data-ttu-id="e6ea9-192">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-192">✔️</span></span>             |
| <span data-ttu-id="e6ea9-193">OAEP-SHA-1</span><span class="sxs-lookup"><span data-stu-id="e6ea9-193">OAEP - SHA-1</span></span>                          | <span data-ttu-id="e6ea9-194">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-194">✔️</span></span>           | <span data-ttu-id="e6ea9-195">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-195">✔️</span></span>              | <span data-ttu-id="e6ea9-196">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-196">✔️</span></span>   | <span data-ttu-id="e6ea9-197">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-197">✔️</span></span>             |
| <span data-ttu-id="e6ea9-198">OAEP-SHA-1 (SHA256、SHA384、SHA512) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-198">OAEP - SHA-2 (SHA256, SHA384, SHA512)</span></span> | <span data-ttu-id="e6ea9-199">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-199">✔️</span></span>           | <span data-ttu-id="e6ea9-200">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-200">✔️</span></span>              | <span data-ttu-id="e6ea9-201">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-201">✔️</span></span>   | ❌             |
| <span data-ttu-id="e6ea9-202">PKCS1 签名 (MD5，SHA-1) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-202">PKCS1 Signature (MD5, SHA-1)</span></span>          | <span data-ttu-id="e6ea9-203">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-203">✔️</span></span>           | <span data-ttu-id="e6ea9-204">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-204">✔️</span></span>              | <span data-ttu-id="e6ea9-205">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-205">✔️</span></span>   | <span data-ttu-id="e6ea9-206">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-206">✔️</span></span>             |
| <span data-ttu-id="e6ea9-207">PKCS1 签名 (SHA-1) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-207">PKCS1 Signature (SHA-2)</span></span>               | <span data-ttu-id="e6ea9-208">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-208">✔️</span></span>           | <span data-ttu-id="e6ea9-209">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-209">✔️</span></span>              | <span data-ttu-id="e6ea9-210">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-210">✔️</span></span>   | ⚠️\*           |
| <span data-ttu-id="e6ea9-211">PSS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-211">PSS</span></span>                                   | <span data-ttu-id="e6ea9-212">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-212">✔️</span></span>           | <span data-ttu-id="e6ea9-213">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-213">✔️</span></span>              | <span data-ttu-id="e6ea9-214">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-214">✔️</span></span>   | ❌             |

<span data-ttu-id="e6ea9-215">\*Windows CryptoAPI (CAPI) 能够具有 SHA-1 算法的 PKCS1 签名。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-215">\* Windows CryptoAPI (CAPI) is capable of PKCS1 signature with a SHA-2 algorithm.</span></span> <span data-ttu-id="e6ea9-216">但可以在加密服务提供程序中加载单个 RSA 对象 (CSP) 不支持该对象。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-216">But the individual RSA object may be loaded in a cryptographic service provider (CSP) that doesn't support it.</span></span>

#### <a name="rsa-on-windows"></a><span data-ttu-id="e6ea9-217">Windows 上的 RSA</span><span class="sxs-lookup"><span data-stu-id="e6ea9-217">RSA on Windows</span></span>

* <span data-ttu-id="e6ea9-218">使用时，将使用 Windows CryptoAPI (CAPI) [`new RSACryptoServiceProvider()`](xref:System.Security.Cryptography.RSACryptoServiceProvider) 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-218">Windows CryptoAPI (CAPI) is used whenever [`new RSACryptoServiceProvider()`](xref:System.Security.Cryptography.RSACryptoServiceProvider) is used.</span></span>
* <span data-ttu-id="e6ea9-219">使用时，Windows 加密 API 下一代 (CNG) 使用 [`new RSACng()`](xref:System.Security.Cryptography.RSACng) 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-219">Windows Cryptography API Next Generation (CNG) is used whenever [`new RSACng()`](xref:System.Security.Cryptography.RSACng) is used.</span></span>
* <span data-ttu-id="e6ea9-220">返回的对象由 <xref:System.Security.Cryptography.RSA.Create%2A?displayProperty=nameWithType> WINDOWS CNG 在内部提供支持。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-220">The object returned by <xref:System.Security.Cryptography.RSA.Create%2A?displayProperty=nameWithType> is internally powered by Windows CNG.</span></span> <span data-ttu-id="e6ea9-221">Windows CNG 的这种用法是实现详细信息，可能会有所更改。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-221">This use of Windows CNG is an implementation detail and is subject to change.</span></span>
* <span data-ttu-id="e6ea9-222">的 <xref:System.Security.Cryptography.X509Certificates.RSACertificateExtensions.GetRSAPublicKey%2A> 扩展方法 <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> 返回 <xref:System.Security.Cryptography.RSACng> 实例。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-222">The <xref:System.Security.Cryptography.X509Certificates.RSACertificateExtensions.GetRSAPublicKey%2A> extension method for <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> returns an <xref:System.Security.Cryptography.RSACng> instance.</span></span> <span data-ttu-id="e6ea9-223">的这种用法 <xref:System.Security.Cryptography.RSACng> 是实现详细信息，可能会有所更改。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-223">This use of <xref:System.Security.Cryptography.RSACng> is an implementation detail and is subject to change.</span></span>
* <span data-ttu-id="e6ea9-224"><xref:System.Security.Cryptography.X509Certificates.RSACertificateExtensions.GetRSAPrivateKey%2A> <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> 当前首选实例的扩展方法 <xref:System.Security.Cryptography.RSACng> ，但如果 <xref:System.Security.Cryptography.RSACng> 无法打开密钥，则 <xref:System.Security.Cryptography.RSACryptoServiceProvider> 会尝试。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-224">The <xref:System.Security.Cryptography.X509Certificates.RSACertificateExtensions.GetRSAPrivateKey%2A> extension method for <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> currently prefers an <xref:System.Security.Cryptography.RSACng> instance, but if <xref:System.Security.Cryptography.RSACng> can't open the key, <xref:System.Security.Cryptography.RSACryptoServiceProvider> will be attempted.</span></span> <span data-ttu-id="e6ea9-225">首选提供程序是实现详细信息，可能会发生更改。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-225">The preferred provider is an implementation detail and is subject to change.</span></span>

#### <a name="rsa-native-interop"></a><span data-ttu-id="e6ea9-226">RSA 本机互操作</span><span class="sxs-lookup"><span data-stu-id="e6ea9-226">RSA native interop</span></span>

<span data-ttu-id="e6ea9-227">.NET 公开了各种类型，使程序能够与 .NET 加密代码所使用的 OS 库进行互操作。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-227">.NET exposes types to allow programs to interoperate with the OS libraries that the .NET cryptography code uses.</span></span> <span data-ttu-id="e6ea9-228">涉及的类型不在平台之间转换，只应在必要时直接使用。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-228">The types involved do not translate between platforms, and should only be directly used when necessary.</span></span>

| <span data-ttu-id="e6ea9-229">类型</span><span class="sxs-lookup"><span data-stu-id="e6ea9-229">Type</span></span>                                                         | <span data-ttu-id="e6ea9-230">Windows</span><span class="sxs-lookup"><span data-stu-id="e6ea9-230">Windows</span></span> | <span data-ttu-id="e6ea9-231">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-231">Linux</span></span>         | <span data-ttu-id="e6ea9-232">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-232">macOS</span></span>         |
|--------------------------------------------------------------|---------|---------------|---------------|
| <xref:System.Security.Cryptography.RSACryptoServiceProvider> | <span data-ttu-id="e6ea9-233">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-233">✔️</span></span>     | <span data-ttu-id="e6ea9-234">⚠️<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-234">⚠️<sup>1</sup></span></span>| <span data-ttu-id="e6ea9-235">⚠️<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-235">⚠️<sup>1</sup></span></span> |
| <xref:System.Security.Cryptography.RSACng>                   | <span data-ttu-id="e6ea9-236">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-236">✔️</span></span>     | ❌            | ❌            |
| <xref:System.Security.Cryptography.RSAOpenSsl>               | ❌     | <span data-ttu-id="e6ea9-237">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-237">✔️</span></span>            | <span data-ttu-id="e6ea9-238">⚠️<sup>pps-2</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-238">⚠️<sup>2</sup></span></span> |

<span data-ttu-id="e6ea9-239"><sup>1</sup>在 MacOS 和 Linux 上， <xref:System.Security.Cryptography.RSACryptoServiceProvider> 可用于与现有程序的兼容性。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-239"><sup>1</sup> On macOS and Linux, <xref:System.Security.Cryptography.RSACryptoServiceProvider> can be used for compatibility with existing programs.</span></span> <span data-ttu-id="e6ea9-240">在这种情况下，任何需要 OS 互操作的方法（如打开已命名的密钥）都将引发 <xref:System.PlatformNotSupportedException> 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-240">In that case, any method that requires OS interop, such as opening a named key, throws a <xref:System.PlatformNotSupportedException>.</span></span>

<span data-ttu-id="e6ea9-241"><sup>2</sup>在 macOS 上， <xref:System.Security.Cryptography.RSAOpenSsl> 适用于是否安装了 OpenSSL，并可通过动态库加载找到合适的 libcrypto .dylib。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-241"><sup>2</sup> On macOS, <xref:System.Security.Cryptography.RSAOpenSsl> works if OpenSSL is installed and an appropriate libcrypto dylib can be found via dynamic library loading.</span></span> <span data-ttu-id="e6ea9-242">如果找不到合适的库，则会引发异常。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-242">If an appropriate library can't be found, exceptions will be thrown.</span></span>

### <a name="ecdsa"></a><span data-ttu-id="e6ea9-243">ECDSA</span><span class="sxs-lookup"><span data-stu-id="e6ea9-243">ECDSA</span></span>

<span data-ttu-id="e6ea9-244">ECDSA (椭圆曲线数字签名算法) 密钥生成由 OS 库完成，并受其大小限制和性能特征的限制。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-244">ECDSA (Elliptic Curve Digital Signature Algorithm) key generation is done by the OS libraries and is subject to their size limitations and performance characteristics.</span></span>

<span data-ttu-id="e6ea9-245">ECDSA 关键曲线由 OS 库定义，并受其限制的限制。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-245">ECDSA key curves are defined by the OS libraries and are subject to their limitations.</span></span>

| <span data-ttu-id="e6ea9-246">椭圆曲线</span><span class="sxs-lookup"><span data-stu-id="e6ea9-246">Elliptic Curve</span></span>                     | <span data-ttu-id="e6ea9-247">Windows 10</span><span class="sxs-lookup"><span data-stu-id="e6ea9-247">Windows 10</span></span>    | <span data-ttu-id="e6ea9-248">Windows 7-8。1</span><span class="sxs-lookup"><span data-stu-id="e6ea9-248">Windows 7 - 8.1</span></span> | <span data-ttu-id="e6ea9-249">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-249">Linux</span></span>         | <span data-ttu-id="e6ea9-250">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-250">macOS</span></span>         |
|------------------------------------|---------------|-----------------|---------------|---------------|
| <span data-ttu-id="e6ea9-251">NIST P-256 (secp256r1) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-251">NIST P-256 (secp256r1)</span></span>             | <span data-ttu-id="e6ea9-252">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-252">✔️</span></span>           | <span data-ttu-id="e6ea9-253">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-253">✔️</span></span>              | <span data-ttu-id="e6ea9-254">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-254">✔️</span></span>           | <span data-ttu-id="e6ea9-255">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-255">✔️</span></span>            |
| <span data-ttu-id="e6ea9-256">NIST P-384 (secp384r1) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-256">NIST P-384 (secp384r1)</span></span>             | <span data-ttu-id="e6ea9-257">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-257">✔️</span></span>           | <span data-ttu-id="e6ea9-258">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-258">✔️</span></span>              | <span data-ttu-id="e6ea9-259">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-259">✔️</span></span>           | <span data-ttu-id="e6ea9-260">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-260">✔️</span></span>            |
| <span data-ttu-id="e6ea9-261">NIST P-521 (secp521r1) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-261">NIST P-521 (secp521r1)</span></span>             | <span data-ttu-id="e6ea9-262">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-262">✔️</span></span>           | <span data-ttu-id="e6ea9-263">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-263">✔️</span></span>              | <span data-ttu-id="e6ea9-264">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-264">✔️</span></span>           | <span data-ttu-id="e6ea9-265">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-265">✔️</span></span>            |
| <span data-ttu-id="e6ea9-266">Brainpool 曲线 (命名曲线) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-266">Brainpool curves (as named curves)</span></span> | <span data-ttu-id="e6ea9-267">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-267">✔️</span></span>           | ❌              | <span data-ttu-id="e6ea9-268">⚠️<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-268">⚠️<sup>1</sup></span></span>| ❌           |
| <span data-ttu-id="e6ea9-269">其他命名曲线</span><span class="sxs-lookup"><span data-stu-id="e6ea9-269">Other named curves</span></span>                 | <span data-ttu-id="e6ea9-270">⚠️<sup>pps-2</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-270">⚠️<sup>2</sup></span></span>| ❌             | <span data-ttu-id="e6ea9-271">⚠️<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-271">⚠️<sup>1</sup></span></span>| ❌           |
| <span data-ttu-id="e6ea9-272">显式曲线</span><span class="sxs-lookup"><span data-stu-id="e6ea9-272">Explicit curves</span></span>                    | <span data-ttu-id="e6ea9-273">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-273">✔️</span></span>           | ❌              | <span data-ttu-id="e6ea9-274">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-274">✔️</span></span>           | ❌            |
| <span data-ttu-id="e6ea9-275">作为显式导出或导入</span><span class="sxs-lookup"><span data-stu-id="e6ea9-275">Export or import as explicit</span></span>       | <span data-ttu-id="e6ea9-276">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-276">✔️</span></span>           | <span data-ttu-id="e6ea9-277">❌<sup>三维空间</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-277">❌<sup>3</sup></span></span>  | <span data-ttu-id="e6ea9-278">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-278">✔️</span></span>           | <span data-ttu-id="e6ea9-279">❌<sup>三维空间</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-279">❌<sup>3</sup></span></span>|

<span data-ttu-id="e6ea9-280"><sup>1</sup> Linux 分发版并不都支持相同的命名曲线。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-280"><sup>1</sup> Linux distributions don't all have support for the same named curves.</span></span>

<span data-ttu-id="e6ea9-281"><sup>2</sup>向 windows 10 中的 windows CNG 添加了对命名曲线的支持。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-281"><sup>2</sup> Support for named curves was added to Windows CNG in Windows 10.</span></span> <span data-ttu-id="e6ea9-282">有关详细信息，请参阅[CNG 命名椭圆曲线](https://msdn.microsoft.com/library/windows/desktop/mt632245(v=vs.85).aspx)。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-282">For more information, see [CNG Named Elliptic Curves](https://msdn.microsoft.com/library/windows/desktop/mt632245(v=vs.85).aspx).</span></span> <span data-ttu-id="e6ea9-283">命名曲线在 Windows 的早期版本中不可用，但 Windows 7 中的三条曲线除外。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-283">Named curves are not available in earlier versions of Windows, except for three curves in Windows 7.</span></span>

<span data-ttu-id="e6ea9-284"><sup>3</sup>使用显式曲线参数导出需要 OS 库支持，该支持在 macOS 或早期版本的 Windows 上不可用。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-284"><sup>3</sup> Exporting with explicit curve parameters requires OS library support, which is not available on macOS or earlier versions of Windows.</span></span>

#### <a name="ecdsa-native-interop"></a><span data-ttu-id="e6ea9-285">ECDSA 本机互操作</span><span class="sxs-lookup"><span data-stu-id="e6ea9-285">ECDSA Native Interop</span></span>

<span data-ttu-id="e6ea9-286">.NET 公开了各种类型，使程序能够与 .NET 加密代码所使用的 OS 库进行互操作。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-286">.NET exposes types to allow programs to interoperate with the OS libraries that the .NET cryptography code uses.</span></span> <span data-ttu-id="e6ea9-287">涉及的类型不在平台之间转换，只应在必要时直接使用。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-287">The types involved don't translate between platforms and should only be directly used when necessary.</span></span>

| <span data-ttu-id="e6ea9-288">类型</span><span class="sxs-lookup"><span data-stu-id="e6ea9-288">Type</span></span>                                             | <span data-ttu-id="e6ea9-289">Windows</span><span class="sxs-lookup"><span data-stu-id="e6ea9-289">Windows</span></span> | <span data-ttu-id="e6ea9-290">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-290">Linux</span></span> | <span data-ttu-id="e6ea9-291">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-291">macOS</span></span> |
|--------------------------------------------------|---------|-------|-------|
| <xref:System.Security.Cryptography.ECDsaCng>     | <span data-ttu-id="e6ea9-292">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-292">✔️</span></span>     | ❌    | ❌    |
| <xref:System.Security.Cryptography.ECDsaOpenSsl> | ❌     | <span data-ttu-id="e6ea9-293">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-293">✔️</span></span>    | ⚠️\*  |

<span data-ttu-id="e6ea9-294">\*在 macOS 上， <xref:System.Security.Cryptography.ECDsaOpenSsl> 如果在系统中安装了 OpenSSL 并且可以通过动态库加载找到合适的 libcrypto .dylib，则有效。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-294">\* On macOS, <xref:System.Security.Cryptography.ECDsaOpenSsl> works if OpenSSL is installed in the system and an appropriate libcrypto dylib can be found via dynamic library loading.</span></span> <span data-ttu-id="e6ea9-295">如果找不到合适的库，则会引发异常。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-295">If an appropriate library can't be found, exceptions will be thrown.</span></span>

### <a name="ecdh"></a><span data-ttu-id="e6ea9-296">ECDH</span><span class="sxs-lookup"><span data-stu-id="e6ea9-296">ECDH</span></span>

<span data-ttu-id="e6ea9-297">ECDH (椭圆曲线 Diffie-hellman) 密钥生成由 OS 库完成，并受其大小限制和性能特征的限制。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-297">ECDH (Elliptic Curve Diffie-Hellman) key generation is done by the OS libraries and is subject to their size limitations and performance characteristics.</span></span>

<span data-ttu-id="e6ea9-298"><xref:System.Security.Cryptography.ECDiffieHellman>类不返回 ECDH 计算的 "原始" 值。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-298">The <xref:System.Security.Cryptography.ECDiffieHellman> class doesn't return the "raw" value of the ECDH computation.</span></span> <span data-ttu-id="e6ea9-299">所有返回的数据都是从密钥派生函数中进行的：</span><span class="sxs-lookup"><span data-stu-id="e6ea9-299">All returned data is in terms of key derivation functions:</span></span>

* <span data-ttu-id="e6ea9-300"> (Z) 哈希</span><span class="sxs-lookup"><span data-stu-id="e6ea9-300">HASH(Z)</span></span>
* <span data-ttu-id="e6ea9-301">哈希 (预置 | |Z | |追加) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-301">HASH(prepend || Z || append)</span></span>
* <span data-ttu-id="e6ea9-302">HMAC (键，Z) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-302">HMAC(key, Z)</span></span>
* <span data-ttu-id="e6ea9-303">HMAC (键，预置 | |Z | |追加) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-303">HMAC(key, prepend || Z || append)</span></span>
* <span data-ttu-id="e6ea9-304">HMAC (Z，Z) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-304">HMAC(Z, Z)</span></span>
* <span data-ttu-id="e6ea9-305">HMAC (Z，预置 | |Z | |追加) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-305">HMAC(Z, prepend || Z || append)</span></span>
* <span data-ttu-id="e6ea9-306">Tls11Prf (标签，种子) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-306">Tls11Prf(label, seed)</span></span>

<span data-ttu-id="e6ea9-307">ECDH 关键曲线由 OS 库定义，并受其限制的限制。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-307">ECDH key curves are defined by the OS libraries and are subject to their limitations.</span></span>

| <span data-ttu-id="e6ea9-308">椭圆曲线</span><span class="sxs-lookup"><span data-stu-id="e6ea9-308">Elliptic Curve</span></span>                     | <span data-ttu-id="e6ea9-309">Windows 10</span><span class="sxs-lookup"><span data-stu-id="e6ea9-309">Windows 10</span></span>    | <span data-ttu-id="e6ea9-310">Windows 7-8。1</span><span class="sxs-lookup"><span data-stu-id="e6ea9-310">Windows 7 - 8.1</span></span> | <span data-ttu-id="e6ea9-311">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-311">Linux</span></span>         | <span data-ttu-id="e6ea9-312">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-312">macOS</span></span>         |
|------------------------------------|---------------|-----------------|---------------|---------------|
| <span data-ttu-id="e6ea9-313">NIST P-256 (secp256r1) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-313">NIST P-256 (secp256r1)</span></span>             | <span data-ttu-id="e6ea9-314">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-314">✔️</span></span>           | <span data-ttu-id="e6ea9-315">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-315">✔️</span></span>              | <span data-ttu-id="e6ea9-316">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-316">✔️</span></span>           | <span data-ttu-id="e6ea9-317">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-317">✔️</span></span>            |
| <span data-ttu-id="e6ea9-318">NIST P-384 (secp384r1) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-318">NIST P-384 (secp384r1)</span></span>             | <span data-ttu-id="e6ea9-319">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-319">✔️</span></span>           | <span data-ttu-id="e6ea9-320">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-320">✔️</span></span>              | <span data-ttu-id="e6ea9-321">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-321">✔️</span></span>           | <span data-ttu-id="e6ea9-322">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-322">✔️</span></span>            |
| <span data-ttu-id="e6ea9-323">NIST P-521 (secp521r1) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-323">NIST P-521 (secp521r1)</span></span>             | <span data-ttu-id="e6ea9-324">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-324">✔️</span></span>           | <span data-ttu-id="e6ea9-325">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-325">✔️</span></span>              | <span data-ttu-id="e6ea9-326">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-326">✔️</span></span>           | <span data-ttu-id="e6ea9-327">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-327">✔️</span></span>            |
| <span data-ttu-id="e6ea9-328">brainpool 曲线 (命名曲线) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-328">brainpool curves (as named curves)</span></span> | <span data-ttu-id="e6ea9-329">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-329">✔️</span></span>           | ❌              | <span data-ttu-id="e6ea9-330">⚠️<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-330">⚠️<sup>1</sup></span></span>| ❌           |
| <span data-ttu-id="e6ea9-331">其他命名曲线</span><span class="sxs-lookup"><span data-stu-id="e6ea9-331">other named curves</span></span>                 | <span data-ttu-id="e6ea9-332">⚠️<sup>pps-2</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-332">⚠️<sup>2</sup></span></span>| ❌             | <span data-ttu-id="e6ea9-333">⚠️<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-333">⚠️<sup>1</sup></span></span>| ❌           |
| <span data-ttu-id="e6ea9-334">显式曲线</span><span class="sxs-lookup"><span data-stu-id="e6ea9-334">explicit curves</span></span>                    | <span data-ttu-id="e6ea9-335">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-335">✔️</span></span>           | ❌              | <span data-ttu-id="e6ea9-336">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-336">✔️</span></span>           | ❌            |
| <span data-ttu-id="e6ea9-337">作为显式导出或导入</span><span class="sxs-lookup"><span data-stu-id="e6ea9-337">Export or import as explicit</span></span>       | <span data-ttu-id="e6ea9-338">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-338">✔️</span></span>           | <span data-ttu-id="e6ea9-339">❌<sup>三维空间</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-339">❌<sup>3</sup></span></span>  | <span data-ttu-id="e6ea9-340">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-340">✔️</span></span>           | <span data-ttu-id="e6ea9-341">❌<sup>三维空间</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-341">❌<sup>3</sup></span></span>|

<span data-ttu-id="e6ea9-342"><sup>1</sup> Linux 分发版并不都支持相同的命名曲线。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-342"><sup>1</sup> Linux distributions don't all have support for the same named curves.</span></span>

<span data-ttu-id="e6ea9-343"><sup>2</sup>向 windows 10 中的 windows CNG 添加了对命名曲线的支持。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-343"><sup>2</sup> Support for named curves was added to Windows CNG in Windows 10.</span></span> <span data-ttu-id="e6ea9-344">有关详细信息，请参阅[CNG 命名椭圆曲线](https://msdn.microsoft.com/library/windows/desktop/mt632245(v=vs.85).aspx)。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-344">For more information, see [CNG Named Elliptic Curves](https://msdn.microsoft.com/library/windows/desktop/mt632245(v=vs.85).aspx).</span></span> <span data-ttu-id="e6ea9-345">命名曲线在 Windows 的早期版本中不可用，但 Windows 7 中的三条曲线除外。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-345">Named curves are not available in earlier versions of Windows, except for three curves in Windows 7.</span></span>

<span data-ttu-id="e6ea9-346"><sup>3</sup>使用显式曲线参数导出需要 OS 库支持，该支持在 macOS 或早期版本的 Windows 上不可用。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-346"><sup>3</sup> Exporting with explicit curve parameters requires OS library support, which is not available on macOS or earlier versions of Windows.</span></span>

#### <a name="ecdh-native-interop"></a><span data-ttu-id="e6ea9-347">ECDH 本机互操作</span><span class="sxs-lookup"><span data-stu-id="e6ea9-347">ECDH native interop</span></span>

<span data-ttu-id="e6ea9-348">.NET 公开了类型，使程序能够与 .NET 所使用的 OS 库进行互操作。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-348">.NET exposes types to allow programs to interoperate with the OS libraries that .NET uses.</span></span> <span data-ttu-id="e6ea9-349">涉及的类型不在平台之间转换，只应在必要时直接使用。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-349">The types involved don't translate between platforms and should only be directly used when necessary.</span></span>

| <span data-ttu-id="e6ea9-350">类型</span><span class="sxs-lookup"><span data-stu-id="e6ea9-350">Type</span></span>                                                       | <span data-ttu-id="e6ea9-351">Windows</span><span class="sxs-lookup"><span data-stu-id="e6ea9-351">Windows</span></span> | <span data-ttu-id="e6ea9-352">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-352">Linux</span></span> | <span data-ttu-id="e6ea9-353">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-353">macOS</span></span> |
|------------------------------------------------------------|---------|-------|-------|
| <xref:System.Security.Cryptography.ECDiffieHellmanCng>     | <span data-ttu-id="e6ea9-354">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-354">✔️</span></span>     | ❌    | ❌   |
| <xref:System.Security.Cryptography.ECDiffieHellmanOpenSsl> | ❌     | <span data-ttu-id="e6ea9-355">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-355">✔️</span></span>    | ⚠️\* |

<span data-ttu-id="e6ea9-356">\*在 macOS 上， <xref:System.Security.Cryptography.ECDiffieHellmanOpenSsl> 如果已安装 OpenSSL 并可通过动态库加载找到合适的 libcrypto .dylib，则有效。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-356">\* On macOS, <xref:System.Security.Cryptography.ECDiffieHellmanOpenSsl> works if OpenSSL is installed and an appropriate libcrypto dylib can be found via dynamic library loading.</span></span> <span data-ttu-id="e6ea9-357">如果找不到合适的库，则会引发异常。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-357">If an appropriate library can't be found, exceptions will be thrown.</span></span>

### <a name="dsa"></a><span data-ttu-id="e6ea9-358">DSA</span><span class="sxs-lookup"><span data-stu-id="e6ea9-358">DSA</span></span>

<span data-ttu-id="e6ea9-359">DSA (数字签名算法) 密钥生成由系统库执行，并受其大小限制和性能特征的限制。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-359">DSA (Digital Signature Algorithm) key generation is performed by the system libraries and is subject to their size limitations and performance characteristics.</span></span>

| <span data-ttu-id="e6ea9-360">函数</span><span class="sxs-lookup"><span data-stu-id="e6ea9-360">Function</span></span>                      | <span data-ttu-id="e6ea9-361">Windows CNG</span><span class="sxs-lookup"><span data-stu-id="e6ea9-361">Windows CNG</span></span> | <span data-ttu-id="e6ea9-362">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-362">Linux</span></span> | <span data-ttu-id="e6ea9-363">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-363">macOS</span></span>         | <span data-ttu-id="e6ea9-364">Windows CAPI</span><span class="sxs-lookup"><span data-stu-id="e6ea9-364">Windows CAPI</span></span> |
|-------------------------------|-------------|-------|---------------|--------------|
| <span data-ttu-id="e6ea9-365">密钥创建 ( # B0 = 1024 位) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-365">Key creation (<= 1024 bits)</span></span>   | <span data-ttu-id="e6ea9-366">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-366">✔️</span></span>         | <span data-ttu-id="e6ea9-367">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-367">✔️</span></span>    | ❌            | <span data-ttu-id="e6ea9-368">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-368">✔️</span></span>           |
| <span data-ttu-id="e6ea9-369">密钥创建 ( # A0 1024 位) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-369">Key creation (> 1024 bits)</span></span>    | <span data-ttu-id="e6ea9-370">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-370">✔️</span></span>         | <span data-ttu-id="e6ea9-371">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-371">✔️</span></span>    | ❌            | ❌            |
| <span data-ttu-id="e6ea9-372"> ( # B0 = 1024 bits 加载密钥) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-372">Loading keys (<= 1024 bits)</span></span>   | <span data-ttu-id="e6ea9-373">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-373">✔️</span></span>         | <span data-ttu-id="e6ea9-374">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-374">✔️</span></span>    | <span data-ttu-id="e6ea9-375">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-375">✔️</span></span>            | <span data-ttu-id="e6ea9-376">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-376">✔️</span></span>           |
| <span data-ttu-id="e6ea9-377">加载密钥 ( # A0 1024 位) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-377">Loading keys (> 1024 bits)</span></span>    | <span data-ttu-id="e6ea9-378">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-378">✔️</span></span>         | <span data-ttu-id="e6ea9-379">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-379">✔️</span></span>    | ⚠️\*          | ❌            |
| <span data-ttu-id="e6ea9-380">FIPS 186-2</span><span class="sxs-lookup"><span data-stu-id="e6ea9-380">FIPS 186-2</span></span>                    | <span data-ttu-id="e6ea9-381">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-381">✔️</span></span>         | <span data-ttu-id="e6ea9-382">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-382">✔️</span></span>    | <span data-ttu-id="e6ea9-383">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-383">✔️</span></span>            | <span data-ttu-id="e6ea9-384">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-384">✔️</span></span>           |
| <span data-ttu-id="e6ea9-385">FIPS 186-3 (SHA-1 签名) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-385">FIPS 186-3 (SHA-2 signatures)</span></span> | <span data-ttu-id="e6ea9-386">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-386">✔️</span></span>         | <span data-ttu-id="e6ea9-387">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-387">✔️</span></span>    | ❌            | ❌            |

<span data-ttu-id="e6ea9-388">\*macOS 加载大于1024位的 DSA 密钥，但这些密钥的行为未定义。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-388">\* macOS loads DSA keys bigger than 1024 bits, but the behavior of those keys is undefined.</span></span> <span data-ttu-id="e6ea9-389">它们不会按照 FIPS 186-3 的方式运行。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-389">They don't behave according to FIPS 186-3.</span></span>

#### <a name="dsa-on-windows"></a><span data-ttu-id="e6ea9-390">Windows 上的 DSA</span><span class="sxs-lookup"><span data-stu-id="e6ea9-390">DSA on Windows</span></span>

* <span data-ttu-id="e6ea9-391">使用时，将使用 Windows CryptoAPI (CAPI) [`new DSACryptoServiceProvider()`](xref:System.Security.Cryptography.DSACryptoServiceProvider) 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-391">Windows CryptoAPI (CAPI) is used whenever [`new DSACryptoServiceProvider()`](xref:System.Security.Cryptography.DSACryptoServiceProvider) is used.</span></span>
* <span data-ttu-id="e6ea9-392">使用时，Windows 加密 API 下一代 (CNG) 使用 [`new DSACng()`](xref:System.Security.Cryptography.DSACng) 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-392">Windows Cryptography API Next Generation (CNG) is used whenever [`new DSACng()`](xref:System.Security.Cryptography.DSACng) is used.</span></span>
* <span data-ttu-id="e6ea9-393">返回的对象由 <xref:System.Security.Cryptography.DSA.Create%2A?displayProperty=nameWithType> WINDOWS CNG 在内部提供支持。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-393">The object returned by <xref:System.Security.Cryptography.DSA.Create%2A?displayProperty=nameWithType> is internally powered by Windows CNG.</span></span> <span data-ttu-id="e6ea9-394">Windows CNG 的这种用法是实现详细信息，可能会有所更改。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-394">This use of Windows CNG is an implementation detail and is subject to change.</span></span>
* <span data-ttu-id="e6ea9-395">的 <xref:System.Security.Cryptography.X509Certificates.DSACertificateExtensions.GetDSAPublicKey%2A> 扩展方法用于 <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> 返回 <xref:System.Security.Cryptography.DSACng> 实例。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-395">The <xref:System.Security.Cryptography.X509Certificates.DSACertificateExtensions.GetDSAPublicKey%2A> extension method for <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> returns a <xref:System.Security.Cryptography.DSACng> instance.</span></span> <span data-ttu-id="e6ea9-396">的这种用法 <xref:System.Security.Cryptography.DSACng> 是实现详细信息，可能会有所更改。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-396">This use of <xref:System.Security.Cryptography.DSACng> is an implementation detail and is subject to change.</span></span>
* <span data-ttu-id="e6ea9-397"><xref:System.Security.Cryptography.X509Certificates.DSACertificateExtensions.GetDSAPrivateKey%2A>用于 <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> 首选实例的扩展方法 <xref:System.Security.Cryptography.DSACng> ，但如果 <xref:System.Security.Cryptography.DSACng> 不能打开该密钥，则 <xref:System.Security.Cryptography.DSACryptoServiceProvider> 会尝试。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-397">The <xref:System.Security.Cryptography.X509Certificates.DSACertificateExtensions.GetDSAPrivateKey%2A> extension method for <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> prefers an <xref:System.Security.Cryptography.DSACng> instance, but if <xref:System.Security.Cryptography.DSACng> can't open the key, <xref:System.Security.Cryptography.DSACryptoServiceProvider> will be attempted.</span></span>  <span data-ttu-id="e6ea9-398">首选提供程序是实现详细信息，可能会发生更改。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-398">The preferred provider is an implementation detail and is subject to change.</span></span>

#### <a name="dsa-native-interop"></a><span data-ttu-id="e6ea9-399">DSA 本机互操作</span><span class="sxs-lookup"><span data-stu-id="e6ea9-399">DSA native interop</span></span>

<span data-ttu-id="e6ea9-400">.NET 公开了各种类型，使程序能够与 .NET 加密代码所使用的 OS 库进行互操作。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-400">.NET exposes types to allow programs to interoperate with the OS libraries that the .NET cryptography code uses.</span></span> <span data-ttu-id="e6ea9-401">涉及的类型不在平台之间转换，只应在必要时直接使用。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-401">The types involved don't translate between platforms and should only be directly used when necessary.</span></span>

| <span data-ttu-id="e6ea9-402">类型</span><span class="sxs-lookup"><span data-stu-id="e6ea9-402">Type</span></span>                                                         | <span data-ttu-id="e6ea9-403">Windows</span><span class="sxs-lookup"><span data-stu-id="e6ea9-403">Windows</span></span> | <span data-ttu-id="e6ea9-404">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-404">Linux</span></span>         | <span data-ttu-id="e6ea9-405">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-405">macOS</span></span>         |
|--------------------------------------------------------------|---------|---------------|---------------|
| <xref:System.Security.Cryptography.DSACryptoServiceProvider> | <span data-ttu-id="e6ea9-406">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-406">✔️</span></span>     | <span data-ttu-id="e6ea9-407">⚠️<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-407">⚠️<sup>1</sup></span></span> | <span data-ttu-id="e6ea9-408">⚠️<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-408">⚠️<sup>1</sup></span></span> |
| <xref:System.Security.Cryptography.DSACng>                   | <span data-ttu-id="e6ea9-409">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-409">✔️</span></span>     | ❌             | ❌            |
| <xref:System.Security.Cryptography.DSAOpenSsl>               | ❌      | <span data-ttu-id="e6ea9-410">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-410">✔️</span></span>            | <span data-ttu-id="e6ea9-411">⚠️<sup>pps-2</sup></span><span class="sxs-lookup"><span data-stu-id="e6ea9-411">⚠️<sup>2</sup></span></span> |

<span data-ttu-id="e6ea9-412"><sup>1</sup>在 MacOS 和 Linux 上， <xref:System.Security.Cryptography.DSACryptoServiceProvider> 可用于与现有程序的兼容性。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-412"><sup>1</sup> On macOS and Linux, <xref:System.Security.Cryptography.DSACryptoServiceProvider> can be used for compatibility with existing programs.</span></span> <span data-ttu-id="e6ea9-413">在这种情况下，任何需要系统互操作的方法（如打开已命名的密钥）都将引发 <xref:System.PlatformNotSupportedException> 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-413">In that case, any method that requires system interop, such as opening a named key, throws a <xref:System.PlatformNotSupportedException>.</span></span>

<span data-ttu-id="e6ea9-414"><sup>2</sup>在 macOS 上， <xref:System.Security.Cryptography.DSAOpenSsl> 适用于是否安装了 OpenSSL，并可通过动态库加载找到合适的 libcrypto .dylib。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-414"><sup>2</sup> On macOS, <xref:System.Security.Cryptography.DSAOpenSsl> works if OpenSSL is installed and an appropriate libcrypto dylib can be found via dynamic library loading.</span></span> <span data-ttu-id="e6ea9-415">如果找不到合适的库，则会引发异常。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-415">If an appropriate library can't be found, exceptions will be thrown.</span></span>

## <a name="x509-certificates"></a><span data-ttu-id="e6ea9-416">X.509 证书</span><span class="sxs-lookup"><span data-stu-id="e6ea9-416">X.509 Certificates</span></span>

<span data-ttu-id="e6ea9-417">对于 .NET 中的 x.509 证书，大多数支持都来自操作系统库。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-417">The majority of support for X.509 certificates in .NET comes from OS libraries.</span></span> <span data-ttu-id="e6ea9-418">若要将证书加载到 <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> <xref:System.Security.Cryptography.X509Certificates.X509Certificate> .net 中的或实例，证书必须由基础 OS 库加载。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-418">To load a certificate into an <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> or <xref:System.Security.Cryptography.X509Certificates.X509Certificate> instance in .NET, the certificate must be loaded by the underlying OS library.</span></span>

### <a name="read-a-pkcs12pfx"></a><span data-ttu-id="e6ea9-419">读取 PKCS12/PFX</span><span class="sxs-lookup"><span data-stu-id="e6ea9-419">Read a PKCS12/PFX</span></span>

| <span data-ttu-id="e6ea9-420">方案</span><span class="sxs-lookup"><span data-stu-id="e6ea9-420">Scenario</span></span>                                     | <span data-ttu-id="e6ea9-421">Windows</span><span class="sxs-lookup"><span data-stu-id="e6ea9-421">Windows</span></span> | <span data-ttu-id="e6ea9-422">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-422">Linux</span></span> | <span data-ttu-id="e6ea9-423">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-423">macOS</span></span> |
|----------------------------------------------|---------|-------|-------|
| <span data-ttu-id="e6ea9-424">空</span><span class="sxs-lookup"><span data-stu-id="e6ea9-424">Empty</span></span>                                        | <span data-ttu-id="e6ea9-425">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-425">✔️</span></span>     | <span data-ttu-id="e6ea9-426">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-426">✔️</span></span>    | <span data-ttu-id="e6ea9-427">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-427">✔️</span></span>   |
| <span data-ttu-id="e6ea9-428">一个证书，无私钥</span><span class="sxs-lookup"><span data-stu-id="e6ea9-428">One certificate, no private key</span></span>              | <span data-ttu-id="e6ea9-429">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-429">✔️</span></span>     | <span data-ttu-id="e6ea9-430">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-430">✔️</span></span>    | <span data-ttu-id="e6ea9-431">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-431">✔️</span></span>   |
| <span data-ttu-id="e6ea9-432">一个证书，带私钥</span><span class="sxs-lookup"><span data-stu-id="e6ea9-432">One certificate, with private key</span></span>            | <span data-ttu-id="e6ea9-433">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-433">✔️</span></span>     | <span data-ttu-id="e6ea9-434">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-434">✔️</span></span>    | <span data-ttu-id="e6ea9-435">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-435">✔️</span></span>   |
| <span data-ttu-id="e6ea9-436">多个证书，无私钥</span><span class="sxs-lookup"><span data-stu-id="e6ea9-436">Multiple certificates, no private keys</span></span>       | <span data-ttu-id="e6ea9-437">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-437">✔️</span></span>     | <span data-ttu-id="e6ea9-438">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-438">✔️</span></span>    | <span data-ttu-id="e6ea9-439">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-439">✔️</span></span>   |
| <span data-ttu-id="e6ea9-440">多个证书，一个私钥</span><span class="sxs-lookup"><span data-stu-id="e6ea9-440">Multiple certificates, one private key</span></span>       | <span data-ttu-id="e6ea9-441">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-441">✔️</span></span>     | <span data-ttu-id="e6ea9-442">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-442">✔️</span></span>    | <span data-ttu-id="e6ea9-443">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-443">✔️</span></span>   |
| <span data-ttu-id="e6ea9-444">多个证书，多个私钥</span><span class="sxs-lookup"><span data-stu-id="e6ea9-444">Multiple certificates, multiple private keys</span></span> | <span data-ttu-id="e6ea9-445">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-445">✔️</span></span>     | ⚠️\*  | <span data-ttu-id="e6ea9-446">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-446">✔️</span></span>   |

<span data-ttu-id="e6ea9-447">\*在 .NET 5 预览版本中可用。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-447">\* Available in .NET 5 preview releases.</span></span>

### <a name="write-a-pkcs12pfx"></a><span data-ttu-id="e6ea9-448">编写 PKCS12/PFX</span><span class="sxs-lookup"><span data-stu-id="e6ea9-448">Write a PKCS12/PFX</span></span>

| <span data-ttu-id="e6ea9-449">方案</span><span class="sxs-lookup"><span data-stu-id="e6ea9-449">Scenario</span></span>                                     | <span data-ttu-id="e6ea9-450">Windows</span><span class="sxs-lookup"><span data-stu-id="e6ea9-450">Windows</span></span> | <span data-ttu-id="e6ea9-451">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-451">Linux</span></span> | <span data-ttu-id="e6ea9-452">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-452">macOS</span></span> |
|----------------------------------------------|---------|-------|-------|
| <span data-ttu-id="e6ea9-453">空</span><span class="sxs-lookup"><span data-stu-id="e6ea9-453">Empty</span></span>                                        | <span data-ttu-id="e6ea9-454">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-454">✔️</span></span>     | <span data-ttu-id="e6ea9-455">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-455">✔️</span></span>    | ⚠️\* |
| <span data-ttu-id="e6ea9-456">一个证书，无私钥</span><span class="sxs-lookup"><span data-stu-id="e6ea9-456">One certificate, no private key</span></span>              | <span data-ttu-id="e6ea9-457">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-457">✔️</span></span>     | <span data-ttu-id="e6ea9-458">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-458">✔️</span></span>    | ⚠️\* |
| <span data-ttu-id="e6ea9-459">一个证书，带私钥</span><span class="sxs-lookup"><span data-stu-id="e6ea9-459">One certificate, with private key</span></span>            | <span data-ttu-id="e6ea9-460">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-460">✔️</span></span>     | <span data-ttu-id="e6ea9-461">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-461">✔️</span></span>    | <span data-ttu-id="e6ea9-462">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-462">✔️</span></span>   |
| <span data-ttu-id="e6ea9-463">多个证书，无私钥</span><span class="sxs-lookup"><span data-stu-id="e6ea9-463">Multiple certificates, no private keys</span></span>       | <span data-ttu-id="e6ea9-464">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-464">✔️</span></span>     | <span data-ttu-id="e6ea9-465">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-465">✔️</span></span>    | ⚠️\* |
| <span data-ttu-id="e6ea9-466">多个证书，一个私钥</span><span class="sxs-lookup"><span data-stu-id="e6ea9-466">Multiple certificates, one private key</span></span>       | <span data-ttu-id="e6ea9-467">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-467">✔️</span></span>     | <span data-ttu-id="e6ea9-468">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-468">✔️</span></span>    | <span data-ttu-id="e6ea9-469">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-469">✔️</span></span>   |
| <span data-ttu-id="e6ea9-470">多个证书，多个私钥</span><span class="sxs-lookup"><span data-stu-id="e6ea9-470">Multiple certificates, multiple private keys</span></span> | <span data-ttu-id="e6ea9-471">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-471">✔️</span></span>     | ⚠️\*  | <span data-ttu-id="e6ea9-472">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-472">✔️</span></span>   |
| <span data-ttu-id="e6ea9-473">暂时加载</span><span class="sxs-lookup"><span data-stu-id="e6ea9-473">Ephemeral loading</span></span>                            | <span data-ttu-id="e6ea9-474">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-474">✔️</span></span>     | <span data-ttu-id="e6ea9-475">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-475">✔️</span></span>    | ⚠️\* |

<span data-ttu-id="e6ea9-476">\*在 .NET 5 预览版本中可用。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-476">\* Available in .NET 5 preview releases.</span></span>

<span data-ttu-id="e6ea9-477">macOS 无法加载没有密钥链对象的证书私钥，这需要写入磁盘。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-477">macOS can't load certificate private keys without a keychain object, which requires writing to disk.</span></span> <span data-ttu-id="e6ea9-478">密钥链是自动创建的，用于 PFX 加载，在不再使用时被删除。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-478">Keychains are created automatically for PFX loading, and are deleted when no longer in use.</span></span> <span data-ttu-id="e6ea9-479">由于 <xref:System.Security.Cryptography.X509Certificates.X509KeyStorageFlags.EphemeralKeySet?displayProperty=nameWithType> 选项意味着不应将私钥写入磁盘，因此在 macOS 上断言该标志会导致 <xref:System.PlatformNotSupportedException> 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-479">Since the <xref:System.Security.Cryptography.X509Certificates.X509KeyStorageFlags.EphemeralKeySet?displayProperty=nameWithType> option means that the private key should not be written to disk, asserting that flag on macOS results in a <xref:System.PlatformNotSupportedException>.</span></span>

### <a name="write-a-pkcs7-certificate-collection"></a><span data-ttu-id="e6ea9-480">写入 PKCS7 证书集合</span><span class="sxs-lookup"><span data-stu-id="e6ea9-480">Write a PKCS7 certificate collection</span></span>

<span data-ttu-id="e6ea9-481">Windows 和 Linux 都发出 DER 编码的 PKCS7 blob。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-481">Windows and Linux both emit DER-encoded PKCS7 blobs.</span></span> <span data-ttu-id="e6ea9-482">macOS 发出无限长度-CER 编码的 PKCS7 blob。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-482">macOS emits indefinite-length-CER-encoded PKCS7 blobs.</span></span>

### <a name="x509store"></a><span data-ttu-id="e6ea9-483">X509Store</span><span class="sxs-lookup"><span data-stu-id="e6ea9-483">X509Store</span></span>

<span data-ttu-id="e6ea9-484">在 Windows 上， <xref:System.Security.Cryptography.X509Certificates.X509Store> 类是 Windows 证书存储区 api 的表示形式。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-484">On Windows, the <xref:System.Security.Cryptography.X509Certificates.X509Store> class is a representation of the Windows Certificate Store APIs.</span></span> <span data-ttu-id="e6ea9-485">这些 Api 在 .NET Core 和 .NET 5 中的工作方式与在 .NET Framework 中的工作方式相同。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-485">Those APIs work the same in .NET Core and .NET 5 as they do in .NET Framework.</span></span>

<span data-ttu-id="e6ea9-486">在 Linux 上， <xref:System.Security.Cryptography.X509Certificates.X509Store> 类是系统信任决策的预测 (只读) 、用户信任决策 (读写) ，以及用户密钥存储 (读写) 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-486">On Linux, the <xref:System.Security.Cryptography.X509Certificates.X509Store> class is a projection of system trust decisions (read-only), user trust decisions (read-write), and user key storage (read-write).</span></span>

<span data-ttu-id="e6ea9-487">在 macOS 上， <xref:System.Security.Cryptography.X509Certificates.X509Store> 类是系统信任决策的投影 (只读) 、用户信任决策 (只读) ，以及用户密钥存储 (读写) 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-487">On macOS, the <xref:System.Security.Cryptography.X509Certificates.X509Store> class is a projection of system trust decisions (read-only), user trust decisions (read-only), and user key storage (read-write).</span></span>

<span data-ttu-id="e6ea9-488">下表显示了每个平台支持的方案。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-488">The following tables show which scenarios are supported in each platform.</span></span> <span data-ttu-id="e6ea9-489">对于表)  (不受支持 ❌ 的方案， <xref:System.Security.Cryptography.CryptographicException> 将引发。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-489">For unsupported scenarios (❌ in the tables), a <xref:System.Security.Cryptography.CryptographicException> is thrown.</span></span>

#### <a name="the-my-store"></a><span data-ttu-id="e6ea9-490">我的应用商店</span><span class="sxs-lookup"><span data-stu-id="e6ea9-490">The My store</span></span>

| <span data-ttu-id="e6ea9-491">方案</span><span class="sxs-lookup"><span data-stu-id="e6ea9-491">Scenario</span></span>                                         | <span data-ttu-id="e6ea9-492">Windows</span><span class="sxs-lookup"><span data-stu-id="e6ea9-492">Windows</span></span> | <span data-ttu-id="e6ea9-493">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-493">Linux</span></span> | <span data-ttu-id="e6ea9-494">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-494">macOS</span></span> |
|--------------------------------------------------|---------|-------|-------|
| <span data-ttu-id="e6ea9-495">打开 CurrentUser\My (ReadOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-495">Open CurrentUser\My (ReadOnly)</span></span>                   | <span data-ttu-id="e6ea9-496">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-496">✔️</span></span>     | <span data-ttu-id="e6ea9-497">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-497">✔️</span></span>    | <span data-ttu-id="e6ea9-498">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-498">✔️</span></span>   |
| <span data-ttu-id="e6ea9-499">打开 CurrentUser\My (ReadWrite) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-499">Open CurrentUser\My (ReadWrite)</span></span>                  | <span data-ttu-id="e6ea9-500">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-500">✔️</span></span>     | <span data-ttu-id="e6ea9-501">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-501">✔️</span></span>    | <span data-ttu-id="e6ea9-502">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-502">✔️</span></span>   |
| <span data-ttu-id="e6ea9-503">打开 CurrentUser\My (ExistingOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-503">Open CurrentUser\My (ExistingOnly)</span></span>               | <span data-ttu-id="e6ea9-504">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-504">✔️</span></span>     | ⚠️    | <span data-ttu-id="e6ea9-505">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-505">✔️</span></span>   |
| <span data-ttu-id="e6ea9-506">打开 LocalMachine\My</span><span class="sxs-lookup"><span data-stu-id="e6ea9-506">Open LocalMachine\My</span></span>                             | <span data-ttu-id="e6ea9-507">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-507">✔️</span></span>     | ❌    | <span data-ttu-id="e6ea9-508">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-508">✔️</span></span>   |

<span data-ttu-id="e6ea9-509">在 Linux 上，存储是在首次写入时创建的，默认情况下不存在用户存储区，因此打开 `CurrentUser\My` 时 `ExistingOnly` 可能会失败。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-509">On Linux, stores are created on first write, and no user stores exist by default, so opening `CurrentUser\My` with `ExistingOnly` may fail.</span></span>

<span data-ttu-id="e6ea9-510">在 macOS 上， `CurrentUser\My` 存储是用户的默认密钥链， `login.keychain` 默认情况下为。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-510">On macOS, the `CurrentUser\My` store is the user's default keychain, which is `login.keychain` by default.</span></span> <span data-ttu-id="e6ea9-511">`LocalMachine\My`存储区是 `System.keychain` 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-511">The `LocalMachine\My` store is `System.keychain`.</span></span>

#### <a name="the-root-store"></a><span data-ttu-id="e6ea9-512">根存储区</span><span class="sxs-lookup"><span data-stu-id="e6ea9-512">The Root store</span></span>

| <span data-ttu-id="e6ea9-513">方案</span><span class="sxs-lookup"><span data-stu-id="e6ea9-513">Scenario</span></span>                              | <span data-ttu-id="e6ea9-514">Windows</span><span class="sxs-lookup"><span data-stu-id="e6ea9-514">Windows</span></span> | <span data-ttu-id="e6ea9-515">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-515">Linux</span></span> | <span data-ttu-id="e6ea9-516">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-516">macOS</span></span>           |
|---------------------------------------|---------|-------|-----------------|
| <span data-ttu-id="e6ea9-517">打开 CurrentUser\Root (ReadOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-517">Open CurrentUser\Root (ReadOnly)</span></span>      | <span data-ttu-id="e6ea9-518">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-518">✔️</span></span>     | <span data-ttu-id="e6ea9-519">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-519">✔️</span></span>    | <span data-ttu-id="e6ea9-520">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-520">✔️</span></span>             |
| <span data-ttu-id="e6ea9-521">打开 CurrentUser\Root (ReadWrite) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-521">Open CurrentUser\Root (ReadWrite)</span></span>     | <span data-ttu-id="e6ea9-522">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-522">✔️</span></span>     | <span data-ttu-id="e6ea9-523">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-523">✔️</span></span>    | ❌              |
| <span data-ttu-id="e6ea9-524">打开 CurrentUser\Root (ExistingOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-524">Open CurrentUser\Root (ExistingOnly)</span></span>  | <span data-ttu-id="e6ea9-525">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-525">✔️</span></span>     | ⚠️    | <span data-ttu-id="e6ea9-526">如果为 ReadOnly，则✔️ () </span><span class="sxs-lookup"><span data-stu-id="e6ea9-526">✔️ (if ReadOnly)</span></span> |
| <span data-ttu-id="e6ea9-527">打开 LocalMachine\Root (ReadOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-527">Open LocalMachine\Root (ReadOnly)</span></span>     | <span data-ttu-id="e6ea9-528">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-528">✔️</span></span>     | <span data-ttu-id="e6ea9-529">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-529">✔️</span></span>    | <span data-ttu-id="e6ea9-530">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-530">✔️</span></span>             |
| <span data-ttu-id="e6ea9-531">打开 LocalMachine\Root (ReadWrite) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-531">Open LocalMachine\Root (ReadWrite)</span></span>    | <span data-ttu-id="e6ea9-532">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-532">✔️</span></span>     | ❌    | ❌              |
| <span data-ttu-id="e6ea9-533">打开 LocalMachine\Root (ExistingOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-533">Open LocalMachine\Root (ExistingOnly)</span></span> | <span data-ttu-id="e6ea9-534">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-534">✔️</span></span>     | ⚠️    | <span data-ttu-id="e6ea9-535">如果为 ReadOnly，则✔️ () </span><span class="sxs-lookup"><span data-stu-id="e6ea9-535">✔️ (if ReadOnly)</span></span> |

<span data-ttu-id="e6ea9-536">在 Linux 上， `LocalMachine\Root` 存储是 OpenSSL 的默认路径中的 CA 捆绑包的解释。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-536">On Linux, the `LocalMachine\Root` store is an interpretation of the CA bundle in the default path for OpenSSL.</span></span>

<span data-ttu-id="e6ea9-537">在 macOS 上， `CurrentUser\Root` 存储是 `SecTrustSettings` 用户信任域结果的解释。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-537">On macOS, the `CurrentUser\Root` store is an interpretation of the `SecTrustSettings` results for the user trust domain.</span></span> <span data-ttu-id="e6ea9-538">`LocalMachine\Root`存储是对 `SecTrustSettings` 管理员和系统信任域的结果的解释。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-538">The `LocalMachine\Root` store is an interpretation of the `SecTrustSettings` results for the admin and system trust domains.</span></span>

#### <a name="the-intermediate-store"></a><span data-ttu-id="e6ea9-539">中间存储</span><span class="sxs-lookup"><span data-stu-id="e6ea9-539">The Intermediate store</span></span>

| <span data-ttu-id="e6ea9-540">方案</span><span class="sxs-lookup"><span data-stu-id="e6ea9-540">Scenario</span></span>                                      | <span data-ttu-id="e6ea9-541">Windows</span><span class="sxs-lookup"><span data-stu-id="e6ea9-541">Windows</span></span> | <span data-ttu-id="e6ea9-542">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-542">Linux</span></span> | <span data-ttu-id="e6ea9-543">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-543">macOS</span></span>           |
|-----------------------------------------------|---------|-------|-----------------|
| <span data-ttu-id="e6ea9-544">打开 CurrentUser\Intermediate (ReadOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-544">Open CurrentUser\Intermediate (ReadOnly)</span></span>      | <span data-ttu-id="e6ea9-545">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-545">✔️</span></span>     | <span data-ttu-id="e6ea9-546">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-546">✔️</span></span>    | <span data-ttu-id="e6ea9-547">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-547">✔️</span></span>             |
| <span data-ttu-id="e6ea9-548">打开 CurrentUser\Intermediate (ReadWrite) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-548">Open CurrentUser\Intermediate (ReadWrite)</span></span>     | <span data-ttu-id="e6ea9-549">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-549">✔️</span></span>     | <span data-ttu-id="e6ea9-550">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-550">✔️</span></span>    | ❌              |
| <span data-ttu-id="e6ea9-551">打开 CurrentUser\Intermediate (ExistingOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-551">Open CurrentUser\Intermediate (ExistingOnly)</span></span>  | <span data-ttu-id="e6ea9-552">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-552">✔️</span></span>     | ⚠️    | <span data-ttu-id="e6ea9-553">如果为 ReadOnly，则✔️ () </span><span class="sxs-lookup"><span data-stu-id="e6ea9-553">✔️ (if ReadOnly)</span></span> |
| <span data-ttu-id="e6ea9-554">打开 LocalMachine\Intermediate (ReadOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-554">Open LocalMachine\Intermediate (ReadOnly)</span></span>     | <span data-ttu-id="e6ea9-555">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-555">✔️</span></span>     | <span data-ttu-id="e6ea9-556">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-556">✔️</span></span>    | <span data-ttu-id="e6ea9-557">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-557">✔️</span></span>             |
| <span data-ttu-id="e6ea9-558">打开 LocalMachine\Intermediate (ReadWrite) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-558">Open LocalMachine\Intermediate (ReadWrite)</span></span>    | <span data-ttu-id="e6ea9-559">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-559">✔️</span></span>     | ❌    | ❌              |
| <span data-ttu-id="e6ea9-560">打开 LocalMachine\Intermediate (ExistingOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-560">Open LocalMachine\Intermediate (ExistingOnly)</span></span> | <span data-ttu-id="e6ea9-561">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-561">✔️</span></span>     | ⚠️    | <span data-ttu-id="e6ea9-562">如果为 ReadOnly，则✔️ () </span><span class="sxs-lookup"><span data-stu-id="e6ea9-562">✔️ (if ReadOnly)</span></span> |

<span data-ttu-id="e6ea9-563">在 Linux 上， `CurrentUser\Intermediate` 当通过其授权信息访问记录在成功的 X509Chain 生成时，将存储用作缓存。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-563">On Linux, the `CurrentUser\Intermediate` store is used as a cache when downloading intermediate CAs by their Authority Information Access records on successful X509Chain builds.</span></span> <span data-ttu-id="e6ea9-564">该 `LocalMachine\Intermediate` 存储是 OpenSSL 的默认路径中的 CA 捆绑包的解释。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-564">The `LocalMachine\Intermediate` store is an interpretation of the CA bundle in the default path for OpenSSL.</span></span>

#### <a name="the-disallowed-store"></a><span data-ttu-id="e6ea9-565">禁止存储</span><span class="sxs-lookup"><span data-stu-id="e6ea9-565">The Disallowed store</span></span>

| <span data-ttu-id="e6ea9-566">方案</span><span class="sxs-lookup"><span data-stu-id="e6ea9-566">Scenario</span></span>                                    | <span data-ttu-id="e6ea9-567">Windows</span><span class="sxs-lookup"><span data-stu-id="e6ea9-567">Windows</span></span> | <span data-ttu-id="e6ea9-568">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-568">Linux</span></span> | <span data-ttu-id="e6ea9-569">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-569">macOS</span></span>           |
|---------------------------------------------|---------|-------|-----------------|
| <span data-ttu-id="e6ea9-570">打开 CurrentUser\Disallowed (ReadOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-570">Open CurrentUser\Disallowed (ReadOnly)</span></span>      | <span data-ttu-id="e6ea9-571">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-571">✔️</span></span>     | ⚠️    | <span data-ttu-id="e6ea9-572">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-572">✔️</span></span>             |
| <span data-ttu-id="e6ea9-573">打开 CurrentUser\Disallowed (ReadWrite) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-573">Open CurrentUser\Disallowed (ReadWrite)</span></span>     | <span data-ttu-id="e6ea9-574">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-574">✔️</span></span>     | ⚠️    | ❌              |
| <span data-ttu-id="e6ea9-575">打开 CurrentUser\Disallowed (ExistingOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-575">Open CurrentUser\Disallowed (ExistingOnly)</span></span>  | <span data-ttu-id="e6ea9-576">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-576">✔️</span></span>     | ⚠️    | <span data-ttu-id="e6ea9-577">如果为 ReadOnly，则✔️ () </span><span class="sxs-lookup"><span data-stu-id="e6ea9-577">✔️ (if ReadOnly)</span></span> |
| <span data-ttu-id="e6ea9-578">打开 LocalMachine\Disallowed (ReadOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-578">Open LocalMachine\Disallowed (ReadOnly)</span></span>     | <span data-ttu-id="e6ea9-579">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-579">✔️</span></span>     | ❌    | <span data-ttu-id="e6ea9-580">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-580">✔️</span></span>             |
| <span data-ttu-id="e6ea9-581">打开 LocalMachine\Disallowed (ReadWrite) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-581">Open LocalMachine\Disallowed (ReadWrite)</span></span>    | <span data-ttu-id="e6ea9-582">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-582">✔️</span></span>     | ❌    | ❌              |
| <span data-ttu-id="e6ea9-583">打开 LocalMachine\Disallowed (ExistingOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-583">Open LocalMachine\Disallowed (ExistingOnly)</span></span> | <span data-ttu-id="e6ea9-584">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-584">✔️</span></span>     | ❌    | <span data-ttu-id="e6ea9-585">如果为 ReadOnly，则✔️ () </span><span class="sxs-lookup"><span data-stu-id="e6ea9-585">✔️ (if ReadOnly)</span></span> |

<span data-ttu-id="e6ea9-586">在 Linux 上， `Disallowed` 不在链生成中使用该存储区，尝试向其添加内容会导致 <xref:System.Security.Cryptography.CryptographicException> 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-586">On Linux, the `Disallowed` store is not used in chain building, and attempting to add contents to it results in a <xref:System.Security.Cryptography.CryptographicException>.</span></span> <span data-ttu-id="e6ea9-587"><xref:System.Security.Cryptography.CryptographicException> `Disallowed` 如果存储区已经获取内容，则会引发。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-587">A <xref:System.Security.Cryptography.CryptographicException> is thrown when opening the `Disallowed` store if it has already acquired contents.</span></span>

<span data-ttu-id="e6ea9-588">在 macOS 上，CurrentUser\Disallowed 和 LocalMachine\Disallowed 存储是对其信任设置为的证书的相应 SecTrustSettings 结果的解释 `Always Deny` 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-588">On macOS, the CurrentUser\Disallowed and LocalMachine\Disallowed stores are interpretations of the appropriate SecTrustSettings results for certificates whose trust is set to `Always Deny`.</span></span>

#### <a name="nonexistent-store"></a><span data-ttu-id="e6ea9-589">不存在的存储</span><span class="sxs-lookup"><span data-stu-id="e6ea9-589">Nonexistent store</span></span>

| <span data-ttu-id="e6ea9-590">方案</span><span class="sxs-lookup"><span data-stu-id="e6ea9-590">Scenario</span></span>                                         | <span data-ttu-id="e6ea9-591">Windows</span><span class="sxs-lookup"><span data-stu-id="e6ea9-591">Windows</span></span> | <span data-ttu-id="e6ea9-592">Linux</span><span class="sxs-lookup"><span data-stu-id="e6ea9-592">Linux</span></span> | <span data-ttu-id="e6ea9-593">macOS</span><span class="sxs-lookup"><span data-stu-id="e6ea9-593">macOS</span></span> |
|--------------------------------------------------|---------|-------|-------|
| <span data-ttu-id="e6ea9-594">打开不存在的存储 (ExistingOnly) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-594">Open non-existent store (ExistingOnly)</span></span>           | ❌     | ❌     | ❌    |
| <span data-ttu-id="e6ea9-595"> (ReadWrite 打开 CurrentUser 不存在的存储) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-595">Open CurrentUser non-existent store (ReadWrite)</span></span>  | <span data-ttu-id="e6ea9-596">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-596">✔️</span></span>     | <span data-ttu-id="e6ea9-597">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-597">✔️</span></span>     | ⚠️   |
| <span data-ttu-id="e6ea9-598">打开 LocalMachine 不存在的存储 (ReadWrite) </span><span class="sxs-lookup"><span data-stu-id="e6ea9-598">Open LocalMachine non-existent store (ReadWrite)</span></span> | <span data-ttu-id="e6ea9-599">✔️</span><span class="sxs-lookup"><span data-stu-id="e6ea9-599">✔️</span></span>     | ❌     | ❌    |

<span data-ttu-id="e6ea9-600">在 macOS 上，只支持在位置创建具有 X509Store API 的自定义存储 `CurrentUser` 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-600">On macOS, custom store creation with the X509Store API is supported only for `CurrentUser` location.</span></span> <span data-ttu-id="e6ea9-601">它将创建一个新的密钥链，在用户的密钥链目录中没有密码 (*~/Library/Keychains*) 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-601">It will create a new keychain with no password in the user's keychain directory (*~/Library/Keychains*).</span></span> <span data-ttu-id="e6ea9-602">若要创建具有密码的密钥链，可以使用 P/Invoke `SecKeychainCreate` 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-602">To create a keychain with password, a P/Invoke to `SecKeychainCreate` could be used.</span></span> <span data-ttu-id="e6ea9-603">同样，可 `SecKeychainOpen` 用于在不同位置打开密钥链。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-603">Similarly, `SecKeychainOpen` could be used to open keychains in different locations.</span></span> <span data-ttu-id="e6ea9-604">`IntPtr`可以将生成的传递给 [`new X509Store(IntPtr)`](xref:System.Security.Cryptography.X509Certificates.X509Store.%23ctor(System.IntPtr)) ，以获取支持读写存储，受限于当前用户的权限。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-604">The resulting `IntPtr` can be passed to [`new X509Store(IntPtr)`](xref:System.Security.Cryptography.X509Certificates.X509Store.%23ctor(System.IntPtr)) to obtain a read/write-capable store, subject to the current user's permissions.</span></span>

### <a name="x509chain"></a><span data-ttu-id="e6ea9-605">X509Chain</span><span class="sxs-lookup"><span data-stu-id="e6ea9-605">X509Chain</span></span>

<span data-ttu-id="e6ea9-606">macOS 不支持脱机 CRL 使用率，因此 `X509RevocationMode.Offline` 将被视为 `X509RevocationMode.Online` 。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-606">macOS doesn't support Offline CRL utilization, so `X509RevocationMode.Offline` is treated as `X509RevocationMode.Online`.</span></span>

<span data-ttu-id="e6ea9-607">macOS 不支持 CRL 上用户启动的超时 (证书吊销列表) /OCSP (联机证书状态协议) /AIA (授权信息访问) 下载，因此 `X509ChainPolicy.UrlRetrievalTimeout` 会被忽略。</span><span class="sxs-lookup"><span data-stu-id="e6ea9-607">macOS doesn't support a user-initiated timeout on CRL (Certificate Revocation List) / OCSP (Online Certificate Status Protocol) / AIA (Authority Information Access) downloading, so `X509ChainPolicy.UrlRetrievalTimeout` is ignored.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="e6ea9-608">其他资源</span><span class="sxs-lookup"><span data-stu-id="e6ea9-608">Additional resources</span></span>

* [<span data-ttu-id="e6ea9-609">.NET 加密模型</span><span class="sxs-lookup"><span data-stu-id="e6ea9-609">.NET Cryptography Model</span></span>](cryptography-model.md)
* [<span data-ttu-id="e6ea9-610">.NET 加密服务</span><span class="sxs-lookup"><span data-stu-id="e6ea9-610">.NET Cryptographic Services</span></span>](cryptographic-services.md)
* [<span data-ttu-id="e6ea9-611">使用填充对 CBC 模式对称解密的漏洞进行计时</span><span class="sxs-lookup"><span data-stu-id="e6ea9-611">Timing vulnerabilities with CBC-mode symmetric decryption using padding</span></span>](vulnerabilities-cbc-mode.md)
* [<span data-ttu-id="e6ea9-612">ASP.NET Core 数据保护</span><span class="sxs-lookup"><span data-stu-id="e6ea9-612">ASP.NET Core Data Protection</span></span>](/aspnet/core/security/data-protection/introduction)
